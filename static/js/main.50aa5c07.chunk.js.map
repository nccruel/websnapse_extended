{"version":3,"sources":["components/stylesheet.js","components/Snapse/useAnimateEdges.js","utils/helpers.js","utils/automata.js","components/Snapse/Snapse.js","components/forms/ElementPopUp.js","components/forms/ChooseRuleForm.js","components/forms/NewNodeForm.js","components/forms/AddSynapseWeightForm.js","components/forms/NewOutputNodeForm.js","components/forms/NewInputNodeForm.js","components/forms/EditNodeForm.js","components/forms/EditInputNodeForm.js","components/forms/EditSynapseForm.js","components/forms/DeleteNodeForm.js","components/forms/DeleteAllForm.js","components/forms/DeleteSynapseForm.js","components/ChoiceHistory/ChoiceHistory.js","components/useUnsavedChanges/useUnsavedChanges.js","components/Tour/Tour.js","App.js","reportWebVitals.js","index.js"],"names":["styles","selector","style","color","content","events","shape","width","height","css","useAnimateEdges","cyRef","useRef","useEffect","raf","cy","current","animOffset","animate","edges","requestAnimationFrame","cancelAnimationFrame","internal","createNeuron","newId","x","y","rules","spike","time","data","id","label","includes","substr","indexOf","position","classes","parent","replace","createOutputNeuron","output","rootId","replaceAll","createInputNeuron","input","checkValidRule","rule","result","exec","console","log","createEdge","src","dst","weight","c","source","target","title","allRulesValid","splitRules","split","count","i","length","parseRule","testRes","forgetRes","requires","grouped","char","symbol","consumes","produces","delayStr","delay","parseInt","canUseRule","spikes","step","neurons","isRandom","handleStartGuidedMode","handleSimulationEnd","newStates","produce","draft","spikeAdds","outputTracker","inputTracker","neuronValidRules","shouldEnd","k","neuron","currentRule","isOutput","isInput","chosenRule","validRules","push","randomIndex","Math","floor","random","Object","keys","window","localStorage","setItem","neuronOutWeights","outWeights","newDelay","valueOf","newSpikes","out","neuronOutKeys","bitstring","spike_arr","len","neuronOut_in","spk","bit","newString","JSON","stringify","backStep","parse","getItem","Snapse","onEdgeCreate","handleShowDeleteAll","handleChangePosition","setIsClickedSynapse","headless","setNeurons","checkIsHover","handleShowEditSynapseModal","handleShowDeleteSynapseModal","isClickedSynapse","setCy","elements","array","nodes","edgeIDs","Set","element","newNodes","newInputNode","newOutputNode","newEdge","add","newEdges","convertElements","on","evt","event","evtTarget","srcID","dstID","isNode","isEdge","edgeID","temp_edgeArr","unbind","bind","checker","Boolean","popperRefObj","popper","document","createElement","classList","node_type","node","innerHTML","strSpkRules","strFrgRules","spkRules","frgRules","join","body","appendChild","edge_ID_arr","weightsDict","synapse_weight","state","remove","destroy","gridGuide","guidelinesStyle","strokeStyle","horizontalDistColor","verticalDistColor","initPosAlignmentColor","edgehandles","handleNodes","preview","loopAllowed","edgeType","sourceNode","targetNode","complete","Button","className","variant","onClick","center","fit","zoom","level","size","textAlign","marginRight","disabled","float","wheelSensitivity","CytoscapeComponent","normalizeElements","stylesheet","ElementPopUp","showElementPopup","handleCloseElementPopup","nodeID","handleError","nodeType","nodeSRules","nodeFRules","nodeSpikes","nodeBitstring","useState","handleClose","Modal","show","onHide","Header","closeButton","Title","Body","ChooseRuleForm","showChooseRuleModal","handleCloseChooseRuleModal","handleChosenRules","useImmer","values","setValues","handleSelectChange","neuronId","currentValues","value","GroupRules","options","neuronOptions","map","Form","Group","Label","Control","as","onChange","ruleList","form","backdrop","keyboard","onSubmit","e","preventDefault","type","renderTooltip","props","Tooltip","formReducer","reset","startingSpikes","name","initialFormState","NewNodeForm","showNewNodeModal","handleCloseModal","handleNewNode","useReducer","formData","setFormData","setSubmitting","handleChange","shortid","generate","setTimeout","newNeuron","data-testid","htmlFor","required","placeholder","OverlayTrigger","placement","hide","overlay","Text","min","AddSynapseWeightForm","showAddWeightModal","handleCloseAddWeightModal","handleAddWeight","srce","dest","NewOutputNodeForm","showNewOutputModal","handleCloseNewOutputModal","handleNewOutput","NewInputNodeForm","showNewInputModal","handleCloseNewInputModal","handleNewInput","newInput","EditNodeForm","showEditModal","handleCloseEditModal","handleEditNode","setNeuronId","setRules","setStartingSpikes","reduce","r","filteredObject","defaultValue","EditInputNodeForm","showEditInputModal","handleCloseEditInputModal","handleEditInputNode","spikeTrain","setSpikeTrain","EditSynapseForm","currWeight","showEditSynapseModal","handleCloseEditSynapseModal","handleEditSynapse","setWeight","weight_main","handleDeleteSynapse","handleSubmit","DeleteNodeForm","showDeleteModal","handleCloseDeleteModal","handleDeleteNode","defaultNeuron","showDeleteAllModal","handleCloseDeleteAllModal","handleDeleteAll","DeleteSynapseForm","showDeleteSynapseModal","handleCloseDeleteSynapseModal","TableCell","TableRow","ChoiceHistory","showChoiceHistoryModal","handleCloseHoiceHistoryModal","getLatestState","neuronIds","neuronRows","neuronCells","Table","striped","bordered","hover","useUnsavedChanges","isDirty","setDirty","message","onbeforeunload","when","TOUR_STEPS","disableBeacon","disableOverlayClose","floaterProps","disableAnimation","offset","INITIAL_STATE","key","Date","run","continuous","loading","stepIndex","steps","reducer","action","payload","beaconInner","backgroundColor","tooltip","textColor","fontSize","tooltipContainer","tooltipTitle","margin","buttonNext","buttonBack","buttonSkip","mixBlendMode","spotlightLegacy","boxShadow","floater","arrow","zIndex","Tour","handleShowDropdownBasic","handleCloseDropdownBasic","handleShowSideBarMenu","handleCloseSideBarMenu","restartTutorial","handleFalseRestartTutorial","tourState","dispatch","callback","index","status","ACTIONS","CLOSE","STATUS","SKIPPED","FINISHED","EVENTS","STEP_AFTER","TARGET_NOT_FOUND","PREV","scrollToFirstStep","showSkipButton","hideBackButton","showProgress","locale","last","skip","compact","ignoreComment","spaces","sanitize","progBarRate","isHover","srcDel","dstDel","useKey","cb","isFocus","callbackRef","inputs","getElementsByTagName","addEventListener","handleKeyDown","code","fn","timerId","args","clearTimeout","debounced","removeEventListener","shortening","keyframes","ProgressBar","styled","div","isPlaying","App","n1","n2","n3","n4","setSrce","setDest","setTime","setIsRandom","fileName","setFileName","Prompt","setPristine","setShowElementPopup","setShowAddWeightModal","setShowNewNodeModal","setShowNewOutputModal","setShowNewInputModal","setShowChooseRuleModal","setShowEditModal","setShowEditInputModal","setShowEditSynapseModal","setShowChoiceHistoryModal","setShowDeleteAllModal","setShowDeleteModal","setShowDeleteSynapseModal","setShowDropdownBasic","showSideBarMenu","setShowSideBarMenu","setIsPlaying","hasEnded","setHasEnded","error","setError","pBar","setPBar","sld_value","setSldValue","handleShowDeleteAllModal","mode","setMode","setRestartTutorial","alert","showError","text","outCopy","src_id","dst_id","new_weight","a","handleNullForward","arr","filter","item","newoutArr","newweightsDict","flag","handleNewPosition","newOutput","handleReset","currNeurons","tempNeurons","clear","guidedRules","setGuidedRules","onNullForward","onForward","onBackward","tempTime","onIntervalStepRef","handleDelBackspaceKey","getElementById","click","p","simu_speed","interval","setInterval","clearInterval","path","Container","Alert","isOpen","disableCloseOnEsc","disableOverlayClick","noOverlay","File","custom","file","files","reader","FileReader","removeJsonTextAttribute","parentElement","pOpKeys","_parent","keyNo","keyName","arrOfKey","arrIndex","nativeType","trim","ignoreDeclaration","ignoreInstruction","ignoreAttributes","ignoreCdata","ignoreDoctype","textFn","convert","xml2js","readAsText","nValue","Number","isNaN","bValue","toLowerCase","handleLoad","wrapper","json2xml","blob","Blob","saveAs","toString","DropdownButton","Dropdown","Item","href","download","Check","defaultChecked","fontWeight","Row","Col","sm","onSelect","eventKey","borderRadius","padding","marginBottom","display","hidden","Slider","aria-label","max","newValue","valueLabelDisplay","valueLabelFormat","marginTop","addedEles","click_flag","curr_weight","process","testRe","forgetRe","spikeRules","forgRules","DeleteAllForm","j","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","cytoscape","use","ReactDOM","render","StrictMode"],"mappings":"6pBA0JeA,EA1JA,CACX,CACIC,SAAU,8CACVC,MAAO,CACH,cAAe,kBACf,qBAAsB,IACtB,cAAe,IACf,eAAgB,EAChB,cAAe,OACf,cAAe,MACfC,MAAO,QACPC,QAAS,gBAGjB,CACIH,SAAU,uBACVC,MAAO,CACH,cAAe,kBACf,qBAAsB,IACtB,cAAe,IACf,eAAgB,EAChB,cAAe,OACf,cAAe,MACf,mBAAmB,OACnBC,MAAO,QACPC,QAAS,gBAGjB,CACIH,SAAU,iEACVC,MAAO,CACH,cAAe,kBACf,aAAa,SACb,mBAAoB,QACpB,eAAgB,EAChBG,OAAQ,KACR,YAAa,OACb,iBAAkB,QAClB,cAAe,SACf,cAAe,SACfD,QAAS,cACT,OAAU,IACVE,MAAO,iBACPC,MAAO,MAGf,CACIN,SAAU,8BACVC,MAAO,CACH,cAAe,kBACf,aAAa,SACb,mBAAoB,OACpB,eAAgB,EAChBG,OAAQ,KACR,cAAe,SACf,cAAe,SACf,YAAY,OACZ,iBAAkB,QAClBD,QAAS,cACTI,OAAQ,IACRF,MAAO,iBACPC,MAAO,MAGf,CACIN,SAAU,0CACVC,MAAO,CACH,cAAe,kBACf,qBAAsB,IACtB,cAAe,SACf,cAAe,SACfE,QAAS,cACTC,OAAQ,KACRG,OAAQ,GACRF,MAAO,iBACPC,MAAO,KAGf,CACIN,SAAU,0DACVC,MAAO,CACH,cAAe,kBACf,qBAAsB,IACtB,cAAe,SACf,cAAe,SACfE,QAAS,cACTC,OAAQ,KACRG,OAAQ,GACRF,MAAO,iBACPC,MAAO,KAkBf,CACIN,SAAU,OACVC,MAAO,CACH,cAAe,kBACf,cAAe,SACf,qBAAsB,WACtB,wBAAyB,QACzB,wBAAyB,YACzBK,MAAO,IAMf,CACIN,SAAU,oBACVC,OAAK,GACD,aAAc,UACd,aAAc,SACd,qBAAsB,WAHrB,2BAIa,WAJb,2BAKa,UALb,mCAMqB,WANrB,cAOD,QAAS,GAPR,cAQD,mBAAoB,GARnB,cASD,oBAAqB,CAAC,GAAG,IATxB,cAUD,cAAe,KAVd,IAgBT,CACID,SAAU,cACVQ,IAAK,CACD,MAAS,cACT,gBAAiB,aACjB,gBAAiB,MACjB,gBAAiB,MACjB,0BAA2B,EAC3B,cAAe,OACf,YAAa,M,iBChHVC,MAjCf,WACE,IAAMC,EAAQC,iBAAO,MA6BrB,OAxBAC,qBAAU,WACR,IACIC,EADEC,EAAKJ,EAAMK,QAEbC,EAAa,EAcjB,OAZA,SAASC,IACPD,IACIF,GACFA,EAAGI,QAAQD,QAAQ,CACjBhB,MAAO,CAAE,oBAAqBe,KAGlCH,EAAMM,sBAAsBF,GAG9BA,GAEO,WACDJ,GACFO,qBAAqBP,MAGxB,IAEI,CAACH,EA5BM,SAACW,GACbX,EAAMK,QAAUM,KCNPC,EAAe,SAACC,EAAOC,EAAGC,EAAGC,EAAOC,EAAOC,GAA5B,MAAqC,CAAC,CAC1DC,KAAM,CACFC,GAAIP,EACJQ,MAAM,GAAD,OAAMR,EAAMS,SAAS,KAAOT,EAAMU,OAAO,EAAGV,EAAMW,QAAQ,MAAQX,IAE3EY,SAAU,CAAEX,EAAGA,EAAGC,EAAGA,GACrBW,QAAS,eAEb,CACIP,KAAM,CACFC,GAAIP,EAAQ,SACZc,OAAOd,EACPQ,MAAOL,EAAMY,QAAQ,KAAM,MAAMA,QAAQ,MAAO,WAEpDH,SAAU,CAAEX,EAAGA,EAAGC,EAAGA,GACrBW,QAAS,sBAEb,CACIP,KAAM,CACFC,GAAIP,EAAQ,SACZc,OAAQd,EACRQ,MAAOJ,GAEXQ,SAAU,CAAEX,EAAGA,EAAGC,EAAGA,EAAI,IACzBW,QAAS,sBAEb,CACIP,KAAM,CACFC,GAAIP,EAAQ,QACZc,OAAQd,EACRQ,MAAM,GAAD,OAAMH,EAAO,EAAI,IAAKA,IAE/BO,SAAU,CAAEX,EAAGA,EAAGC,EAAGA,EAAI,IACzBW,QAAS,uBAsCJG,EAAqB,SAACT,EAAGN,EAAEC,EAAEe,EAAOb,GAAf,MAAyB,CACvD,CACIE,KAAM,CAAEY,OAAQX,EAAIA,GAAG,GAAD,OAAKA,GAAMC,MAAM,GAAD,OAAMD,EAAGE,SAAS,KAAOF,EAAGG,OAAO,EAAGH,EAAGI,QAAQ,MAAQJ,IAC/FM,QAAS,gBACTD,SAAU,CAAEX,EAAG,EAAGC,EAAG,IAEvB,CACEI,KAAM,CAAEY,OAAQX,EAAIA,GAAG,GAAD,OAAKA,EAAL,WAAkBO,OAAQP,EAAIC,MAAM,GAAD,OAAwB,kBAAXS,EAAuBA,EAAOF,QAAQ,qBAAqB,IAAII,WAAW,WAAW,QAAU,KACrKN,QAAS,sBACTD,SAAU,CAAEX,IAAGC,EAAGA,IAEpB,CACEI,KAAM,CAAEY,OAAQX,EAAIA,GAAG,GAAD,OAAKA,EAAL,UAAiBO,OAAQP,EAAIC,MAAO,IAC1DK,QAAS,qBACTD,SAAU,CAAEX,IAAGC,EAAGA,EAAI,OAIjBkB,GAAoB,SAACb,EAAGN,EAAEC,EAAGmB,EAAMjB,GAAf,MAA0B,CAAC,CACxDE,KAAM,CACFC,GAAIA,EACJC,MAAM,GAAD,OAAMD,EAAGE,SAAS,KAAOF,EAAGG,OAAO,EAAGH,EAAGI,QAAQ,MAAQJ,IAElEK,SAAU,CAAEX,EAAGA,EAAGC,EAAGA,GACrBW,QAAS,gBAEb,CACIP,KAAM,CAAEY,OAAQX,EAAIA,GAAG,GAAD,OAAKA,EAAL,UAAiBO,OAAQP,EAAIC,MAAM,GAAD,OAAuB,kBAAVa,EAAsBA,EAAMN,QAAQ,qBAAqB,IAAII,WAAW,WAAW,QAAU,KAClKN,QAAS,qBACTD,SAAU,CAAEX,IAAGC,EAAGA,MAEToB,GAAiB,SAACC,GAC3B,IAGIC,EAFW,sEAEKC,KAAKF,IADR,2DAC0BE,KAAKF,GAEhD,OADAG,QAAQC,IAAI,SAAUH,GACfA,GAGEI,GAAa,SAACC,EAAIC,EAAKC,EAAQC,GACxC,MAAO,CACH1B,KAAM,CACJC,GAAIsB,EAAM,KAAOC,EACjBG,OAAQJ,EACRK,OAAQJ,EACRtB,MAAOuB,EACPI,MAAO,kBAETtB,QAASmB,IAIJI,GAAgB,SAACjC,GAG1B,IAFA,IAAIkC,EAAalC,EAAMmC,MAAM,KACzBC,EAAQ,EACHC,EAAE,EAAEA,EAAEH,EAAWI,OAAOD,IACK,MAA/BlB,GAAee,EAAWG,IACzBD,GAAO,EAEPb,QAAQC,IAAI,cAAeU,EAAWG,IAG9C,OAAGD,GAASF,EAAWI,OACZ,EAEA,G,SCxIR,SAASC,GAAUnB,EAAMhB,GACjB,oCAOIkB,KAAKF,GAPpB,IAQMoB,EAFS,sEAEQlB,KAAKF,GACtBqB,EAPW,2DAOUnB,KAAKF,GAOhC,GAAIoB,EAAS,CACTjB,QAAQC,IAAI,YADH,kBAE+DgB,EAF/D,GAEFE,EAFE,KAEQC,EAFR,KAEiBC,EAFjB,KAEuBC,EAFvB,KAE+BC,EAF/B,KAEyCC,EAFzC,KAEmDC,EAFnD,KAGHC,EAAQC,SAASF,EAAU,IAmBjC,MAjBgB,IAAZN,IACAA,EAAW,GAEH,IAARE,GAAyB,IAAXD,IACdA,EAAU,GAGE,IAAZG,IACAA,EAAW,GAGC,IAAZC,IACAA,EAAW,GAGfxB,QAAQC,IAAI,CAAC,GAAMpB,EAAI,SAAYsC,EAAU,KAAQE,EAAM,QAAWD,EAAS,OAASE,EAAQ,SAAYC,EAAU,SAAYC,EAAU,MAASG,SAASF,KAEvJ,CAACE,SAASR,GAAWQ,SAASP,GAAUE,EAAQK,SAASJ,GAAWI,SAASH,GAAWE,GAC5F,GAAIR,EAAW,CAAC,IAAD,cACsDA,EADtD,GACXC,EADW,KACDC,EADC,KACQC,EADR,KACcC,EADd,KACsBC,EADtB,KACgCC,EADhC,KAC0CC,EAD1C,KAkBlB,MAhBgB,IAAZN,IACAA,EAAW,GAGH,IAARE,GAAyB,IAAXD,IACdA,EAAU,GAGE,IAAZG,IACAA,EAAW,GAEC,IAAZC,IACAA,EAAW,GAGfxB,QAAQC,IAAI,CAAC,GAAMpB,EAAI,SAAYsC,EAAU,QAAWC,EAAS,OAASE,EAAQ,SAAYC,EAAU,SAAYC,EAAU,MAASG,SAASF,KACzI,CAACE,SAASR,GAAWQ,SAASP,GAAUE,EAAQK,SAASJ,GAAW,EAAG,GAIlF,OAAO,EAEJ,SAASK,GAAWT,EAAUC,EAASE,EAAQO,EAAQN,GAC1D,GAAIA,EAAWM,EACX,OAAO,EAGX,GAAc,KAAVP,EAAe,CACf,GAAIF,EAAU,EACV,OAAKS,EAASV,GAAYC,GAAW,GAAMS,EAASV,GAAaC,EAKrE,GAAIS,GAAUV,EACV,OAAO,OAGV,GAAc,KAAVG,EAAe,CACpB,GAAIF,EAAU,EACV,OAAKS,EAASV,GAAYC,GAAW,EAKzC,GAAIS,GAAUV,EAAW,EACrB,OAAO,OAGV,GAAIU,GAAUV,EACf,OAAO,EAEX,OAAO,EAEJ,SAASW,GAAKC,EAASpD,EAAMqD,EAAUC,EAAuBC,GACjE,IAAMC,EAAYC,aAAQL,GAAS,SAAAM,GAC/B,IAAMC,EAAY,GACZC,EAAgB,GAChBC,EAAe,GACjBC,EAAmB,GACnBC,GAAY,EAGhB,IAAK,IAAIC,KAAKN,EAAO,CAGjB,KAFIO,EAASP,EAAMM,IAEPE,cAAgBD,EAAOE,WAAaF,EAAOG,QAAS,QACrDV,EAAMO,EAAO/D,IAAImE,kBACjBX,EAAMO,EAAO/D,IAAIgE,YAIxB,IAFA,IAAIpE,EAAQmE,EAAOnE,MAAMmC,MAAM,KAC3BqC,EAAa,GACRnC,EAAI,EAAGA,EAAIrC,EAAMsC,OAAQD,IAAK,CAAC,IAAD,EAC0BE,GAAUvC,EAAMqC,GAAI6B,GAD9C,mBAC9BxB,EAD8B,KACpBC,EADoB,KACXE,EADW,KACHC,EADG,KACOC,EADP,KACiBE,EADjB,KAE/BE,GAAWT,EAAUC,EAASE,EAAQsB,EAAOf,OAAQN,KACrDvB,QAAQC,IAAI,cAAeyC,GAC3BO,EAAWC,KAAKzE,EAAMqC,IACtB4B,GAAY,GAIpB,GADA1C,QAAQC,IAAI,cAAeyC,GACF,GAArBO,EAAWlC,OAAa,CACxBsB,EAAMO,EAAO/D,IAAIgE,YAAcI,EAAW,GAC1CZ,EAAMO,EAAO/D,IAAImE,WAAaC,EAAW,GAFjB,MAGqCjC,GAAUiC,EAAW,GAAIN,GAH9D,mBAGnBxB,EAHmB,KAGTC,EAHS,KAGAE,EAHA,KAGQC,EAHR,KAGkBC,EAHlB,KAG4BE,EAH5B,KAIxBW,EAAMO,EAAO/D,IAAI6C,MAAQA,OACtB,GAAgB,GAAZM,GAAoBiB,EAAWlC,OAAS,EAAG,CAClD,IAAIoC,EAAcC,KAAKC,MAAMD,KAAKE,SAAYL,EAAWlC,QADP,EAEWC,GAAUiC,EAAWE,GAAcR,GAF9C,mBAE7CxB,EAF6C,KAEnCC,EAFmC,KAE1BE,EAF0B,KAElBC,EAFkB,KAERC,EAFQ,KAEEE,EAFF,KAGlDW,EAAMO,EAAO/D,IAAIgE,YAAcI,EAAWE,GAC1Cd,EAAMO,EAAO/D,IAAImE,WAAaC,EAAWE,GACzCd,EAAMO,EAAO/D,IAAI6C,MAAQA,OACN,GAAZM,GAAqBiB,EAAWlC,OAAS,IAChD0B,EAAiBG,EAAO/D,IAAMoE,IAK1C,GAAIM,OAAOC,KAAKf,GAAkB1B,OAAS,EAIvC,OAHAf,QAAQC,IAAI,qBAAsBwC,GAClCgB,OAAOC,aAAaC,QAAQ,iBAAkB,UAC9C1B,EAAsBQ,GAG1B,IAAK,IAAIE,KAAKN,EAAO,CACjB,IAAIO,EAASP,EAAMM,GACfiB,EAAgB,eAAOhB,EAAOiB,YAElC,GAAIjB,EAAOC,YAAa,CAEpB,GADAH,GAAY,EACRE,EAAOlB,OAAS,EAAG,CACnB,IAAIoC,EAAWlB,EAAOlB,MAAMqC,UAC5BD,IACAzB,EAAMO,EAAO/D,IAAI6C,MAAQoC,EAG7B,GAAIlB,EAAOlB,MAAQ,EAAG,OAE2CV,GAAU4B,EAAOC,YAAaF,GAFzE,mBAIdqB,GAFC7C,EAFa,KAEHC,EAFG,KAEME,EAFN,KAEcC,EAFd,KAEwBC,EAFxB,KAEkCE,EAFlC,KAIFkB,EAAOf,OAAOkC,WAM9B,GALAC,GAAazC,EAEbc,EAAMO,EAAO/D,IAAIgD,OAASmC,EAGtBpB,EAAOqB,IAAK,CACZ,IADY,EACNC,EAAgBtB,EAAOqB,IADjB,cAEEC,GAFF,IAEZ,2BAA6B,CAAC,IAArBvB,EAAoB,QAEzBL,EAAUK,GACNA,KAAKL,EAAYA,EAAUK,GAAKnB,EAAWA,EAE/Cc,EAAUK,GAAKL,EAAUK,GAAGiB,EAAiBjB,GAC7C3C,QAAQC,IAAI,oBAAsB0C,EAAI,KAAOL,EAAUK,KAR/C,sCAaTN,EAAMO,EAAO/D,IAAIgE,kBAEzB,GAAID,EAAOG,QAAS,CACvBP,EAAaU,KAAKN,EAAO/D,IACzBmB,QAAQC,IAAI,KAAM2C,EAAOuB,WACzB,IAAIC,EAAaxB,EAAOuB,UAAWvD,MAAM,KACrCyD,EAAMD,EAAUrD,OAOpB,GANAf,QAAQC,IAAI,YAAamE,GAEpBxB,EAAOuB,UAAWpD,OAAS,IAC5BsD,EAAM,GAGNzB,EAAOqB,IAAK,CACZ,IADY,EACNK,EAAe1B,EAAOqB,IADhB,cAEEK,GAFF,IAEZ,2BAA4B,CAAC,IAIrBC,EAJC5B,EAAmB,QACpB6B,EAAM7C,SAASyC,EAAUzF,IAK7B,GAJAqB,QAAQC,IAAI,OAAQtB,GACpBqB,QAAQC,IAAI,MAAOoE,GAEnBrE,QAAQC,IAAI,MAAOuE,GACf7F,EAAO0F,EAAI,CACXrE,QAAQC,IAAI,WACZyC,GAAY,EACZ,IAAIoB,EAAWlB,EAAOlB,MAAMqC,UAC5BD,IACAzB,EAAMO,EAAO/D,IAAI6C,MAAQoC,EAEzBS,EAAMC,EAAIZ,EAAiBjB,QAI3B3C,QAAQC,IAAI,eACZsE,EAAM,EACNlC,EAAMO,EAAO/D,IAAI6C,MAAQ,EAE7BY,EAAUK,GACNA,KAAKL,EAAYA,EAAUK,GAAKhB,SAAS4C,GAAM5C,SAAS4C,GAC5DvE,QAAQC,IAAI,sBAAuB2C,EAAO/D,GAAI8D,EAAG4B,IAzBzC,qCA4BT3B,EAAOE,UACdP,EAAcW,KAAKN,EAAO/D,IACpB8D,KAAKL,IACPA,EAAUK,GAAK,KAEK,GAAjBC,EAAOlB,OAAgBkB,EAAOG,UACrCV,EAAMO,EAAO/D,IAAI6C,MAAQ,GAGjC,IAAK,IAAMiB,KAAKL,EAAW,CAEvB,IAQQmC,EARJT,EAAYrC,SAASU,EAAMM,GAAGd,OAAOkC,WAOzC,GANAC,GAAa1B,EAAUK,GAEvBN,EAAMM,GAAGd,OAASmC,EAElBhE,QAAQC,IAAI,YAAaoC,EAAMM,GAAGwB,WAE9B9B,EAAMM,GAAGG,SAGL2B,EADQ,GAAR9F,EACS,UAAM2D,EAAUK,IAAM,GAGtB,UAAMN,EAAMM,GAAGwB,UAAf,YAA4B7B,EAAUK,IAAM,GAEzDN,EAAMM,GAAGwB,UAAYM,EAI7BzE,QAAQC,IAAI,aAAcyC,GACtBA,GACAR,IAEJuB,OAAOC,aAAaC,QAAQ,iBAAkB,QAIlD,OADAD,aAAaC,QAAQhF,EAAO,MAAO+F,KAAKC,UAAUxC,IAC3CA,EAWJ,SAASyC,GAASjG,GAGrB,OAFAqB,QAAQC,IAAI,sBACGyE,KAAKG,MAAMnB,aAAaoB,QAAQnG,EAAO,Q,qDCA3CoG,GArQA,SAAC,GACqE,IADnEhD,EACkE,EADlEA,QAASiD,EACyD,EADzDA,aAAcC,EAC2C,EAD3CA,oBAAqBC,EACsB,EADtBA,qBAAsBC,EACA,EADAA,oBAAqBC,EACrB,EADqBA,SAAUC,EAC/B,EAD+BA,WAAY1E,EAC3C,EAD2CA,WAC7H2E,EAAkF,EAAlFA,aAAcC,EAAoE,EAApEA,2BAA4BC,EAAwC,EAAxCA,6BAA8B7G,EAAU,EAAVA,KAEpE8G,GAAmB,EAF2D,EAI3DjI,IAJ2D,mBAI3EC,EAJ2E,KAIpEiI,EAJoE,KAsBlF,IAAMC,EFqIuB,SAAAA,GAC3B,IAtI+BrH,EAAOC,EAAGC,EAAGC,EAAOC,EAAOC,EAsItDiH,EAAQ,CACRC,MAAO,GACP5H,MAAM,GACN6H,QAAS,IAAIC,KAEjB,IAAK,IAAIpD,KAAKgD,EAAU,CACpB,IAAIK,EAAUL,EAAShD,GACvB,GAAIqD,EAAQnD,YAAY,CACpB,IAAIoD,GA9ImB3H,EA8IW0H,EAAQnH,GA9IZN,EA8IgByH,EAAQ9G,SAASX,EA9I9BC,EA8IiCwH,EAAQ9G,SAASV,EA9I/CC,EA8IiDuH,EAAQvH,MA9IlDC,EA8IyDsH,EAAQnE,OA9I1DlD,EA8IkEqH,EAAQtE,MA9IjE,CAAC,CAC5D9C,KAAM,CACFC,GAAIP,EACJQ,MAAM,GAAD,OAAMR,EAAMS,SAAS,KAAOT,EAAMU,OAAO,EAAGV,EAAMW,QAAQ,MAAQX,IAE3EY,SAAU,CAAEX,EAAGA,EAAGC,EAAGA,GACrBW,QAAS,uBAEb,CACIP,KAAM,CACFC,GAAIP,EAAQ,SACZc,OAAOd,EACPQ,MAAOL,EAAMY,QAAQ,KAAM,MAAMA,QAAQ,MAAO,WAEpDH,SAAU,CAAEX,EAAGA,EAAGC,EAAGA,GACrBW,QAAS,8BAEb,CACIP,KAAM,CACFC,GAAIP,EAAQ,SACZc,OAAQd,EACRQ,MAAOJ,GAEXQ,SAAU,CAAEX,EAAGA,EAAGC,EAAGA,EAAI,IACzBW,QAAS,8BAEb,CACIP,KAAM,CACFC,GAAIP,EAAQ,QACZc,OAAQd,EACRQ,MAAOH,GAEXO,SAAU,CAAEX,EAAGA,EAAGC,EAAGA,EAAI,IACzBW,QAAS,+BA8GTyG,EAAMC,MAAM3C,KAAK+C,EAAS,IAC1BL,EAAMC,MAAM3C,KAAK+C,EAAS,IAC1BL,EAAMC,MAAM3C,KAAK+C,EAAS,IAC1BL,EAAMC,MAAM3C,KAAK+C,EAAS,SACxB,GAAID,EAAQlD,UAAakD,EAAQjD,QAOjC,GAAGiD,EAAQjD,QAAQ,CACrB,IAAImD,EAAexG,GAAkBsG,EAAQnH,GAAImH,EAAQ9G,SAASX,EAAEyH,EAAQ9G,SAASV,EAAGwH,EAAQ7B,WAChGyB,EAAMC,MAAM3C,KAAKgD,EAAa,IAC9BN,EAAMC,MAAM3C,KAAKgD,EAAa,QAE7B,CACD,IAAIC,EAAgB7G,EAAmB0G,EAAQnH,GAAImH,EAAQ9G,SAASX,EAAEyH,EAAQ9G,SAASV,EAAGwH,EAAQ7B,WAClGyB,EAAMC,MAAM3C,KAAKiD,EAAc,IAC/BP,EAAMC,MAAM3C,KAAKiD,EAAc,IAC/BP,EAAMC,MAAM3C,KAAKiD,EAAc,SAf3BF,EAAW5H,EAAa2H,EAAQnH,GAAImH,EAAQ9G,SAASX,EAAEyH,EAAQ9G,SAASV,EAAEwH,EAAQvH,MAAOuH,EAAQnE,OAAQmE,EAAQtE,OACrHkE,EAAMC,MAAM3C,KAAK+C,EAAS,IAC1BL,EAAMC,MAAM3C,KAAK+C,EAAS,IAC1BL,EAAMC,MAAM3C,KAAK+C,EAAS,IAC1BL,EAAMC,MAAM3C,KAAK+C,EAAS,IAa9B,GAAGD,EAAQ/B,IACP,IAAK,IAAInD,EAAE,EAAGA,EAAGkF,EAAQ/B,IAAIlD,OAAQD,IACjC,GAAIkF,EAAQtE,MAAM,EAAG,CAAC,IAAD,gBACDsE,EAAQ/B,KADP,IACjB,2BAA6B,SAAC,IACxBmC,EAAUlG,GAAW8F,EAAQnH,GAAImH,EAAQ/B,IAAInD,GAAKkF,EAAQnC,WAAYmC,EAAQ/B,IAAInD,IAAK,qBAC3F8E,EAAM3H,MAAMiF,KAAKkD,GACjBR,EAAME,QAAQO,IAAIL,EAAQnH,GAAK,KAAOmH,EAAQ/B,IAAInD,KAJnC,mCAOhB,CACD,IAAIwF,EAAWpG,GAAW8F,EAAQnH,GAAImH,EAAQ/B,IAAInD,GAAKkF,EAAQnC,WAAYmC,EAAQ/B,IAAInD,IAAK,IAC5F8E,EAAM3H,MAAMiF,KAAKoD,GACjBV,EAAME,QAAQO,IAAIL,EAAQnH,GAAK,KAAOmH,EAAQ/B,IAAInD,KAKlE,OAAO8E,EEtLQW,CAAgBxE,GAwNjC,OAtNApE,qBAAU,WACR,IAAKyH,EAAU,CACb,IAAMvH,EAAKJ,EAAMK,QACbD,IAEFA,EAAG2I,GAAG,UAAW,+CAA+C,SAACC,GAC/DzG,QAAQC,IAAI,kBAAmBwG,EAAIjG,OAAO3B,MAC1CqG,EAAqBuB,EAAIvH,SAAUuH,EAAIjG,OAAO3B,SAGhDhB,EAAG2I,GAAG,OAAO,SAASE,GAGpB,IAAIC,EAAYD,EAAMlG,OAClBoG,EAAQ,IACRC,EAAQ,IAEZ,GAAIF,GAAa9I,EACfmC,QAAQC,IAAI,qBACZwF,GAAmB,EACnBzF,QAAQC,IAAI,MAAOpC,GACnBsH,EAAoBM,EAAkBmB,EAAOC,QAI1C,GAAIF,EAAUG,SAEjB3B,EADAM,GAAmB,EACmBmB,EAAOC,GAC7C7G,QAAQC,IAAI,oBAGT,GAAI0G,EAAUI,SAAS,CAC1B/G,QAAQC,IAAI,eAGZ,IAAM+G,EAASL,EAAU9H,KACzBmB,QAAQC,IAAI,WAAY+G,GACxB,IAAIC,EAAeD,EAAOpG,MAAM,MAEhCgG,EAAQK,EAAa,GACrBJ,EAAQI,EAAa,GAIrB9B,EAFAM,GAAmB,EAEmBmB,EAAOC,GAC7C7G,QAAQC,IAAI,UAAWwF,EAAkBmB,EAAOC,OAMpDhJ,EAAG8H,WAAWuB,OAAO,aACrBrJ,EAAG8H,WAAWwB,KAAK,aAAa,SAACT,GAE/B,IAAIU,EAAUC,QAAQ/B,KACtBtF,QAAQC,IAAI,UAAWmH,GAEnBV,EAAMlG,OAAOsG,UAAYM,GAC3BpH,QAAQC,IAAI,gBAAiBmH,GAC7BV,EAAMlG,OAAO8G,aAAeZ,EAAMlG,OAAO+G,OAAO,CAC9CrK,QAAS,WACP,IAAIA,EAAUsK,SAASC,cAAc,OAgFrC,OA9EAvK,EAAQwK,UAAUrB,IAAI,cAEtBhB,GAAW,SAAAhD,GACT,IAEIsF,EAFAC,EAAOvF,EAAMqE,EAAMlG,OAAO3B,MAI9B,GAAI+I,EAAK7E,SAAW6E,EAAK9E,SAAU,CAE1C6E,EADaC,EAAK7E,QACN,eAGA,gBAEb,IAAIoB,EAAY,eAEXyD,EAAKzD,UAAWpD,OAAS,IAC7BoD,EAAYyD,EAAKzD,WAGRjH,EAAQ2K,UAAY,mBAAqBD,EAAK/I,GAA1B,iCACuB8I,EADvB,mCAEyBxD,EAAY,aAEtD,CACHwD,EAAY,iBADT,IAyBTG,EAAaC,EAzBJ,EAEcpH,EAAWiH,EAAKnJ,OAF9B,mBAERuJ,EAFQ,KAEEC,EAFF,KA4BZH,EADsB,GAAnBE,EAASjH,OACE,gBAGAiH,EAASE,KAAK,SAI5BH,EADsB,GAAnBE,EAASlH,OACE,gBAGAkH,EAASC,KAAK,SAGnBhL,EAAQ2K,UAAY,mBAAqBD,EAAK/I,GAA1B,iCACuB8I,EADvB,gDAEsCC,EAAK/F,OAF3C,2CAGaiG,EAHb,8CAIgBC,EAAc,aAOtDP,SAASW,KAAKC,YAAYlL,GAEnBA,MAIJwJ,EAAMlG,OAAOuG,UAAYK,IAChCpH,QAAQC,IAAI,iBACZyG,EAAMlG,OAAO8G,aAAeZ,EAAMlG,OAAO+G,OAAO,CAC9CrK,QAAS,WACP,IAAIA,EAAUsK,SAASC,cAAc,OAErCvK,EAAQwK,UAAUrB,IAAI,cAEtB,IAAMW,EAASN,EAAMlG,OAAO3B,KAC5BmB,QAAQC,IAAI+G,GACZ,IAAIqB,EAAcrB,EAAOpG,MAAM,MAC3BT,EAAMkI,EAAY,GAClBjI,EAAMiI,EAAY,GAetB,OAbAhD,GAAW,SAAAhD,GACT,IAAIiG,EAAW,eAAOjG,EAAMlC,GAAK0D,YAC7B0E,EAAiB5G,SAAS2G,EAAYlI,IAE1ClD,EAAQ2K,UAAY,sBAAwBb,EAAxB,mCACyB7G,EADzB,wCAE8BC,EAF9B,sCAG4BmI,EAAiB,YAInEf,SAASW,KAAKC,YAAYlL,GAEnBA,SAOfW,EAAG8H,WAAWuB,OAAO,YACrBrJ,EAAG8H,WAAWwB,KAAK,YAAY,SAACT,GAC9B,IAAIU,EAAUC,QAAQ/B,MACjBoB,EAAMlG,OAAOsG,UAAYJ,EAAMlG,OAAOuG,WAAaK,GAClDV,EAAMlG,OAAO+G,SACfb,EAAMlG,OAAO8G,aAAakB,MAAM7C,SAAS4B,OAAOkB,SAChD/B,EAAMlG,OAAO8G,aAAaoB,cAMhC7K,EAAG8K,UAAU,CACXC,gBAAiB,CACfC,YAAa,QACbC,oBAAqB,UACrBC,kBAAmB,QACnBC,sBAAuB,aAG3BnL,EAAGoL,YAAY,CACbC,YAAa,oDACbC,SAAS,EACTC,YAAa,kBAAM,GACnBC,SAAU,SAAUC,EAAYC,GAC9B,MAAO,QAGTC,SAAUxE,QAMf,CAACvH,EAAO2H,IACJA,EAAY,sBAAKvG,GAAG,eACzB,uBAAK7B,MAAO,CACVK,MAAO,OACPC,OAAQ,QAFV,UAIE,gBAACmM,EAAA,EAAD,CAAQC,UAAU,sBAAsBC,QAAQ,YAAYC,QA1OhE,WACE,IAAM/L,EAAKJ,EAAMK,QAEbD,IAEFA,EAAGgM,SACHhM,EAAGiM,MACHjM,EAAGkM,KAAK,CACNC,MAAO,GACP9K,SAAU,CAAEX,EAAG,IAAKC,EAAG,SAiOzB,UAAwF,eAAC,KAAD,IAAgB,IAAxG,kBAAkI,IAClI,gBAACiL,EAAA,EAAD,CAAQE,QAAQ,UAAUM,KAAK,KAAKpL,GAAG,eAAe6K,UAAU,eAAeE,QAASrE,EAA4BvI,MAAO,CAAEkN,UAAW,SAAUC,YAAa,SAAWC,SAAUzL,EAAO,EAA3L,UAA6M,eAAC,IAAD,IAAiB,IAA9N,kBACA,gBAAC8K,EAAA,EAAD,CAAQE,QAAQ,UAAUM,KAAK,KAAKpL,GAAG,cAAc6K,UAAU,eAAeE,QAASpE,EAA8BxI,MAAO,CAAEkN,UAAW,SAAUC,YAAa,SAAWC,SAAUzL,EAAO,EAA5L,UAA8M,eAAC,IAAD,IAAY,IAA1N,oBACA,gBAAC8K,EAAA,EAAD,CAAQ5K,GAAG,gBAAgB7B,MAAO,CAACqN,MAAO,SAAUV,QAAQ,SAASC,QAjPtD,WACjB3E,KAgPE,UAA0F,eAAC,KAAD,IAAU,IAApG,eACA,eAAC,IAAD,CACEpH,GAAI6H,EACJ4E,iBAAkB,GAClB3E,SAAU4E,IAAmBC,kBAAkB7E,GAC/C3I,MAAO,CACLK,MAAO,OACPC,OAAQ,QAEVmN,WAAYA,Q,8BCxMLC,GAjEM,SAAC,GAAoI,IAAlIC,EAAiI,EAAjIA,iBAAkBC,EAA+G,EAA/GA,wBAAsCC,GAAyE,EAAtFC,YAAsF,EAAzED,QAAQE,EAAiE,EAAjEA,SAAUC,EAAuD,EAAvDA,WAAYC,EAA2C,EAA3CA,WAAYC,EAA+B,EAA/BA,WAAYC,EAAmB,EAAnBA,cAAmB,EAC3HC,mBAAS,IADkH,gCAEzGA,mBAAS,IAFgG,mBAG/IC,GAH+I,UAGjI,WAEhBT,MAIJ,MAAgB,SAAZG,EAEI,gBAACO,GAAA,EAAD,CAAOC,KAAMZ,EAAkBa,OAAQH,EAAvC,UACI,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACI,eAACJ,GAAA,EAAMK,MAAP,mCAEJ,gBAACL,GAAA,EAAMM,KAAP,WACI,8CADJ,IACyBT,QAOhB,UAAZJ,EAED,gBAACO,GAAA,EAAD,CAAOC,KAAMZ,EAAkBa,OAAQH,EAAvC,UACI,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACI,eAACJ,GAAA,EAAMK,MAAP,oCAEJ,gBAACL,GAAA,EAAMM,KAAP,WACI,8CADJ,IACyBT,QAQ7B,gBAACG,GAAA,EAAD,CAAOC,KAAMZ,EAAkBa,OAAQH,EAAvC,UACI,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACI,eAACJ,GAAA,EAAMK,MAAP,6BAEJ,gBAACL,GAAA,EAAMM,KAAP,WACI,0CADJ,IACqBf,KAErB,gBAACS,GAAA,EAAMM,KAAP,WACI,uCADJ,IACkBb,EADlB,aAGA,gBAACO,GAAA,EAAMM,KAAP,WACI,2DADJ,IACsCV,KAEtC,gBAACI,GAAA,EAAMM,KAAP,WACI,gDADJ,IAC2BZ,KAG3B,gBAACM,GAAA,EAAMM,KAAP,WACI,mDADJ,IAC8BX,SCG/BY,GA3DQ,SAAC,GAAgF,IAA/EC,EAA8E,EAA9EA,oBAAqBC,EAAyD,EAAzDA,2BAA2BtN,EAA8B,EAA9BA,MAAOuN,EAAuB,EAAvBA,kBAAuB,EACvEC,YAAS,IAD8D,mBAC5FC,EAD4F,KACpFC,EADoF,KAanG,SAASC,EAAmB1F,EAAM2F,GAC9BF,GAAU,SAAAG,GACN,IAAK,IAAI3J,KAAK2J,EACP3J,GAAK0J,IACJC,EAAc3J,GAAK+D,EAAMlG,OAAO+L,UAfhD5O,qBAAU,WACNwO,GAAU,SAAAG,GACN,IAAK,IAAI3J,KAAKlE,EACV6N,EAAc3J,GAAKlE,EAAMkE,GAAG,QAGtC,CAAClE,IA+BH,IAhBA,IAAM+N,EAAa,SAAC1N,EAAM2N,GACtB,IAAIC,EAAgBD,EAAQE,KAAI,SAAC/J,GAAD,OAC5B,yBAAQ2J,MAAO3J,EAAf,SAAqCA,GAATA,MAEhC,OACI,gBAACgK,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,UAAahO,IACb,eAAC8N,EAAA,EAAKG,QAAN,CAAcC,GAAG,SAAST,MAAOL,EAAOpN,GAAQmO,SAAU,SAACvG,GAAD,OAAS0F,EAAmB1F,EAAO5H,IAA7F,SACK4N,QAMbQ,EAAW3J,OAAOC,KAAK/E,GACvB0O,EAAO,GACFrM,EAAE,EAAGA,EAAEoM,EAASnM,OAAQD,IAC7Bd,QAAQC,IAAIa,GACZqM,EAAKjK,KAAKsJ,EAAWU,EAASpM,GAAIrC,EAAMyO,EAASpM,MAErD,OACI,gBAACwK,GAAA,EAAD,CAAOC,KAAMO,EAAqBN,OAAQO,EAA4BqB,SAAS,SAASC,UAAU,EAAlG,UACI,eAAC/B,GAAA,EAAMG,OAAP,UACI,eAACH,GAAA,EAAMK,MAAP,iCAER,eAACL,GAAA,EAAMM,KAAP,UACI,gBAACgB,EAAA,EAAD,CAAMU,SAxCd,SAAkBC,GACdA,EAAEC,iBACFxB,EAAkBE,IAsCd,UACSiB,EACL,eAAC1D,EAAA,EAAD,CAAQgE,KAAK,SAAb,6BCjDVC,GAAgB,SAACC,GAAD,OACpB,eAACC,EAAA,EAAD,yBAAS/O,GAAG,iBAAiB7B,MAAO,CAAC,MAAS,UAAa2Q,GAA3D,aACE,+BAAG,4CAAH,MAAuB,qCAAvB,KAAqC,qCAArC,IAAkD,qCAAlD,oCAA+F,wBAC7F,+CADF,IACuB,wBADvB,wBACuD,wBADvD,gBAC4E,wBAC1E,6CAFF,IAEqB,wBAFrB,uBAEoD,wBAFpD,uBAOEE,GAAc,SAACrF,EAAO9B,GAC1B,OAAIA,EAAMoH,MACD,CACLjP,GAAG,GACHkP,eAAgB,EAChBtP,MAAO,IAGJ,2BACF+J,GADL,kBAEG9B,EAAMsH,KAAOtH,EAAM6F,SAIlB0B,GAAmB,CAACpP,GAAG,GAAIJ,MAAM,GAAIsP,eAAe,GA2F3CG,GAzFK,SAAC,GAAwE,IAAtEC,EAAqE,EAArEA,iBAAkBC,EAAmD,EAAnDA,iBAAkBC,EAAiC,EAAjCA,cAAevD,EAAkB,EAAlBA,YAClEO,EAAc,WAClB+C,KAFwF,EAI1DE,qBAAWT,GAAaI,IAJkC,mBAInFM,EAJmF,KAIzEC,EAJyE,OAKtDpD,oBAAS,GAL6C,mBAKvEqD,GALuE,WAMpFC,EAAe,SAAAhI,GACnB8H,EAAY,CACVR,KAAMtH,EAAMlG,OAAOwN,KACnBzB,MAAO7F,EAAMlG,OAAO+L,SAwCxB,OACE,gBAACjB,GAAA,EAAD,CAAOC,KAAM4C,EAAkB3C,OAAQH,EAAvC,UACE,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACE,eAACJ,GAAA,EAAMK,MAAP,gCAEF,eAACL,GAAA,EAAMM,KAAP,UACE,gBAACgB,EAAA,EAAD,CAAMU,SA3CZ,SAAsB5G,GACpBA,EAAM8G,iBACN,IAAIlP,EAAK,UAAMiQ,EAAS1P,GAAf,YAAqB8P,KAAQC,YAItC,GAAIlO,GAAc6N,EAAS9P,OAAQ,CACjCuB,QAAQC,IAAI,mBACZoL,IACAoD,GAAc,GAEdI,YAAW,WACTJ,GAAc,GACdD,EAAY,CACVV,OAAO,MAER,KACH,IAAMgB,EAAY,CAChBjQ,GAAIP,EACJY,SAAU,CAAEX,EAAG,IAAKC,EAAG,KACvBC,MAAO8P,EAAS9P,MAChBsP,eAAgBpM,SAAS4M,EAASR,gBAClCrM,MAAO,EACPG,OAAQF,SAAS4M,EAASR,gBAC1BjL,UAAU,EACVC,SAAS,EACTkB,IAAK,GACLJ,WAAY,IAEdwK,EAAcS,QAEd9O,QAAQC,IAAI,uCACZ6K,EAAY,uCACZO,KAUgC0D,cAAY,gBAA1C,UACA,gBAACnC,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,CAAYkC,QAAQ,YAApB,uBACA,eAACpC,EAAA,EAAKG,QAAN,CAAckC,UAAQ,EAACpQ,GAAG,YAAYmP,KAAK,KAAKP,KAAK,OAAOyB,YAAY,KAAK3C,MAAOgC,EAAS1P,GAAIoO,SAAUyB,OAE7G,gBAAC9B,EAAA,EAAKC,MAAN,WACM,eAACD,EAAA,EAAKE,MAAN,CAAYkC,QAAQ,aAApB,wBACI,eAACG,EAAA,EAAD,CACAC,UAAU,QACV1N,MAAO,CAAE6J,KAAM,IAAK8D,KAAM,KAC1BC,QAAS5B,GAHT,SAKA,eAAC,IAAD,CAAgB1Q,MAAO,CAAC,eAAe,WAE/C,eAAC4P,EAAA,EAAKG,QAAN,CAAclO,GAAG,aAAaoQ,UAAQ,EAACjB,KAAK,QAAQP,KAAK,OAAOyB,YAAY,qBAAqB3C,MAAOgC,EAAS9P,MAAOwO,SAAUyB,IAC9H,eAAC9B,EAAA,EAAK2C,KAAN,CAAW7F,UAAU,aAArB,yEAIN,gBAACkD,EAAA,EAAKC,MAAN,WACE,eAACD,EAAA,EAAKE,MAAN,CAAYkC,QAAQ,kBAApB,mCACA,eAACpC,EAAA,EAAKG,QAAN,CAAclO,GAAG,kBAAkBoQ,UAAQ,EAACjB,KAAK,iBAAiBP,KAAK,SAAS+B,IAAI,IAAIjD,MAAOgC,EAASR,eAAgBd,SAAUyB,OAEpI,eAACjF,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,mBAvBF,IAyBe,IACb,eAAC5B,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,UAAUoF,cAAY,yBAApD,mCC3GJlB,GAAc,SAACrF,EAAO9B,GAC1B,OAAIA,EAAMoH,MACD,CACLjP,GAAG,IAGA,2BACF2J,GADL,kBAEG9B,EAAMsH,KAAOtH,EAAM6F,SAIlB0B,GAAmB,CAACpP,GAAG,IA+Dd4Q,GA7Dc,SAAC,GAA+F,IAA9FC,EAA6F,EAA7FA,mBAAoBC,EAAyE,EAAzEA,0BAA2BC,EAA8C,EAA9CA,gBAA8BC,GAAgB,EAA7B/E,YAA6B,EAAhB+E,MAAMC,EAAU,EAAVA,KAC1GzE,EAAc,WAClBuE,EAAgBC,EAAMC,EAAM,GAC5BH,KAHwH,EAK1FvE,mBAAS,IALiF,gCAM1FkD,qBAAWT,GAAaI,KANkE,mBAMnHM,EANmH,KAMzGC,EANyG,OAOtFpD,oBAAS,GAP6E,mBAOvGqD,GAPuG,WAuC1H,OACE,gBAACnD,GAAA,EAAD,CAAOC,KAAMmE,EAAoBlE,OAAQH,EAAzC,UACE,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACE,eAACJ,GAAA,EAAMK,MAAP,mCAEF,eAACL,GAAA,EAAMM,KAAP,UACE,gBAACgB,EAAA,EAAD,CAAMU,SA7BZ,SAAsB5G,GACpBA,EAAM8G,iBACN,IAAMnN,EAASsB,SAAS4M,EAASlO,QACjCL,QAAQC,IAAI,SAAU4P,GACtB7P,QAAQC,IAAI,OAAQ6P,GACpB9P,QAAQC,IAAI,SAAUI,GACtBgL,IAGAoD,GAAc,GACdI,YAAW,WACTJ,GAAc,KACb,KAQHmB,EAAgBC,EAAMC,EAAMzP,EAAQ,IAShC,UACA,gBAACuM,EAAA,EAAKC,MAAN,WACI,gBAACD,EAAA,EAAKE,MAAN,4CAA2C+C,EAA3C,QAAsDC,EAAtD,OACA,eAAClD,EAAA,EAAKG,QAAN,CAAekC,UAAQ,EAACjB,KAAK,SAASP,KAAK,SAASyB,YAAa,EAAGM,IAAK,EAAGjD,MAAOgC,EAASlO,OAAQ4M,SAxCzF,SAAAvG,GACnB1G,QAAQC,IAAIyG,EAAMlG,OAAO+L,OACzBvM,QAAQC,IAAIyG,EAAMlG,OAAOwN,MACzBQ,EAAY,CACVR,KAAMtH,EAAMlG,OAAOwN,KACnBzB,MAAO7F,EAAMlG,OAAO+L,cAqChB,eAAC9C,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,mBALF,IAOe,IACb,eAAC5B,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,UAA9B,mCCnEJkE,GAAc,SAACrF,EAAO9B,GAC1B,OAAIA,EAAMoH,MACD,CACLjP,GAAG,IAGA,2BACF2J,GADL,kBAEG9B,EAAMsH,KAAOtH,EAAM6F,SAIlB0B,GAAmB,CAACpP,GAAG,IA4DdkR,GA1DW,SAAC,GAAqF,IAAnFC,EAAkF,EAAlFA,mBAAoBC,EAA8D,EAA9DA,0BAA2BC,EAAmC,EAAnCA,gBACpE7E,GADuG,EAAlBP,YACvE,WAClBmF,MAF2G,EAI7E3B,qBAAWT,GAAaI,IAJqD,mBAItGM,EAJsG,KAI5FC,EAJ4F,OAKzEpD,oBAAS,GALgE,mBAK1FqD,GAL0F,WAoC7G,OACE,gBAACnD,GAAA,EAAD,CAAOC,KAAMyE,EAAoBxE,OAAQH,EAAzC,UACE,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACE,eAACJ,GAAA,EAAMK,MAAP,gCAEF,eAACL,GAAA,EAAMM,KAAP,UACE,gBAACgB,EAAA,EAAD,CAAMU,SA5BZ,SAAsB5G,GACpBA,EAAM8G,iBACN,IAAIlP,EAAK,UAAMiQ,EAAS1P,GAAf,YAAqB8P,KAAQC,YACpCvD,IACAoD,GAAc,GAEdI,YAAW,WACTJ,GAAc,GACdD,EAAY,CACVV,OAAO,MAER,KAQHoC,EAPkB,CAChBrR,GAAIP,EACJY,SAAU,CAAEX,EAAG,IAAKC,EAAG,KACvBsE,UAAU,EACVjB,OAAQ,EACRsC,UAAW,OAWX,UACA,gBAACyI,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,+BACA,eAACF,EAAA,EAAKG,QAAN,CAAekC,UAAQ,EAACjB,KAAK,KAAKP,KAAK,OAAOyB,YAAY,KAAK3C,MAAOgC,EAAS1P,GAAIoO,SAvCxE,SAAAvG,GACnB1G,QAAQC,IAAIyG,EAAMlG,OAAO+L,OACzBvM,QAAQC,IAAIyG,EAAMlG,OAAOwN,MACzBQ,EAAY,CACVR,KAAMtH,EAAMlG,OAAOwN,KACnBzB,MAAO7F,EAAMlG,OAAO+L,cAoChB,eAAC9C,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,mBALF,IAOe,IACb,eAAC5B,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,UAA9B,mCChEJkE,GAAc,SAACrF,EAAO9B,GAC1B,OAAIA,EAAMoH,MACD,CACLjP,GAAG,IAGA,2BACF2J,GADL,kBAEG9B,EAAMsH,KAAOtH,EAAM6F,SAIlB0B,GAAmB,CAACpP,GAAG,IAoEdsR,GAlEU,SAAC,GAAkF,IAAhFC,EAA+E,EAA/EA,kBAAmBC,EAA4D,EAA5DA,yBAA0BC,EAAkC,EAAlCA,eACjEjF,GADmG,EAAlBP,YACnE,WAClBuF,MAFuG,EAIzE/B,qBAAWT,GAAaI,IAJiD,mBAIlGM,EAJkG,KAIxFC,EAJwF,OAKrEpD,oBAAS,GAL4D,mBAKtFqD,GALsF,WAMnGC,EAAe,SAAAhI,GACnB1G,QAAQC,IAAIyG,EAAMlG,OAAO+L,OACzBvM,QAAQC,IAAIyG,EAAMlG,OAAOwN,MACzBQ,EAAY,CACVR,KAAMtH,EAAMlG,OAAOwN,KACnBzB,MAAO7F,EAAMlG,OAAO+L,SA6BxB,OACE,gBAACjB,GAAA,EAAD,CAAOC,KAAM6E,EAAmB5E,OAAQH,EAAxC,UACE,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACE,eAACJ,GAAA,EAAMK,MAAP,gCAEF,eAACL,GAAA,EAAMM,KAAP,UACE,gBAACgB,EAAA,EAAD,CAAMU,SAhCZ,SAAsB5G,GACpBA,EAAM8G,iBACN,IAAIlP,EAAK,UAAMiQ,EAAS1P,GAAf,YAAqB8P,KAAQC,YACpCvD,IACAoD,GAAc,GAEdI,YAAW,WACTJ,GAAc,GACdD,EAAY,CACVV,OAAO,MAER,KACH,IAAMyC,EAAW,CACf1R,GAAIP,EACJY,SAAU,CAAEX,EAAG,IAAKC,EAAG,KACvBuE,SAAS,EACTD,UAAU,EACVjB,OAAQ,EACRH,MAAO,EACPuC,IAAK,GACLE,UAAWoK,EAASpK,UACpBN,WAAY,IAEdyM,EAAeC,IASb,UACA,gBAAC3D,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,8BACA,eAACF,EAAA,EAAKG,QAAN,CAAekC,UAAQ,EAACjB,KAAK,KAAKP,KAAK,OAAOyB,YAAY,KAAK3C,MAAOgC,EAAS1P,GAAIoO,SAAUyB,OAEjG,gBAAC9B,EAAA,EAAKC,MAAN,WACE,eAACD,EAAA,EAAKE,MAAN,qCACA,eAACF,EAAA,EAAKG,QAAN,CAAekC,UAAQ,EAACjB,KAAK,YAAYP,KAAK,OAAOyB,YAAY,QAAQ3C,MAAOgC,EAASpK,UAAW8I,SAAUyB,OAE9G,eAACjF,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,mBATF,IAWe,IACb,eAAC5B,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,UAA9B,mCCyBK6G,GAlGM,SAAC,GAAmF,IAAjFC,EAAgF,EAAhFA,cAAeC,EAAiE,EAAjEA,qBAAsBC,EAA2C,EAA3CA,eAAgB7F,EAA2B,EAA3BA,YAAa/I,EAAc,EAAdA,QAAc,EAEpEqJ,mBAAS,IAF2D,mBAE7FiB,EAF6F,KAEnFuE,EAFmF,OAG1ExF,mBAAS,IAHiE,mBAG7F3M,EAH6F,KAGtFoS,EAHsF,OAIxDzF,mBAAS,GAJ+C,mBAI7F2C,EAJ6F,KAI7E+C,EAJ6E,KAK9FzF,EAAc,WAChBuF,EAAY,MACZC,EAAS,MACTC,EAAkB,MAElBJ,KAEJ/S,qBAAU,WAIe4F,OAAOC,KAAKzB,GAASgP,QAAO,SAAUC,EAAGzD,GAE1D,OADKxL,EAAQwL,GAAGzK,UAAaf,EAAQwL,GAAGxK,UAASiO,EAAEzD,GAAKxL,EAAQwL,IACzDyD,IACR,MALJ,IAWH,IAAIC,EAAiB1N,OAAOC,KAAKzB,GAASgP,QAAO,SAAUC,EAAGzD,GAG1D,OAFKxL,EAAQwL,GAAGzK,UAAaf,EAAQwL,GAAGxK,UAASiO,EAAEzD,GAAKxL,EAAQwL,IAEzDyD,IACR,IACCtE,EAAgBnJ,OAAOC,KAAKyN,GAAgBtE,KAAI,SAAC/J,GAAD,OAChD,yBAAQ2J,MAAO3J,EAAf,SAAqCA,GAATA,MA+BhC,OACI,gBAAC0I,GAAA,EAAD,CAAOC,KAAMkF,EAAejF,OAAQH,EAApC,UACI,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACI,eAACJ,GAAA,EAAMK,MAAP,kCAEJ,eAACL,GAAA,EAAMM,KAAP,UACI,gBAACgB,EAAA,EAAD,CAAMU,SA1BlB,SAAsB5G,GAClB1G,QAAQC,IAAIoM,EAAU5N,EAAOsP,GAC7BrH,EAAM8G,iBACNxN,QAAQC,IAAIoM,EAAU5N,EAAOsP,GACxB1B,GAAwB,MAAZA,EAKT3L,GAAcjC,IACduB,QAAQC,IAAI,mBACZoL,IACAsF,EAAetE,EAAU5N,EAAOsP,KAEhC/N,QAAQC,IAAI,uCACZ6K,EAAY,wCAVhBA,EAAY,iCAqBsBiE,cAAY,iBAA1C,UACI,gBAACnC,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,mBACA,gBAACF,EAAA,EAAKG,QAAN,CAAckC,UAAQ,EAACF,cAAY,gBAAgB/B,GAAG,SAASkE,cAAe,EAAGjE,SApCrG,SAA4BvG,GACxB,IAAI7H,EAAK6H,EAAMlG,OAAO+L,MAEtBqE,EAAY/R,GACZgS,EAAS9O,EAAQlD,GAAIJ,OACrBqS,EAAkB/O,EAAQlD,GAAIkP,iBA+Bd,UACI,yBAAQ3D,UAAQ,EAACmC,OAAQ,EAAzB,2BAAkC,GACjCG,QAGT,gBAACE,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,CAAYkC,QAAQ,aAApB,wBACA,eAACpC,EAAA,EAAKG,QAAN,CAAclO,GAAG,aAAaoQ,UAAQ,EAACjB,KAAK,QAAQP,KAAK,OAAOyB,YAAY,qBAAqB3C,MAAO9N,EAAOwO,SAAU,SAACvG,GAAYmK,EAASnK,EAAMlG,OAAO+L,UAC5J,eAACK,EAAA,EAAK2C,KAAN,CAAW7F,UAAU,aAArB,yEAIJ,gBAACkD,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,CAAYkC,QAAQ,iBAApB,mCACA,eAACpC,EAAA,EAAKG,QAAN,CAAclO,GAAG,iBAAiBoQ,UAAQ,EAACjB,KAAK,iBAAiBP,KAAK,SAAS+B,IAAI,IAAIN,YAAY,IAAI3C,MAAOwB,EAAgBd,SAAU,SAACvG,GAAD,OAAWoK,EAAkBpK,EAAMlG,OAAO+L,aAEtL,eAAC9C,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,mBAnBJ,IAqBO,IACH,eAAC5B,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,UAAUoF,cAAY,0BAApD,mCCJLoC,GArFW,SAAC,GAAkG,IAAhGC,EAA+F,EAA/FA,mBAAoBC,EAA2E,EAA3EA,0BAA2BC,EAAgD,EAAhDA,oBAAqBxG,EAA2B,EAA3BA,YAAa/I,EAAc,EAAdA,QAAc,EAExFqJ,mBAAS,IAF+E,mBAEjHiB,EAFiH,KAEvGuE,EAFuG,OAGpFxF,mBAAS,IAH2E,mBAGjHmG,EAHiH,KAGrGC,EAHqG,KAKlHnG,EAAc,WAChBmG,EAAc,MACdZ,EAAY,MAEZS,KAEJ1T,qBAAU,WAIe4F,OAAOC,KAAKzB,GAASgP,QAAO,SAAUC,EAAGzD,GAE1D,OADIxL,EAAQwL,GAAGxK,UAASiO,EAAEzD,GAAKxL,EAAQwL,IAChCyD,IACR,MALJ,IAQH,IAAIC,EAAiB1N,OAAOC,KAAKzB,GAASgP,QAAO,SAAUC,EAAGzD,GAG1D,OAFIxL,EAAQwL,GAAGxK,UAASiO,EAAEzD,GAAKxL,EAAQwL,IAEhCyD,IACR,IACCtE,EAAgBnJ,OAAOC,KAAKyN,GAAgBtE,KAAI,SAAC/J,GAAD,OAChD,yBAAQ2J,MAAO3J,EAAf,SAAqCA,GAATA,MAyBhC,OACI,gBAAC0I,GAAA,EAAD,CAAOC,KAAM6F,EAAoB5F,OAAQH,EAAzC,UACI,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACI,eAACJ,GAAA,EAAMK,MAAP,gCAEJ,eAACL,GAAA,EAAMM,KAAP,UACI,gBAACgB,EAAA,EAAD,CAAMU,SAtBlB,SAAsB5G,GAElBA,EAAM8G,iBAEDnB,GAAwB,MAAZA,GAMThB,IACAiG,EAAoBjF,EAAUkF,IANlCzG,EAAY,kCAiBsBiE,cAAY,iBAA1C,UACI,gBAACnC,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,mBACA,gBAACF,EAAA,EAAKG,QAAN,CAAckC,UAAQ,EAACF,cAAY,gBAAgB/B,GAAG,SAASkE,cAAe,EAAGjE,SA9BrG,SAA4BvG,GACxB,IAAI7H,EAAK6H,EAAMlG,OAAO+L,MACtBqE,EAAY/R,GACZ2S,EAAczP,EAAQlD,GAAIsF,YA2BV,UACI,yBAAQiG,UAAQ,EAACmC,OAAQ,EAAzB,kCAAkC,GACjCG,QAIT,gBAACE,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,oCACA,eAACF,EAAA,EAAKG,QAAN,CAAclO,GAAG,aAAaoQ,UAAQ,EAACjB,KAAK,aAAaP,KAAK,OAAOyB,YAAY,QAAQ3C,MAAOgF,EAAYtE,SAAU,SAACvG,GAAY8K,EAAc9K,EAAMlG,OAAO+L,UAC9J,gBAACK,EAAA,EAAK2C,KAAN,CAAW7F,UAAU,aAArB,qDAC4C,wCAD5C,SAC+D,qDAD/D,WACiG,yCADjG,WAIJ,eAACD,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,mBAhBJ,IAkBO,IACH,eAAC5B,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,UAAUoF,cAAY,0BAApD,mCCuCL0C,GApHS,SAAC,GACyC,IA6C1DC,EA9CmBC,EACsC,EADtCA,qBAAsBC,EACgB,EADhBA,4BAA6BC,EACb,EADaA,kBAAmB/G,EAChC,EADgCA,YAAa/I,EAC7C,EAD6CA,QAAS0D,EACtD,EADsDA,iBAAkBmB,EACxE,EADwEA,MAAOC,EAC/E,EAD+EA,MAC5IiL,EAA6D,EAA7DA,UAAWC,EAAkD,EAAlDA,YAAa1M,EAAqC,EAArCA,WAAY2M,EAAyB,EAAzBA,oBAC9B3G,EAAc,WAEZyG,EADArM,EACUsM,EAIA,GAGdH,KAKJ,SAASK,EAAavL,GAClBA,EAAM8G,iBAED/H,GAMD4F,IACAwD,YAAW,cACR,KAEgB,GAAfkD,EACA1M,GAAW,SAAAhD,GACP,IAAIiG,EAAW,eAAOjG,EAAMuE,GAAO/C,YACnCyE,EAAYzB,GAAS,EACrBxE,EAAMuE,GAAO/C,WAAayE,EAC1B0J,EAAoBpL,EAAOC,MAM/BgL,EAAkBjL,EAAOC,EAAOkL,IApBpCjH,EAAY,kCA4BpB,GAAIrF,EAAiB,CACjB,IAAI6C,EAAW,eAAOvG,EAAQ6E,GAAO/C,YACrC6N,EAAa/P,SAAS2G,EAAYzB,SAKlCiL,EAAU,GACVJ,EAAa,EAGjB,OAAIjM,EAEI,gBAAC6F,GAAA,EAAD,CAAOC,KAAMoG,EAAsBnG,OAAQH,EAA3C,UACC,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACO,eAACJ,GAAA,EAAMK,MAAP,qCAEJ,eAACL,GAAA,EAAMM,KAAP,UACI,gBAACgB,EAAA,EAAD,CAAMU,SAAU2E,EAAclD,cAAY,iBAA1C,UACI,eAACnC,EAAA,EAAKC,MAAN,UAEI,gBAACD,EAAA,EAAKE,MAAN,gCAA+BlG,EAA/B,KAAwCC,OAE5C,eAAC+F,EAAA,EAAKC,MAAN,UACI,gBAACD,EAAA,EAAKE,MAAN,2BAAyB,6BAAIlG,SAEjC,eAACgG,EAAA,EAAKC,MAAN,UACI,gBAACD,EAAA,EAAKE,MAAN,gCAA8B,6BAAIjG,SAEtC,gBAAC+F,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,CAAYkC,QAAQ,iBAApB,4BACA,eAACpC,EAAA,EAAKG,QAAN,CAAclO,GAAG,iBAAiBoQ,UAAQ,EAACjB,KAAK,SAASP,KAAK,SAAS+B,IAAI,IAAIN,YAAawC,EAAYnF,MAAOwF,EAAa9E,SAAU,SAACvG,GAAYoL,EAAUpL,EAAMlG,OAAO+L,UAC1K,gBAACK,EAAA,EAAK2C,KAAN,CAAW7F,UAAU,aAArB,uBACc,qDADd,UAKJ,eAACD,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,mBAnBJ,IAqBO,IACH,eAAC5B,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,UAAUoF,cAAY,0BAApD,kCAYZ,gBAACzD,GAAA,EAAD,CAAOC,KAAMoG,EAAsBnG,OAAQH,EAA3C,UACC,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACO,eAACJ,GAAA,EAAMK,MAAP,qCAEJ,eAACL,GAAA,EAAMM,KAAP,UACI,eAACgB,EAAA,EAAD,CAAMU,SAAU2E,EAAclD,cAAY,iBAA1C,SACI,eAACnC,EAAA,EAAKC,MAAN,UAEI,eAACD,EAAA,EAAKE,MAAN,UAAY,kGCrDzBoF,GAxDQ,SAAC,GAAyF,IAAvFC,EAAsF,EAAtFA,gBAAiBC,EAAqE,EAArEA,uBAAwBC,EAA6C,EAA7CA,iBAA+BtQ,GAAc,EAA3B+I,YAA2B,EAAd/I,SAAc,EAC5EqJ,mBAAS,IADmE,mBACrGiB,EADqG,KAC3FuE,EAD2F,KAEtGvF,EAAc,WAChB+G,KAEA1F,EAAgBnJ,OAAOC,KAAKzB,GAAS4K,KAAI,SAAC/J,GAAD,OACzC,yBAAQ2J,MAAO3J,EAAf,SAAqCA,GAATA,MAG5B0P,EAAgB/O,OAAOC,KAAKzB,GAAS,GAsBzC,OACI,gBAACuJ,GAAA,EAAD,CAAOC,KAAM4G,EAAiB3G,OAAQH,EAAtC,UACI,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACI,eAACJ,GAAA,EAAMK,MAAP,4BAEJ,eAACL,GAAA,EAAMM,KAAP,UACI,gBAACgB,EAAA,EAAD,CAAMU,SAxBlB,SAAsB5G,GAClBA,EAAM8G,iBACQ,KAAXnB,GAEChB,IACIwD,YAAW,WACP+B,EAAY,MACb,KACHyB,EAAiBhG,KAErBhB,IACIwD,YAAW,WACP+B,EAAY,MACb,KACHyB,EAAiBC,KAUjB,UACI,gBAAC1F,EAAA,EAAKC,MAAN,WACI,eAACD,EAAA,EAAKE,MAAN,oCACA,gBAACF,EAAA,EAAKG,QAAN,CAAcC,GAAG,SAASkE,cAAe,EAAGjE,SA9BhE,SAA4BvG,GACxBkK,EAAYlK,EAAMlG,OAAO+L,QA6BT,UACI,yBAAQnC,UAAQ,EAACmC,OAAQ,EAAzB,2BAAkC,GACjCG,QAGT,eAACjD,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,mBARJ,IAUO,IACH,eAAC5B,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,SAA9B,oCCTLuI,GAvCQ,SAAC,GAAqF,IAAnFK,EAAkF,EAAlFA,mBAAoBC,EAA8D,EAA9DA,0BAA2BC,EAAmC,EAAnCA,gBAAmC,KAAlB3H,YACtDM,mBAAS,KAD+D,mBACvFwF,GADuF,WAElGvF,EAAc,WAChBmH,KAcJ,OACI,gBAAClH,GAAA,EAAD,CAAOC,KAAMgH,EAAoB/G,OAAQH,EAAzC,UACI,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACI,eAACJ,GAAA,EAAMK,MAAP,0BAEJ,eAACL,GAAA,EAAMM,KAAP,UACI,gBAACgB,EAAA,EAAD,CAAMU,SAjBlB,SAAsB5G,GAClBA,EAAM8G,iBACNnC,IACAwD,YAAW,WACP+B,EAAY,MACb,KAEH6B,KAUQ,UACI,eAAC7F,EAAA,EAAKC,MAAN,UACI,eAACD,EAAA,EAAKE,MAAN,8DAEJ,eAACrD,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,SAA9B,iBAGA,eAACF,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,gBAPJ,IASe,aCgChBqH,GAhEW,SAAC,GACJ,IADMC,EACP,EADOA,uBAAwBC,EAC/B,EAD+BA,8BAA+BZ,EAC9D,EAD8DA,oBAAkC3M,GAChG,EADmFyF,YACnF,EADgGzF,YAAYI,EAC5G,EAD4GA,iBAC9HmB,EAAkB,EAAlBA,MAAOC,EAAW,EAAXA,MACDwE,EAAc,WAChBuH,KAGJ,SAASX,EAAavL,GAClBA,EAAM8G,iBACNnC,IACAwD,YAAW,cACR,KAEHxJ,GAAW,SAAAhD,GACP,IAAIiG,EAAW,eAAOjG,EAAMuE,GAAO/C,YACnCyE,EAAYzB,GAAS,EACrBxE,EAAMuE,GAAO/C,WAAayE,EAC1B0J,EAAoBpL,EAAOC,MAKnC,OAAIpB,EAEI,gBAAC6F,GAAA,EAAD,CAAOC,KAAMoH,EAAwBnH,OAAQH,EAA7C,UACI,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACI,eAACJ,GAAA,EAAMK,MAAP,+BAEJ,eAACL,GAAA,EAAMM,KAAP,UACI,gBAACgB,EAAA,EAAD,CAAMU,SAAU2E,EAAhB,UACI,eAACrF,EAAA,EAAKC,MAAN,UACI,gBAACD,EAAA,EAAKE,MAAN,uEAAqE,6BAAIlG,IAAzE,oBAAoG,6BAAIC,IAAxG,SAEJ,eAAC4C,EAAA,EAAD,CAAQgE,KAAK,SAAS9D,QAAQ,SAA9B,iBAGA,eAACF,EAAA,EAAD,CAAQE,QAAQ,YAAYC,QAASyB,EAArC,gBAPJ,IASe,YAUvB,gBAACC,GAAA,EAAD,CAAOC,KAAMoH,EAAwBnH,OAAQH,EAA7C,UACC,eAACC,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAzB,SACO,eAACJ,GAAA,EAAMK,MAAP,uCAEJ,eAACL,GAAA,EAAMM,KAAP,UACI,eAACgB,EAAA,EAAD,CAAMU,SAAU2E,EAAclD,cAAY,iBAA1C,SACI,eAACnC,EAAA,EAAKC,MAAN,UAEI,eAACD,EAAA,EAAKE,MAAN,UAAY,oG,UCTlC+F,I,OAAY,SAAC3V,GACf,OACI,8BACKA,MAKP4V,GAAW,SAAC5V,EAAQ4D,GACtB,OACI,8BACK5D,GADI,QAAQ4D,IAMViS,GAhEO,SAAC,GAA+D,IAA9DpU,EAA6D,EAA7DA,KAAKqU,EAAwD,EAAxDA,uBAAuBC,EAAiC,EAAjCA,6BAC5CC,EAAiBxO,KAAKG,MAAMnB,aAAaoB,QAAQnG,EAAK,EAAE,QACxDwU,EAAY,uDACbD,IACCC,EAAY5P,OAAOC,KAAK0P,GAAgBvG,KAAI,SAAC/J,GAAD,OACxC,qBAAI8G,UAAU,wBAAd,mBAAwD9G,EAAO7D,SAAS,KAAO6D,EAAO5D,OAAO,EAAG4D,EAAO3D,QAAQ,MAAQ2D,IAA5EA,OAMnD,IAFA,IAAIwQ,EAAa,GAETtS,EAAI,EAAGA,EAAEnC,EAAMmC,IAAI,CACvB,IAAIuS,EAAY,GAChBA,EAAYnQ,KAAK,sBAAIwG,UAAU,OAAd,cAAuB5I,EAAvB,QACjB,IAAI0H,EAAQ9D,KAAKG,MAAMnB,aAAaoB,QAAQhE,EAAE,QAC9C,IAAI,IAAI6B,KAAK6F,EACNA,EAAM7F,GAAGK,WACRqQ,EAAYnQ,KAAK2P,GAAUrK,EAAM7F,GAAGK,WAAW3D,QAAQ,MAAO,YACzDmJ,EAAM7F,GAAGG,SACduQ,EAAYnQ,KAAK2P,GAAU,GAAD,OAAmC,kBAAvBrK,EAAM7F,GAAGwB,UAA0BqE,EAAM7F,GAAGwB,UAAU9E,QAAQ,qBAAqB,IAAM,MAE/HgU,EAAYnQ,KAAK2P,GAAU,wBAGnCO,EAAWlQ,KAAK4P,GAASO,EAAavS,IACtCuS,EAAc,GAElB,OACI,eAAC/H,GAAA,EAAD,CAAOC,KAAMyH,EACbxH,OAAQyH,EACRvJ,UAAU,8BACVO,KAAK,KAHL,SAKQ,gBAACqJ,GAAA,EAAD,CAAO5J,UAAU,gBAAgB6J,SAAO,EAACC,UAAQ,EAACC,OAAK,EAAC1E,cAAY,uBAApE,UACI,iCACI,gCACI,qBAAIrF,UAAU,WAAd,kBACCyJ,OAGT,iCACKC,U,kDCtBVM,GAlBW,WAAM,IAAD,EACCtI,oBAAS,GADV,mBACpBuI,EADoB,KACXC,EADW,KAErBC,EAAU,4DAchB,OAbAlW,qBAAU,WAON,OAHA8F,OAAOqQ,eAAiBH,GAAY,kBAAME,GAGnC,WAEHpQ,OAAOqQ,eAAiB,QAE9B,CAACH,IAEI,CADc,eAAC,KAAD,CAAQI,KAAMJ,EAASE,QAASA,IAC/B,kBAAID,GAAS,IAAO,kBAAIA,GAAS,M,SCbrDI,GAAa,CACjB,CACExT,OAAQ,mBACRC,MAAM,wBACNvD,QAAS,oFACTkS,UAAU,SACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAetB,CACE5T,OAAO,gBACPC,MAAO,WACPvD,QAAS,2JACTkS,UAAW,QACX6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAItB,CACE5T,OAAO,gBACPC,MAAM,iBACNvD,QAAQ,mXACRkS,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,iBACPC,MAAO,iBACPvD,QAAS,sPACTkS,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,kBACPC,MAAO,kBACPvD,QAAS,mPACTkS,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,gBACPC,MAAO,cACPvD,QAAQ,+SACRkS,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,iBACPC,MAAO,oBACPvD,QAAQ,mRACRkS,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,qBACPC,MAAO,kBACPvD,QAAQ,+RACRkS,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAItB,CACE5T,OAAO,gBACPC,MAAO,eACPvD,QAAQ,iNACRkS,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,eACPC,MAAO,iBACPvD,QAAQ,6JACRkS,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,iBACPC,MAAO,YACPvD,QAAQ,gKACRkS,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAItB,CACE5T,OAAO,iCACPC,MAAO,gBACPvD,QAAQ,mVACRkS,UAAU,eACViF,QAAQ,IACRJ,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,iCACPC,MAAM,iBACNvD,QAAQ,sMACRkS,UAAU,eACViF,QAAQ,IACRJ,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAItB,CACE5T,OAAO,mBACPC,MAAM,0BACNvD,QAAQ,4LACRkS,UAAU,SACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,mBACPC,MAAM,0BACNvD,QAAQ,uMACRkS,UAAU,SACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,gBACPC,MAAM,0BACNvD,QAAQ,iQACRkS,UAAU,SACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,WACPC,MAAM,qBACNvD,QAAQ,4EACRkS,UAAU,SACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,oBACPC,MAAM,8BACNvD,QAAQ,iXACRkS,UAAU,SACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,yBACPC,MAAM,eACNvD,QAAQ,8HACRkS,UAAU,QACViF,OAAQ,IACRJ,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,eACPC,MAAO,gBACPvD,QAAQ,kEACRmX,OAAQ,GACRjF,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,YACPC,MAAO,iBACPvD,QAAQ,uFACRmX,OAAQ,IACRjF,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,sBACPC,MAAM,iBACNvD,QAAQ,mFACRmX,OAAQ,GACRjF,UAAW,QACX6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,IAGtB,CACE5T,OAAO,iBACPC,MAAM,mBACNvD,QAAQ,2FACRmX,OAAQ,GACRjF,UAAU,QACV6E,eAAe,EACfC,qBAAqB,EACrBC,aAAc,CACZC,kBAAkB,KAlRL,IAsRf5T,OAAQ,mBACRC,MAAM,cACNvD,QAAQ,2FACRkS,UAAU,SACV6E,eAAe,GA1RA,gCA2RD,GA3RC,8BA4RD,CACZG,kBAAkB,IA7RL,KAmSbE,GAAgB,CACpBC,IAAK,IAAIC,KACTC,KAAK,EACLC,YAAY,EACZC,SAAS,EACTC,UAAW,EACXC,MAAOb,IAKHc,GAAU,WAAoC,IAAnCtM,EAAkC,uDAA1B8L,GAAeS,EAAW,uCACjD,OAAQA,EAAOtH,MAEb,IAAK,QACH,OAAO,2BAAKjF,GAAZ,IAAmBiM,KAAK,IAE1B,IAAK,QACH,OAAO,2BAAKjM,GAAZ,IAAmBoM,UAAW,IAEhC,IAAK,OACH,OAAO,2BAAKpM,GAAZ,IAAmBiM,KAAK,IAE1B,IAAK,eACH,OAAO,2BAAKjM,GAAUuM,EAAOC,SAE/B,IAAK,UACH,OAAO,2BACFxM,GADL,IAEEoM,UAAW,EACXH,KAAK,EACLE,SAAS,EACTJ,IAAK,IAAIC,OAEb,QACE,OAAOhM,IAKP1L,GAAQ,CACZmY,YAAa,CACXC,gBAAiB,WAEnBC,QAAQ,CACND,gBAAiB,OACjBE,UAAW,OACXC,SAAU,IAEZC,iBAAkB,CAChBpL,UAAW,UAEbqL,aAAc,CACZF,SAAU,GACVG,OAAQ,WAEVC,WAAY,CACVP,gBAAiB,WAEnBQ,WAAY,CACVzY,MAAO,WAET0Y,WAAW,CACT1Y,MAAM,WAERqS,QAAQ,CACN4F,gBAAiB,mBACjBU,aAAc,YAEhBC,gBAAgB,CACdC,UAAU,0DAEZC,QAAS,CACPC,MAAO,CACL/Y,MAAO,QAETkY,QAAS,CACPc,OAAQ,OAuFCC,GAjFF,SAAC,GAAqJ,IAApJC,EAAmJ,EAAnJA,wBAAyBC,EAA0H,EAA1HA,yBAA0BC,EAAgG,EAAhGA,sBAAuBC,EAAyE,EAAzEA,uBAAwBC,EAAiD,EAAjDA,gBAAiBC,EAAgC,EAAhCA,2BAAgC,EAElIlI,qBAAWwG,GAASR,IAF8G,mBAEzJmC,EAFyJ,KAE9IC,EAF8I,KAIhK/Y,qBAAU,WAEH+F,aAAaoB,QAAQ,SACxB4R,EAAS,CAAEjJ,KAAM,YAElB,IAoDH,OANA9P,qBAAU,WACc,GAAnB4Y,GAJHG,EAAS,CAAEjJ,KAAM,cAOhB,CAAC8I,IAGF,qCACE,eAAC,KAAD,2BACIE,GADJ,IAGAE,SAlDa,SAAA/X,GAAS,IAChBmW,EAAgCnW,EAAhCmW,OAAQ6B,EAAwBhY,EAAxBgY,MAAOnJ,EAAiB7O,EAAjB6O,KAAMoJ,EAAWjY,EAAXiY,OAI3B9B,IAAW+B,KAAQC,OAElBF,IAAWG,KAAOC,SAAWR,EAAUhC,KACxCoC,IAAWG,KAAOE,SAElBR,EAAS,CAAEjJ,KAAM,SACRA,IAAS0J,KAAOC,YAAc3J,IAAS0J,KAAOE,iBAEvDX,EAAS,CACPjJ,KAAM,eACNuH,QAAS,CAAEJ,UAAWgC,GAAS7B,IAAW+B,KAAQQ,MAAQ,EAAI,MAE7C,IAAVV,EACTN,IACkB,IAAVM,GACRT,IACAK,KACmB,IAAVI,GAAe7B,IAAW+B,KAAQQ,MAExB,IAAVV,EADTR,IAGmB,KAAVQ,EACTP,IACmB,KAAVO,IACTN,IAhCF5S,aAAaC,QAAQ,OAAQ,OAsD3B4T,mBAAmB,EACnBC,gBAAgB,EAChBC,gBAAgB,EAChBC,cAAc,EACdhD,YAAY,EACZ5X,OAAQA,GACR6a,OAAQ,CACNC,KAAM,WACNC,KAAM,mBCraVpL,GAAU,CAAEqL,SAAS,EAAMC,eAAe,EAAMC,OAAQ,EAAGC,UAAU,GACrEC,GAAc,EACdzS,IAAmB,EACnB0S,IAAU,EACVC,GAAS,GACTC,GAAS,GAEb,SAASC,GAAO/D,EAAKgE,GACnB,IAAMC,EAAU9a,kBAAO,GACjB+a,EAAc/a,iBAAO6a,GAErBG,EAASlR,SAASmR,qBAAqB,SAG7Chb,qBAAU,WAAO,IAAD,gBACI+a,GADJ,IACd,2BAA0B,CAAC,IAAlB/Y,EAAiB,QACxBA,EAAMiZ,iBAAiB,WAAW,WAAQJ,EAAQ1a,SAAU,EAAMkC,QAAQC,IAAI,kBAC9EN,EAAMiZ,iBAAiB,SAAS,WAAQJ,EAAQ1a,SAAU,EAAMkC,QAAQC,IAAI,oBAC5EN,EAAMiZ,iBAAiB,SAAS,WAAQJ,EAAQ1a,SAAU,EAAMkC,QAAQC,IAAI,oBAAqB,GACjGN,EAAMiZ,iBAAiB,YAAY,WAAQJ,EAAQ1a,SAAU,MALjD,kCAShBH,qBAAU,WACR8a,EAAY3a,QAAUya,KAExB5a,qBAAU,WAcR,SAASkb,EAAcnS,GACrB1G,QAAQC,IAAR,kBAAuBuY,EAAQ1a,UAC3B4I,EAAMoS,OAASvE,GAA0B,GAAnBiE,EAAQ1a,UAChCkC,QAAQC,IAAR,iCAAsCuY,EAAQ1a,UAE9CkC,QAAQC,IAAI,gBAAkByG,EAAMoS,MACpCL,EAAY3a,QAAQ4I,IAMxB,OAFAc,SAASoR,iBAAiB,WAAW,SAAClS,GAA+B,UAAfA,EAAMoS,MAA+B,GAAXN,GAAoB9R,EAAM8G,oBAC1GhG,SAASoR,iBAAiB,UAxB1B,SAAmBlX,EAAOqX,GACxB,IAAIC,EACJ,OAAO,WAAoB,IAAD,uBAANC,EAAM,yBAANA,EAAM,gBACpBD,GACFE,aAAaF,GAEfA,EAAUnK,YAAW,WACnBkK,EAAE,WAAF,EAAME,GACND,EAAU,OACTtX,IAe+ByX,CAAU,IAAKN,IAC9C,kBAAMrR,SAAS4R,oBAAoB,UAAWP,MACpD,CAACtE,IAm9BN,IAAM8E,GAAaC,YAAH,0GAWVC,GAAcC,IAAOC,IAAV,kIACf,SAAA9L,GAAK,OACLA,EAAM+L,WACNnc,YADA,iEAEe8b,GAAcnB,OAShByB,GAx+Bf,WAAgB,IAAD,EACiB1N,YAA4D,MAAlDxI,OAAOC,aAAaoB,QAAQ,mBAA8BJ,KAAKG,MAAMpB,OAAOC,aAAaoB,QAAQ,oBAAsB,CAC7J8U,GAAI,CACF/a,GAAI,KACJK,SAAU,CAAEX,EAAG,GAAIC,EAAG,IACtBC,MAAO,YACPsP,eAAgB,EAChBrM,MAAO,EACPG,OAAQ,EACRiB,UAAU,EACVC,SAAS,EACTkB,IAAK,CAAC,MACNJ,WAAY,CAAC,GAAM,IAErBgW,GAAI,CACFhb,GAAI,KACJK,SAAU,CAAEX,EAAG,IAAKC,EAAG,IACvBC,MAAO,WACPsP,eAAgB,EAChBrM,MAAO,EACPG,OAAQ,EACRiB,UAAU,EACVC,SAAS,EACTkB,IAAK,CAAC,MACNJ,WAAY,CAAC,GAAM,IAErBiW,GAAI,CACFjb,GAAI,KACJK,SAAU,CAAEX,EAAG,IAAKC,EAAG,IACvBC,MAAO,WACPsP,eAAgB,EAChBrM,MAAO,EACPG,OAAQ,EACRiB,UAAU,EACVC,SAAS,EACTkB,IAAK,CAAC,MACNJ,WAAY,CAAC,GAAM,IAErBkW,GAAI,CACFlb,GAAI,KACJK,SAAU,CAAEX,EAAG,IAAKC,EAAG,KACvBsE,UAAU,EACVC,SAAS,EACTlB,OAAQ,EACRsC,UAAW,OA5CF,mBACNpC,EADM,KACGsD,EADH,OAkDW+F,mBAAS,IAlDpB,mBAkDNyE,EAlDM,KAkDAmK,EAlDA,OAmDW5O,mBAAS,IAnDpB,mBAmDN0E,EAnDM,KAmDAmK,EAnDA,OAoDW7O,mBAAS,GApDpB,mBAoDNzM,EApDM,KAoDAub,EApDA,OAqDiB9O,mBAAS,IArD1B,mBAqDNP,EArDM,aAsDqBO,mBAAS,KAtD9B,oBAsDNL,GAtDM,gBAuDyBK,mBAAS,KAvDlC,qBAuDNJ,GAvDM,gBAwDyBI,mBAAS,KAxDlC,qBAwDNH,GAxDM,gBAyDyBG,mBAAS,KAzDlC,qBAyDNF,GAzDM,gBA0D+BE,mBAAS,KA1DxC,qBA0DND,GA1DM,gBA2DoBC,mBAAS,IA3D7B,qBA2DN2G,GA3DM,MA2DOD,GA3DP,SA4D2B1G,oBAAS,GA5DpC,qCA6DmBA,oBAAS,IA7D5B,qBA6DNpJ,GA7DM,MA6DImY,GA7DJ,SA8DmB/O,mBAAS,IA9D5B,qBA8DNgP,GA9DM,MA8DIC,GA9DJ,SA+D2B3G,KA/D3B,qBA+DN4G,GA/DM,MA+DE1G,GA/DF,MA+DY2G,GA/DZ,SAiEmCnP,oBAAS,GAjE5C,qBAiENT,GAjEM,MAiEY6P,GAjEZ,SAkEuCpP,oBAAS,GAlEhD,qBAkENsE,GAlEM,MAkEc+K,GAlEd,SAmEmCrP,oBAAS,GAnE5C,qBAmEN+C,GAnEM,MAmEYuM,GAnEZ,SAoEuCtP,oBAAS,GApEhD,qBAoEN4E,GApEM,MAoEc2K,GApEd,SAqEqCvP,oBAAS,GArE9C,qBAqENgF,GArEM,MAqEawK,GArEb,SAsEyCxP,oBAAS,GAtElD,qBAsENU,GAtEM,MAsEe+O,GAtEf,SAuE6BzP,oBAAS,GAvEtC,qBAuENqF,GAvEM,MAuESqK,GAvET,SAwEuC1P,oBAAS,GAxEhD,qBAwENgG,GAxEM,MAwEc2J,GAxEd,SAyE2C3P,oBAAS,GAzEpD,qBAyENuG,GAzEM,MAyEgBqJ,GAzEhB,SA0E+C5P,oBAAS,GA1ExD,qBA0EN4H,GA1EM,MA0EkBiI,GA1ElB,SA2EuC7P,oBAAS,GA3EhD,qBA2ENmH,GA3EM,MA2Ec2I,GA3Ed,SA4EiC9P,oBAAS,GA5E1C,qBA4EN+G,GA5EM,MA4EWgJ,GA5EX,SA6E+C/P,oBAAS,GA7ExD,qBA6ENuH,GA7EM,MA6EkByI,GA7ElB,SA+EqChQ,oBAAS,GA/E9C,qBA+EaiQ,IA/Eb,gBAgFiCjQ,oBAAS,GAhF1C,qBAgFNkQ,GAhFM,MAgFWC,GAhFX,SAkFqBnQ,oBAAS,GAlF9B,qBAkFNsO,GAlFM,MAkFK8B,GAlFL,SAmFmBpQ,oBAAS,GAnF5B,qBAmFNqQ,GAnFM,MAmFIC,GAnFJ,SAoFatQ,mBAAS,IApFtB,qBAoFNuQ,GApFM,MAoFCC,GApFD,SAqFWxQ,mBAAS,GArFpB,qBAqFNyQ,GArFM,MAqFAC,GArFA,SAuFoB1Q,mBAAS,GAvF7B,qBAuFN2Q,GAvFM,MAuFKC,GAvFL,MAkHPC,GAA2B,kBAAMf,IAAsB,IAMvDnP,GAA6B,kBAAM8O,IAAuB,IAxHnD,GA0HSzP,mBAAS,gBA1HlB,qBA0HN8Q,GA1HM,MA0HDC,GA1HC,SAuIiC/Q,oBAAS,GAvI1C,qBAuINmL,GAvIM,MAuIW6F,GAvIX,MA8IPla,GAAsB,WAC1BwZ,IAAY,GACZF,IAAa,GACbxb,QAAQC,IAAI,4BACZoc,MAAM,0BAGFC,GAAY,SAACC,GACjBX,GAASW,GACT1N,YAAW,WACT+M,GAAS,MACR,MA8FC5W,GAAe,SAAC7E,EAAKC,GACzB4Z,EAAQ7Z,GACR8Z,EAAQ7Z,GACRJ,QAAQC,IAAI,UAAWE,EAAKC,GAE5BiF,GAAW,SAAAhD,GACT,IAAIma,EAAO,YAAOna,EAAMlC,GAAK8D,KACzBqE,EAAW,eAAOjG,EAAMlC,GAAK0D,YAC7B6N,EAAa/P,SAAS2G,EAAYlI,IAElCoc,EAAQzd,SAASqB,GACnBwP,GAAgBzP,EAAKC,EAAKsR,EAAa,EAAG,GA5JT+I,IAAsB,MA0K3D7G,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,OAjR7E,8CAsRb,WAAiC0a,EAAQC,EAAQC,GAAjD,SAAAC,EAAA,sEACQvX,GAAW,SAAAhD,GACfrC,QAAQC,IAAI,aAAc0c,GAE1B,IAAIrU,EAAW,eAAOjG,EAAMoa,GAAQ5Y,YACpCyE,EAAYoU,GAAUC,EACtBta,EAAMoa,GAAQ5Y,WAAayE,KAN/B,OASEsL,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MACxF8a,KAXF,4CAtRa,+BAqSE7K,GArSF,mFAqSb,WAAmCpL,EAAOC,GAA1C,SAAA+V,EAAA,sEACQvX,GAAW,SAAAhD,GACD,YAAOA,EAAMuE,GAAO3C,KAAlC,IAGIqE,EAAW,eAAOjG,EAAMuE,GAAO/C,YAGnC,GAAIyE,EAAYzB,GAAS,EACvBxE,EAAMuE,GAAO/C,WAAWgD,GAASyB,EAAYzB,GAAS,MAGpD,CAEF,IAAIiW,EAAMza,EAAMuE,GAAO3C,IAAI8Y,QAAO,SAAUC,GAC1C,OAAOA,IAASnW,KAElBxE,EAAMuE,GAAO3C,IAAM6Y,SAGZza,EAAMuE,GAAO/C,WAAWgD,GAGjC,IAAIoW,EAAS,YAAO5a,EAAMuE,GAAO3C,KACjCjE,QAAQC,IAAI,mBAAoBgd,GAEhC,IAAIC,EAAc,eAAO7a,EAAMuE,GAAO/C,YACtC7D,QAAQC,IAAI,kBAAmBid,GAE/Bld,QAAQC,IAAI,sBA7BhB,OA+BE2T,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MAExF8a,KAlCF,4CArSa,+BA2UEjN,GA3UF,uFA2Ub,WAA+BzP,EAAKC,EAAKC,EAAQ8c,GAAjD,SAAAP,EAAA,sEACQvX,GAAW,SAAAhD,GACf,IAAIiG,EAAW,eAAOjG,EAAMlC,GAAK0D,YAKjC,GAJAyE,EAAYlI,GAAOC,EACnBgC,EAAMlC,GAAK0D,WAAayE,EACxBtI,QAAQC,IAAI,UAAWqI,GAEX,GAAR6U,EAAU,CACZnd,QAAQC,IAAI,gBACZ,IAAIuc,EAAO,YAAOna,EAAMlC,GAAK8D,KAC7BuY,EAAQtZ,KAAK9C,GACbiC,EAAMlC,GAAK8D,IAAMuY,MAXvB,OAeExC,EAAQ,IACRC,EAAQ,IACRrG,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MAExF8a,KApBF,4CA3Ua,sBAqWb,IAAMO,GAAiB,uCAAG,WAAOle,EAAUL,GAAjB,SAAA+d,EAAA,sDACxBvX,GAAW,SAAAhD,GACTA,EAAMxD,GAAIK,SAAWA,KAEvB0U,IAAS,GACTiJ,KALwB,2CAAH,wDArWV,8CA6Wb,WAA6B/N,GAA7B,SAAA8N,EAAA,sEACQvX,GAAW,SAAAhD,GACfA,EAAMyM,EAAUjQ,IAAMiQ,KAF1B,OAIE8E,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MACxF8a,KANF,4CA7Wa,oEAuXb,WAA+BQ,GAA/B,SAAAT,EAAA,sEACQvX,GAAW,SAAAhD,GACfA,EAAMgb,EAAUxe,IAAMwe,KAF1B,OAIEzJ,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MACxF8a,KANF,4CAvXa,oEAiYb,WAA8BtM,GAA9B,SAAAqM,EAAA,sEACQvX,GAAW,SAAAhD,GACfA,EAAMkO,EAAS1R,IAAM0R,KAFzB,OAIEqD,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MACxF8a,KANF,4CAjYa,oEA2Yb,sBAAAD,EAAA,sDACEX,KADF,4CA3Ya,oEA+Yb,WAA8Bpd,EAAIJ,EAAOoD,GAAzC,SAAA+a,EAAA,sEAEQvX,GAAW,SAAAhD,GACfA,EAAMxD,GAAIkP,eAAiBlM,EAC3BQ,EAAMxD,GAAIgD,OAASA,EACnBQ,EAAMxD,GAAIJ,MAAQA,KALtB,OAOEmV,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MACxF8a,KATF,4CA/Ya,oEA4Zb,WAAmChe,EAAGsF,GAAtC,SAAAyY,EAAA,sEAEQvX,GAAW,SAAAhD,GACfA,EAAMxD,GAAIsF,UAAYA,KAH1B,OAKEyP,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MACxF8a,KAPF,4CA5Za,oEA0ab,WAAgCxQ,GAAhC,SAAAuQ,EAAA,6DACE5c,QAAQC,IAAI,mBAAoBoM,GADlC,SAEQhH,GAAW,SAAAhD,GAEf,IAAK,IAAIM,KAAKN,EAAO,CAEnB,IAAIO,EAASP,EAAMM,GACnB,IAAKC,EAAOE,UAAYF,EAAOqB,IAAK,CAElC,IAAI6Y,EAAMla,EAAOqB,IAAI8Y,QAAO,SAAUC,GACpC,OAAOA,IAAS3Q,KAElBhK,EAAMM,GAAGsB,IAAM6Y,UAIZza,EAAMgK,MAhBjB,OAoBEuH,IAAS,GACTnQ,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MACxF8a,KAtBF,4CA1aa,oEAscb,sBAAAD,EAAA,sDAEEvX,GAAW,SAAAhD,GACT,IAAK,IAAIM,KAAKN,SACLA,EAAMM,MAGjBiR,IAAS,GACT5T,QAAQC,IAAI,cAAe8B,GAC3B0B,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MACxF8a,KAVF,4CAtca,sBAufb,IAOMS,GAAc,WAClB,GAAW,GAAR3e,EAAU,CACX,IAAI4e,EAAc7Y,KAAKG,MAAMpB,OAAOC,aAAaoB,QAAQ,oBAEzD,IAAK,IAAInC,KAAK4a,EAAa,CACzB,IAAI3a,EAAS2a,EAAY5a,GACpBC,EAAOE,UAAaF,EAAOG,iBACrBwa,EAAY3a,EAAO/D,IAAImE,kBACvBua,EAAY3a,EAAO/D,IAAIgE,aAGpCY,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAU4Y,IAE9DlY,GAAW,SAAAhD,GAAK,OAAYqC,KAAKG,MAAMpB,OAAOC,aAAaoB,QAAQ,uBACnEoV,EAAQ,GACRsB,IAAa,GACbE,IAAY,GACZ,IAAI8B,EAAc/Z,OAAOC,aAAaoB,QAAQ,mBAE9CrB,OAAOC,aAAa+Z,QACpBha,OAAOC,aAAaC,QAAQ,kBAAmB6Z,KAlhBtC,GAshByBpS,mBAAS,IAthBlC,qBAshBNsS,GAthBM,MAshBOC,GAthBP,MAuhBP1b,GAAqB,uCAAG,WAAOxD,GAAP,SAAAme,EAAA,sEACtBe,GAAelf,GADO,OAE5Boc,IAAuB,GACnBA,IACFW,IAAa,GAJa,2CAAH,sDAyBrBoC,GAAa,uCAAG,sBAAAhB,EAAA,sDACR,GAARje,IAEFqB,QAAQC,IAAI,gBAEZwD,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,OALtE,2CAAH,qDAUb8b,GAAS,uCAAG,sBAAAjB,EAAA,yDACJ,GAARje,IAEFqB,QAAQC,IAAI,WACZD,QAAQC,IAAI,YAActB,GAC1B8E,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAUD,KAAKG,MAAMH,KAAKC,UAAU5C,MACxF0B,OAAOC,aAAaC,QAAQ,iBAAkB,KAC9C3D,QAAQC,IAAI,gCAAiCwD,OAAOC,aAAaoB,QAAQ,qBAEtE2W,GATW,uBAUdzb,QAAQC,IAAI,YAActB,GAVZ,SAWR0G,GAAW,SAAAtD,GAAO,OAAID,GAAKC,EAASpD,EAAMqD,GAAUC,GAAuBC,OAXnE,OAYsC,KAAjDuB,OAAOC,aAAaoB,QAAQ,mBAC7BoV,GAAQ,SAAAvb,GAAI,OAAIA,EAAO,KAEzBqB,QAAQC,IAAR,oCAA+E,EAAtCyE,KAAKC,UAAUjB,cAAc3C,SAfxD,uBAiBdsb,MAAM,yBAjBQ,4CAAH,qDAsBTyB,GAAU,uCAAG,4BAAAlB,EAAA,2DACbje,EAAO,GADM,uBAEXof,EAAWpf,EAAKoF,UACpB2X,IAAY,GAHG,SAITrW,GAAW,SAAAtD,GAAO,OAAI6C,GAASmZ,EAAW,MAJjC,uBAKT7D,GAAQ,SAAAvb,GAAI,OAAIA,EAAO,KALd,8BAQA,GAARA,GACP2e,KATe,4CAAH,qDAaG5f,iBAAOqE,GACfjE,QAAUiE,EACrB,IAAMic,GAAoBtgB,iBAAOmgB,IAyCjC,SAASI,KACHxY,GACFuM,GAAoBoG,GAAQC,IAI5BrY,QAAQC,IAAI,oBAEdD,QAAQC,IAAI,yBA8Cd,SAAS4c,KACLrV,SAAS0W,eAAe,cAAcC,QACtC3W,SAAS0W,eAAe,cAAcC,QAG1C,OAnGAH,GAAkBlgB,QAAU,WAC1B+f,KACA/B,IAAQ,SAAAsC,GAAC,OAAIA,EAAI,MAEnBzgB,qBAAU,WACR,IAAI0gB,EAAa,IAAKtC,GAGtB,GAFA7D,GAAcmG,EAAW,IACzBre,QAAQC,IAAI,aAAcoe,GACtB3E,GACF,IAAI4E,EAAWC,aAAY,WACzBP,GAAkBlgB,YACjBugB,GAEL,OAAO,kBAAMG,cAAcF,MAC1B,CAAC5E,GAAWsE,KAEfrgB,qBAAU,WACJmO,IACF9L,QAAQC,IAAI,iCAEb,IA+BHqY,GAAO,SA5BP,WACEtY,QAAQC,IAAI,iBACZub,IAAa,SAAA4C,GAAC,OAAKA,QA2BrB9F,GAAO,aAjBP,WACEtY,QAAQC,IAAI,oBACZ6d,QAgBFxF,GAAO,cAzBP,WACEtY,QAAQC,IAAI,qBACPwb,IACHuC,GAAkBlgB,aAuBtBwa,GAAO,SAAU2F,IACjB3F,GAAO,YAAa2F,IA6ClB,gBAAC,KAAD,WACE,eAAC,GAAD,CAAM9H,wBArkBsB,kBAAMkF,IAAqB,IAqkBCjF,yBApkB3B,kBAAMiF,IAAqB,IAokBoDhF,sBAlkBlF,kBAAMkF,IAAmB,IAkkBuGjF,uBAjkB/H,kBAAMiF,IAAmB,IAikBsJhF,gBAAiBA,GAAiBC,2BA5jB7M,kBAAM4F,IAAmB,MA6jBxD,eAAC,KAAD,UACE,eAAC,KAAD,CAAOqC,KAAK,IAAZ,SACE,gBAACC,EAAA,EAAD,WACG/C,IAAS,eAACgD,EAAA,EAAD,CAAOhV,QAAQ,SAAf,SACPgS,KAEH,gBAAC,QAAD,CAAM9c,GAAG,gBAAgB+f,OAAQtD,GAAiB1R,QAvkBlC,WAAO2R,IAAmBD,KAukBoCuD,mBAAiB,EAACC,qBAAmB,EAACC,WAAS,EAA7H,UAEE,eAACnS,EAAA,EAAD,UACE,eAACA,EAAA,EAAKoS,KAAN,CACEngB,GAAG,cACHC,MAAOsb,IAAsB,eAC7B6E,QAAM,EACNhS,SAAU,SAACM,IA9iBR,SAAC5N,GAClB,IAAIuf,EAAOvf,EAAMwf,MAAM,GAGvB,GAFAzD,IAAY,GAERwD,EAAKzR,OAA2C,IAAnCyR,EAAKzR,KAAKxO,QAAQ,YAEjCqd,GAAU,8BAFZ,CAKA,IAAM8C,EAAS,IAAIC,WAcfC,EAAuB,uCAAG,WAAgB/S,EAAOgT,GAAvB,yBAAA3C,EAAA,sDAC5B,IACQ4C,EAAUjc,OAAOC,KAAK+b,EAAcE,SACpCC,EAAQF,EAAQze,OAChB4e,EAAUH,EAAQE,EAAQ,IAC1BE,EAAWL,EAAcE,QAAQE,IACV5e,OAEX,GACV+b,EAAM8C,EACNC,EAAWD,EAAS7e,OAAS,EACnC+b,EAAI+C,GAAYtT,GAEhBgT,EAAcE,QAAQE,GADF,OAAXA,EACwB,CAACpT,GAEhB,aAAXoT,EAC0BpT,EAGAuT,EAAWvT,GAG9C,MAAOgB,IAtBmB,2CAAH,wDAwB3B6R,EAAOxG,iBAAiB,OAAxB,uCAAgC,WAAOlS,GAAP,iBAAAkW,EAAA,6DAC1BnQ,EAAU,CACZqL,SAAS,EACTiI,MAAM,EACNC,mBAAmB,EACnBC,mBAAmB,EACnBC,kBAAkB,EAClBnI,eAAe,EACfoI,aAAa,EACbC,eAAe,EACfC,OAAQf,GAVoB,SAYXgB,KAAQC,OAAO7Z,EAAMlG,OAAOV,OAAQ2M,GAZzB,cAY1B3M,EAZ0B,gBAaxBuF,GAAW,SAAAhD,GAAK,OAAYvC,EAAO5C,WAbX,uBAcxBmI,GAAW,SAAAhD,GACf,IAAK,IAAIM,KAAKN,EACRA,EAAMM,GAAGwB,UAIT9B,EAAMM,GAAGG,UAAaT,EAAMM,GAAGsB,MACjC5B,EAAMM,GAAGsB,IAAM,OArBS,OA0B9BR,OAAOC,aAAaC,QAAQ,kBAAmBe,KAAKC,UAAU7E,EAAO5C,UACrEmd,GAAY6E,EAAKlR,MA3Ba,4CAAhC,uDA6BAoR,EAAOoB,WAAWtB,GAClBhF,EAAQ,GAnER,SAAS4F,EAAWvT,GAClB,IAAIkU,EAASC,OAAOnU,GACpB,IAAKoU,MAAMF,GACT,OAAOA,EAET,IAAIG,EAASrU,EAAMsU,cACnB,MAAe,SAAXD,GAEkB,UAAXA,GAGJrU,GAyhBwBuU,CAAWvT,EAAE/M,aAGpC,+BACE,gBAACiJ,EAAA,EAAD,CAAQ5K,GAAG,WAAW8K,QAAQ,UAAUS,SAAUzL,EAAO,EAAkBiL,QA5jBtE,WAEjB,IAAImX,EAAU,CAAE7jB,QAAS6E,GAErBjC,EAASwgB,KAAQU,SAASD,EAAStU,IAEnCwU,EAAO,IAAIC,KAAK,CAACphB,GAAS,CAAE2N,KAAM,2BACtC0T,kBAAOF,EAAMzM,OAAO4M,WAAa,gBACjC7G,MAojBY,UAAgG,eAAC,IAAD,IAAU,IAA1G,YAEF,+BACE,gBAAC9Q,EAAA,EAAD,CAAQ5K,GAAG,qBAAqB8K,QAAQ,UAAUC,QA/kB3B,WAAOqR,IAA0B,GAAOM,IAAmB,IA+kBlF,UAAyF,eAAC,IAAD,IAAiB,IAA1G,sBAEF,+BACE,gBAAC8F,EAAA,EAAD,CAAgBxiB,GAAG,gBAAgB4B,MAAM,mBAAzC,UACE,eAAC6gB,EAAA,EAASC,KAAV,CAAeC,KAAK,kCAAkCC,UAAQ,EAA9D,+BACA,eAACH,EAAA,EAASC,KAAV,CAAeC,KAAK,+BAA+BC,UAAQ,EAA3D,4BACA,eAACH,EAAA,EAASC,KAAV,CAAeC,KAAK,4CAA4CC,UAAQ,EAAxE,yCACA,eAACH,EAAA,EAASC,KAAV,CAAeC,KAAK,qCAAqCC,UAAQ,EAAjE,kCACA,eAACH,EAAA,EAASC,KAAV,CAAeC,KAAK,4CAA4CC,UAAQ,EAAxE,mDAGJ,+BACE,eAAChY,EAAA,EAAD,CAAQ5K,GAAG,eAAe8K,QAAQ,UAAUC,QA9lBxB,kBAAMwS,IAAmB,IA8lB7C,gCAEF,+BACE,eAACxP,EAAA,EAAD,UACE,eAACA,EAAA,EAAK8U,MAAN,CAAYjU,KAAK,WACb3O,MAAM,gCACN6iB,eAAgBxJ,GAChBlL,SAAU,WACRkL,IAAWA,aAKvB,iCACE,sBAAKnb,MAAO,CAAEkN,UAAW,UAAzB,SACE,qBAAIlN,MAAO,CAAE4kB,WAAY,OAASlY,UAAU,kBAA5C,yBAEF,gBAACmY,EAAA,EAAD,WACE,eAACC,EAAA,EAAD,UACE,iCAEE,eAAClV,EAAA,EAAD,UACE,eAACA,EAAA,EAAKC,MAAN,CAAYhO,GAAG,mBAAf,SACE,gBAACgjB,EAAA,EAAD,WACE,eAACC,EAAA,EAAD,CAAKC,GAAI,EAAT,SACA,+BACE,gBAACV,EAAA,EAAD,CAAgBxiB,GAAG,YAAY4B,MAAO,oBAAsByb,GAAM8F,SAroBzE,SAACzU,GAClBvN,QAAQC,IAAIsN,GACZ4O,GAAQ5O,IAmoBgB,UACE,eAAC+T,EAAA,EAASC,KAAV,CAAeU,SAAS,SAASrY,QAAS,kBAAMuQ,IAAY,IAA5D,oBACA,eAACmH,EAAA,EAASC,KAAV,CAAeU,SAAS,eAAerY,QAAS,kBAAMuQ,IAAY,IAAlE,iCAcJ,eAAC2H,EAAA,EAAD,CAAKC,GAAI,EAAG/kB,MAAO,CAAEkN,UAAW,QAAhC,SACE,eAACiF,EAAA,EAAD,CACEC,UAAU,QACV1N,MAAO,CAAE6J,KAAM,IAAK8D,KAAM,KAC1BC,QA7RN,SAAC3B,GAAD,OACpB,eAACC,EAAA,EAAD,yBAAS/O,GAAG,kBAAqB8O,GAAjC,iJAyRwB,SAKE,eAAC,IAAD,eAMD,GAARhP,EAAY,yBACX,uBAAK3B,MAAO,CAAEkY,gBAAiB,UAAWjY,MAAO,QAASilB,aAAc,OAAQC,QAAS,SAAzF,UACE,eAAC,IAAD,CAAWllB,MAAM,QAAQgN,KAAM,KADjC,IACwC,4CADxC,IACwE,GAARtL,EAAY,iBAAmBA,UAMrG,eAACmjB,EAAA,EAAD,UACE,uBAAKpY,UAAU,kBAAkB1M,MAAO,CAAEkN,UAAW,SAAUkY,aAAc,SAA7E,UACE,eAAC3Y,EAAA,EAAD,CAAQE,QAAQ,OAAOC,QAAS,kBAAMkU,MAAtC,SAAoD,eAAC,IAAD,MAA8B,IAClF,uBAAK9gB,MAAO,CAAEqlB,QAAS,gBAAvB,UACE,eAAC9I,GAAD,CAAwBG,UAAWA,IAAjBmC,IAClB,eAACpS,EAAA,EAAD,CAAQQ,KAAK,KAAKP,UAAU,uBAAuBE,QA3TvE,WACO6R,GAKHY,MAAM,0BAJNrc,QAAQC,IAAR,2BAAgCyZ,KAChC8B,IAAa,SAAA4C,GAAC,OAAKA,KACnBpe,QAAQC,IAAR,0BAA+ByZ,OAuTf,SAAyEA,GAAY,eAAC,IAAD,IAAgB,eAAC,IAAD,SAJzG,IAKU,IAER,eAACjQ,EAAA,EAAD,CAAQE,QAAQ,OAAQC,QAAS,kBAAMiU,MAAvC,SAAoD,eAAC,IAAD,MAA6B,IACjF,eAACpU,EAAA,EAAD,CAAQ6Y,QAAQ,EAAMzjB,GAAG,aAAa8K,QAAQ,OAAQC,QAAS,kBAAMgU,MAArE,SAAsF,eAAC,IAAD,MAA6B,SAqBvH,eAACkE,EAAA,EAAD,CAAK9kB,MAAO,CAAEkN,UAAW,SAAzB,SAEE,uBAAKrL,GAAG,eAAe7B,MAAO,CAACkY,gBAAiB,UAAWgN,aAAc,OAAQC,QAAS,SAA1F,UACI,sBAAIzY,UAAU,eAAe1M,MAAO,CAACkN,UAAW,UAAhD,UAA4D,eAAC,IAAD,IAAY,IAAxE,mBACE,eAACT,EAAA,EAAD,CAAQQ,KAAK,KAAKN,QAAQ,QAAQ3M,MAAO,CAACqN,MAAO,SAAUT,QAhWjF,WACM8P,IACF8B,IAAa,GAEfQ,GAAY,IA4VQ,yBAAsG,OAGxG,eAACuG,EAAA,EAAD,CACEC,aAAW,YACXvlB,MAAM,YACNuS,IAAK,GACLiT,IAAK,EACL3gB,KAAM,GACNoP,aAAc,EACd3E,MAAOwP,GACP9O,SAzvBE,SAACvG,EAAOgc,GAC1BhJ,IACF8B,IAAa,GAEfQ,GAAY0G,GAEZxK,GADc,IAAKwK,EACG,KAovBFC,kBAAkB,OAClBC,iBAzJtB,SAAgCrW,GAC5B,MAAM,GAAN,OAAUA,EAAV,gBA8JQ,gBAACsV,EAAA,EAAD,WACE,gBAACC,EAAA,EAAD,CAAKC,GAAI,EAAT,UACI,gBAACtY,EAAA,EAAD,CAAQE,QAAQ,eAAeM,KAAK,KAAKpL,GAAG,eAAe6K,UAAU,4BAA4BE,QAzvBhG,kBAAM8Q,IAAoB,IAyvB2F1d,MAAO,CAAEkN,UAAW,SAAUC,YAAa,SAAWC,SAAUzL,EAAO,EAA7L,UAA+M,eAAC,IAAD,IAAe,IAA9N,cACA,gBAAC8K,EAAA,EAAD,CAAQE,QAAQ,eAAeM,KAAK,KAAKpL,GAAG,gBAAgB6K,UAAU,4BAA4BE,QAlvBpF,kBAAMgR,IAAqB,IAkvB2F5d,MAAO,CAAEkN,UAAW,SAAUC,YAAa,SAAWC,SAAUzL,EAAO,EAA3M,UAA6N,eAAC,IAAD,IAAoB,IAAjP,oBACA,gBAAC8K,EAAA,EAAD,CAAQE,QAAQ,eAAeM,KAAK,KAAKpL,GAAG,iBAAiB6K,UAAU,4BAA4BE,QArvBpF,kBAAM+Q,IAAsB,IAqvB2F3d,MAAO,CAAEkN,UAAW,SAAUC,YAAa,SAAWC,SAAUzL,EAAO,EAA7M,UAA+N,eAAC,IAAD,IAAkB,IAAjP,qBACA,gBAAC8K,EAAA,EAAD,CAAQE,QAAQ,kBAAkBM,KAAK,KAAKpL,GAAG,eAAe6K,UAAU,2BAA2BE,QA1uBvF,kBAAMuR,IAAmB,IA0uB8Fne,MAAO,CAAEkN,UAAW,SAAUC,YAAa,SAAWC,SAAUzL,EAAO,EAA1M,UAA4N,eAAC,IAAD,IAAY,IAAxO,iBACA,gBAAC8K,EAAA,EAAD,CAAQE,QAAQ,kBAAkBM,KAAK,KAAKpL,GAAG,gBAAgB6K,UAAU,4BAA4BE,QA/uB3F,kBAAMkR,IAAiB,IA+uBkG9d,MAAO,CAAEkN,UAAW,SAAUC,YAAa,SAAWC,SAAUzL,EAAO,EAA1M,UAA4N,eAAC,IAAD,IAAiB,IAA7O,uBACA,gBAAC8K,EAAA,EAAD,CAAQE,QAAQ,kBAAkBM,KAAK,KAAKpL,GAAG,oBAAoB6K,UAAU,4BAA4BE,QApvB1F,kBAAMmR,IAAsB,IAovBiG/d,MAAO,CAAEkN,UAAW,SAAUC,YAAa,SAAWC,SAAUzL,EAAO,EAAnN,UAAqO,eAAC,IAAD,IAAiB,IAAtP,wBAIJ,gBAACmjB,EAAA,EAAD,CAAKC,GAAI,EAAG/kB,MAAO,CAAEkN,UAAW,SAAhC,UACI,gBAACT,EAAA,EAAD,CAAQ5K,GAAG,UAAU8K,QAAQ,SAASC,QAAS0T,GAAatgB,MAAO,CAAEkN,UAAW,SAAU2Y,UAAW,SAArG,UAAgH,eAAC,IAAD,IAA0B,IAA1I,wBAA0K,aAIlL,wBACA,eAAC,GAAD,CACE9gB,QAASA,EACTiD,aAAc,SAAC7E,EAAKC,EAAK0iB,GACvB9d,GAAa7E,EAAItB,KAAMuB,EAAIvB,MAC3BikB,EAAUra,UAEZvD,qBAAsBkY,GACtBpL,oBAAqBA,GACrB7M,oBA9ZZ,SAA6B4d,EAAYnc,EAAOC,GAI9C,IAAImc,EAFJ5K,GAASxR,EACTyR,GAASxR,GAFTpB,GAAmBsd,KAMjB1d,GAAW,SAAAhD,GACT,IAAIiG,EAAW,eAAOjG,EAAMuE,GAAO/C,YACnCmf,EAAcrhB,SAAS2G,EAAYzB,OAGrCiL,GAAUkR,KAmZF/d,oBAn3BC,4CAo3BDG,UA9xBK6d,EA+xBL5d,WAAYA,EACZ1E,WA5NZ,SAAoBlC,GAQlB,IAPA,IAAMykB,EAAS,sEACTC,EAAW,2DAEbC,EAAa,GACbC,EAAY,GAEZ1iB,EAAalC,EAAMmC,MAAM,KACpBE,EAAE,EAAEA,EAAEH,EAAWI,OAAOD,IAAI,CACjC,IAAIG,EAAUiiB,EAAOnjB,KAAKY,EAAWG,IACjCI,EAAYiiB,EAASpjB,KAAKY,EAAWG,IAErCG,EACAmiB,EAAWlgB,KAAKvC,EAAWG,IAGtBI,GACLmiB,EAAUngB,KAAKvC,EAAWG,IAKlC,MAAO,CAACsiB,EAAYC,IAuMV/d,aAnMZ,WAGE,OADAtF,QAAQC,IAAI,aAAckY,IACnBA,IAiMG5S,2BAzwBuB,kBAAMyV,IAAwB,IA0wBrDxV,6BAnwByB,WAAOxF,QAAQC,IAAI,eAC1Cmb,IAA0B,IAmwB5Bzc,KAAMA,IACR,eAAC,GAAD,CAAeA,KAAMA,EACnBqU,uBAAwBA,GACxBC,6BAjvByB,kBAAMgI,IAA0B,MAkvB3D,eAAC,GAAD,CAActQ,iBAAkBA,GAC9BC,wBA5xBoB,kBAAM4P,IAAoB,IA6xB9C1P,YAAawR,GACbzR,OAAUA,EACVE,SAAYA,GACZC,WAAYA,GACZC,WAAYA,GACZC,WAAYA,GACZC,cAAeA,KACjB,eAAC,GAAD,CAAsBuE,mBAAoBA,GACxCC,0BAnyBsB,kBAAM8K,IAAsB,IAoyBlD7K,gBAAiBA,GACjB9E,YAAawR,GACbzM,KAAQA,EACRC,KAAQA,IACV,eAAC,GAAD,CAAa3B,iBAAkBA,GAC7BC,iBA7yBQ,kBAAMsM,IAAoB,IA8yBlCrM,cA/4BC,6CAg5BDvD,YAAawR,KACf,eAAC,GAAD,CAAmBtM,mBAAoBA,GACrCC,0BA3yBsB,kBAAM0K,IAAsB,IA4yBlDzK,gBAn5BC,6CAo5BDpF,YAAawR,KACf,eAAC,GAAD,CAAkBlM,kBAAmBA,GACnCC,yBA7yBqB,kBAAMuK,IAAqB,IA8yBhDtK,eAv5BC,6CAw5BDxF,YAAawR,KACf,eAAC,GAAD,CAAc7L,cAAeA,GAC3BC,qBA/yBiB,kBAAMoK,IAAiB,IAgzBxCnK,eA35BC,iDA45BD7F,YAAawR,GACbva,QAASA,IACX,eAAC,GAAD,CAAmBqP,mBAAoBA,GACrCC,0BAlzBsB,kBAAM0J,IAAsB,IAmzBlDzJ,oBAh6BC,+CAi6BDxG,YAAawR,GACbva,QAASA,IACV,eAAC,GAAD,CAAiB4P,qBAAsBA,GACtCC,4BAtzBwB,kBAAMoJ,IAAwB,IAuzBtDnJ,kBAr6BC,iDAs6BD/G,YAAawR,GACbva,QAASA,EACT0D,iBAAkBA,GAClBmB,MAAOwR,GACPvR,MAAOwR,GACPvG,UAAWA,GACXC,YAAaA,GACb1M,WAAYA,EACZ2M,oBAAqBA,KACvB,eAACsR,GAAD,CAAe/Q,mBAAoBA,GACjCC,0BA/zBsB,kBAAM0I,IAAsB,IAg0BlDzI,gBAj7BC,4CAk7BD3H,YAAawR,KAEf,eAAC,GAAD,CAAgBnK,gBAAiBA,GAC/BC,uBAl0BmB,kBAAM+I,IAAmB,IAm0B5C9I,iBAt7BC,6CAu7BDvH,YAAawR,GACbva,QAASA,IAEX,eAAC,GAAD,CAAmB4Q,uBAAwBA,GACzCC,8BAt0B0B,kBAAMwI,IAA0B,IAu0B1DpJ,oBAAqBA,GACrBlH,YAAawR,GACbjX,WAAYA,EACZI,iBAAkBA,GAClBmB,MAAOwR,GACPvR,MAAOwR,KAET,eAAC,GAAD,CAAgBvM,oBAAqBA,GACnCC,2BAA4BA,GAC5BtN,MAAOif,GACP1R,kBAxac,SAACpN,GACzBmN,KACA1G,GAAW,SAAChD,GACV,IAAK,IAAIkhB,KAAKlhB,EACZ,IAAK,IAAIM,KAAK/D,EACZ,GAAI2kB,GAAK5gB,EAAG,CAAC,IAAD,EACmD3B,GAAUpC,EAAK+D,IADlE,mBAC0CjB,GAD1C,+BAEVW,EAAMkhB,GAAG7hB,MAAQA,EAEjBW,EAAMkhB,GAAG1gB,YAAcjE,EAAK+D,GAC5BN,EAAMkhB,GAAGvgB,WAAapE,EAAK+D,UAga1B2X,cCthCEkJ,GAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,O,+DCGdQ,IAAUC,IAAIjb,MACdgb,IAAUC,IAAIvb,MACdsb,IAAUC,IAAI3c,MACd4c,IAASC,OACP,eAAC,IAAMC,WAAP,UACE,eAAC,GAAD,MAEF7c,SAAS0W,eAAe,SAM1BsF,O","file":"static/js/main.50aa5c07.chunk.js","sourcesContent":["const styles = [\r\n    {\r\n        selector: '.snapse-node, .snapse-output, .snapse-input',\r\n        style: {\r\n            'font-family': 'Computer Modern',\r\n            'background-opacity': '0',\r\n            'padding-top': '0',\r\n            'border-width': 0,\r\n            'text-halign': 'left',\r\n            'text-valign': 'top',\r\n            color: 'black',\r\n            content: 'data(label)'\r\n        }\r\n    },\r\n    {\r\n        selector: '.snapse-node__closed',\r\n        style: {\r\n            'font-family': 'Computer Modern',\r\n            'background-opacity': '0',\r\n            'padding-top': '0',\r\n            'border-width': 0,\r\n            'text-halign': 'left',\r\n            'text-valign': 'top',\r\n            'background-color':'gray',\r\n            color: 'black',\r\n            content: 'data(label)'\r\n        }\r\n    },\r\n    {\r\n        selector: '.snapse-node__rules, .snapse-node__output, .snapse-node__input',\r\n        style: {\r\n            'font-family': 'Computer Modern',\r\n            'font-style':'italic',\r\n            'background-color': 'white',\r\n            'border-width': 1,\r\n            events: 'no',\r\n            'text-wrap': 'wrap',\r\n            'text-max-width': '100px',\r\n            'text-halign': 'center',\r\n            'text-valign': 'center',\r\n            content: 'data(label)',\r\n            'height': 150,\r\n            shape: 'roundrectangle',\r\n            width: 100\r\n        }\r\n    },\r\n    {\r\n        selector: '.snapse-node__rules__closed',\r\n        style: {\r\n            'font-family': 'Computer Modern',\r\n            'font-style':'italic',\r\n            'background-color': 'gray',\r\n            'border-width': 3,\r\n            events: 'no',\r\n            'text-halign': 'center',\r\n            'text-valign': 'center',\r\n            'text-wrap':'wrap',\r\n            'text-max-width': '100px',\r\n            content: 'data(label)',\r\n            height: 150,\r\n            shape: 'roundrectangle',\r\n            width: 100\r\n        }\r\n    },\r\n    {\r\n        selector: '.snapse-node__time, .snapse-node__spike',\r\n        style: {\r\n            'font-family': 'Computer Modern',\r\n            'background-opacity': '0',\r\n            'text-halign': 'center',\r\n            'text-valign': 'center',\r\n            content: 'data(label)',\r\n            events: 'no',\r\n            height: 15,\r\n            shape: 'roundrectangle',\r\n            width: 50\r\n        }\r\n    },\r\n    {\r\n        selector: '.snapse-node__time__closed, .snapse-node__spike__closed',\r\n        style: {\r\n            'font-family': 'Computer Modern',\r\n            'background-opacity': '0',\r\n            'text-halign': 'center',\r\n            'text-valign': 'center',\r\n            content: 'data(label)',\r\n            events: 'no',\r\n            height: 15,\r\n            shape: 'roundrectangle',\r\n            width: 50\r\n        }\r\n    },\r\n    /*     {\r\n            selector: 'node',\r\n            style: {\r\n                'background-opacity': '0',\r\n                'padding-top': '0',\r\n                'text-halign': 'left',\r\n                'text-valign': 'top',\r\n                color: 'black',\r\n                content: 'data(label)',\r\n                'border-width': 1,\r\n                events: 'no',\r\n                'text-wrap': 'wrap',\r\n                shape: 'roundrectangle'\r\n            }\r\n        }, */\r\n    {\r\n        selector: 'edge',\r\n        style: {\r\n            'font-family': 'Computer Modern',\r\n            'curve-style': 'bezier',\r\n            'target-arrow-shape': 'triangle',\r\n            'text-background-color': 'white',\r\n            'text-background-shape': 'rectangle',\r\n            width: 1,\r\n            // content: 'data(label)',\r\n            // 'text-halign': 'center',\r\n            // 'text-valign': 'top',\r\n        },\r\n    },\r\n    {\r\n        selector: '.edge--triggering',\r\n        style: {\r\n            'line-color': 'magenta',\r\n            'line-style': 'dashed',\r\n            'target-arrow-color': 'magenta',\r\n            'line-color': 'magenta',\r\n            'line-style': 'dashed',\r\n            'target-arrow-color': 'magenta',\r\n            'width': 4,\r\n            'line-dash-offset': 3,\r\n            'line-dash-pattern': [15,3],\r\n            'arrow-scale': 1.5\r\n        },\r\n        // content: 'data(label)',\r\n        // 'text-halign': 'center',\r\n        // 'text-valign': 'top',\r\n    },\r\n    {\r\n        selector: \"edge[label]\",\r\n        css: {\r\n            \"label\": \"data(label)\",\r\n            \"text-rotation\": \"autorotate\",\r\n            \"text-margin-x\": \"0px\",\r\n            \"text-margin-y\": \"0px\",\r\n            \"text-background-opacity\": 1,\r\n            'font-weight': 'bold',\r\n            'font-size': 18\r\n\r\n        }\r\n      },\r\n\r\n]\r\nexport default styles;\r\n","import { useEffect, useRef } from 'react'\r\nimport cytoscapejs from 'cytoscape'\r\n\r\nfunction useAnimateEdges() {\r\n  const cyRef = useRef(null)\r\n  const setCy = (internal) => {\r\n    cyRef.current = internal\r\n  }\r\n\r\n  useEffect(() => {\r\n    const cy = cyRef.current\r\n    let raf\r\n    let animOffset = 0\r\n\r\n    function animate() {\r\n      animOffset++\r\n      if (cy) {\r\n        cy.edges().animate({\r\n          style: { 'line-dash-offset': -animOffset }\r\n        })\r\n      }\r\n      raf = requestAnimationFrame(animate)\r\n    }\r\n\r\n    animate()\r\n\r\n    return () => {\r\n      if (raf) {\r\n        cancelAnimationFrame(raf)\r\n      }\r\n    }\r\n  }, [])\r\n\r\n  return [cyRef, setCy]\r\n}\r\n\r\nexport default useAnimateEdges\r\n","export const createNeuron = (newId, x, y, rules, spike, time) => [{\r\n        data: {\r\n            id: newId,\r\n            label: `${(newId.includes('-'))? newId.substr(0, newId.indexOf('-')) : newId}`\r\n        },\r\n        position: { x: x, y: y },\r\n        classes: 'snapse-node'\r\n    },\r\n    {\r\n        data: {\r\n            id: newId + '-rules',\r\n            parent:newId,\r\n            label: rules.replace(/ /g, \"\\n\").replace(/->/g, \"\")\r\n        },\r\n        position: { x: x, y: y },\r\n        classes: 'snapse-node__rules'\r\n    },\r\n    {\r\n        data: {\r\n            id: newId + '-spike',\r\n            parent: newId,\r\n            label: spike\r\n        },\r\n        position: { x: x, y: y - 60 },\r\n        classes: 'snapse-node__spike'\r\n    },\r\n    {\r\n        data: {\r\n            id: newId + '-time',\r\n            parent: newId,\r\n            label: `${(time < 0)? '!': time}`\r\n        },\r\n        position: { x: x, y: y + 90 },\r\n        classes: 'snapse-node__time'\r\n    }];\r\n\r\nexport const createClosedNeuron = (newId, x, y, rules, spike, time) => [{\r\n            data: {\r\n                id: newId,\r\n                label: `${(newId.includes('-'))? newId.substr(0, newId.indexOf('-')) : newId}`\r\n            },\r\n            position: { x: x, y: y },\r\n            classes: 'snapse-node__closed'\r\n        },\r\n        {\r\n            data: {\r\n                id: newId + '-rules',\r\n                parent:newId,\r\n                label: rules.replace(/ /g, \"\\n\").replace(/->/g, \"\")\r\n            },\r\n            position: { x: x, y: y },\r\n            classes: 'snapse-node__rules__closed'\r\n        },\r\n        {\r\n            data: {\r\n                id: newId + '-spike',\r\n                parent: newId,\r\n                label: spike\r\n            },\r\n            position: { x: x, y: y - 60 },\r\n            classes: 'snapse-node__spike__closed'\r\n        },\r\n        {\r\n            data: {\r\n                id: newId + '-time',\r\n                parent: newId,\r\n                label: time\r\n            },\r\n            position: { x: x, y: y + 90 },\r\n            classes: 'snapse-node__time__closed'\r\n        }];\r\nexport const createOutputNeuron = (id,x,y,output,spike) => [\r\n    {\r\n        data: { rootId: id, id: `${id}`, label: `${(id.includes('-'))? id.substr(0, id.indexOf('-')) : id}`},\r\n        classes: 'snapse-output',\r\n        position: { x: 0, y: 0 }\r\n      },\r\n      {\r\n        data: { rootId: id, id: `${id}-output`, parent: id, label: `${(typeof output === 'string') ? output.replace(/\\[object Object\\]/g,'').replaceAll(/(.{12})/g,'$&\\n') : ''}`},\r\n        classes: 'snapse-node__output',\r\n        position: { x, y: y }\r\n      },\r\n      {\r\n        data: { rootId: id, id: `${id}-spike`, parent: id, label: '' },\r\n        classes: 'snapse-node__spike',\r\n        position: { x, y: y + 40 }\r\n      }\r\n]\r\n\r\nexport const createInputNeuron = (id,x,y, input,spike) =>  [{\r\n    data: {\r\n        id: id,\r\n        label: `${(id.includes('-'))? id.substr(0, id.indexOf('-')) : id}`\r\n    },\r\n    position: { x: x, y: y },\r\n    classes: 'snapse-input'\r\n},\r\n{\r\n    data: { rootId: id, id: `${id}-input`, parent: id, label: `${(typeof input === 'string') ? input.replace(/\\[object Object\\]/g,'').replaceAll(/(.{12})/g,'$&\\n') : ''}`},\r\n    classes: 'snapse-node__input',\r\n    position: { x, y: y }\r\n}];\r\nexport const checkValidRule = (rule) =>{\r\n    const re = /(a+)(\\+*\\**)\\/(a+)->(a+);([0-9]+)/\r\n    const testRe = /([1-9]*)a\\(*([1-9]*)(a*)\\)*(\\+?|\\*?)\\/([1-9]*)a->([1-9]*)a;([0-9]+)/;\r\n    const forgetRe = /([1-9]*)a\\(*([1-9]*)(a*)\\)*(\\+?|\\*?)\\/([1-9]*)a->(0);(0)/\r\n    var result = testRe.exec(rule) || forgetRe.exec(rule);\r\n    console.log(\"RESSSS\", result);    \r\n    return result;\r\n}\r\n\r\nexport const createEdge = (src,dst, weight, c) =>{\r\n    return {\r\n        data: {\r\n          id: src + '->' + dst,\r\n          source: src,\r\n          target: dst,\r\n          label: weight,\r\n          title: \"synapse weight\"\r\n        },\r\n        classes: c\r\n      };\r\n}\r\n\r\nexport const allRulesValid = (rules) => {\r\n    var splitRules = rules.split(\" \");\r\n    var count = 0;\r\n    for (var i=0;i<splitRules.length;i++){\r\n        if(checkValidRule(splitRules[i])!=null){\r\n            count+=1;\r\n        }else{\r\n            console.log(\"invalidRule\", splitRules[i])\r\n        }\r\n    }\r\n    if(count == splitRules.length){\r\n        return 1;\r\n    }else{\r\n        return 0;\r\n    }\r\n}\r\n\r\nexport const splitRules = (rules) => {\r\n    const testRe = /([1-9]*)a\\(*([1-9]*)(a*)\\)*(\\+?|\\*?)\\/([1-9]*)a->([1-9]*)a;([0-9]+)/;\r\n    const forgetRe = /([1-9]*)a\\(*([1-9]*)(a*)\\)*(\\+?|\\*?)\\/([1-9]*)a->(0);(0)/;\r\n\r\n\r\n    var spikeRules = [];\r\n    var forgRules = [];\r\n\r\n    var splitRules = rules.split(\" \");\r\n    for (var i=0;i<splitRules.length;i++){\r\n        var testRes = testRe.exec(splitRules[i]);\r\n        var forgetRes = forgetRe.exec(splitRules[i]);\r\n\r\n        if (testRes){\r\n            spikeRules.push(splitRules[i]);\r\n        }\r\n\r\n        else if (forgetRes){\r\n            forgRules.push(splitRules[i]);\r\n        }\r\n\r\n          \r\n    }\r\n\r\n    return [spikeRules, forgRules];  \r\n    \r\n}\r\n\r\nexport const convertElements = elements =>{\r\n    var array = {\r\n        nodes: [],\r\n        edges:[],\r\n        edgeIDs: new Set(),\r\n    }\r\n    for (var k in elements) {\r\n        var element = elements[k];\r\n        if (element.currentRule){ // currently applying a rule\r\n            var newNodes = createClosedNeuron(element.id, element.position.x, element.position.y,element.rules, element.spikes, element.delay);\r\n            array.nodes.push(newNodes[0])\r\n            array.nodes.push(newNodes[1])\r\n            array.nodes.push(newNodes[2])\r\n            array.nodes.push(newNodes[3])\r\n        }else if(!element.isOutput && !element.isInput){ // standard interface for regular neurons\r\n            var newNodes = createNeuron(element.id, element.position.x,element.position.y,element.rules, element.spikes, element.delay);\r\n            array.nodes.push(newNodes[0])\r\n            array.nodes.push(newNodes[1])\r\n            array.nodes.push(newNodes[2])\r\n            array.nodes.push(newNodes[3])\r\n            \r\n        }else if(element.isInput){ // input neuron\r\n            var newInputNode = createInputNeuron(element.id, element.position.x,element.position.y, element.bitstring, 0);\r\n            array.nodes.push(newInputNode[0])\r\n            array.nodes.push(newInputNode[1])\r\n            \r\n        }else{\r\n            var newOutputNode = createOutputNeuron(element.id, element.position.x,element.position.y, element.bitstring, 0);\r\n            array.nodes.push(newOutputNode[0])\r\n            array.nodes.push(newOutputNode[1])\r\n            array.nodes.push(newOutputNode[2])\r\n        } \r\n        if(element.out){\r\n            for (var i=0; i< element.out.length; i++){\r\n                if (element.delay<0) {\r\n                    for (let out of element.out) {\r\n                      var newEdge = createEdge(element.id, element.out[i], (element.outWeights)[element.out[i]], ' edge--triggering');\r\n                      array.edges.push(newEdge);\r\n                      array.edgeIDs.add(element.id + \"->\" + element.out[i]);\r\n        \r\n                    }\r\n                }else{\r\n                    var newEdges = createEdge(element.id, element.out[i], (element.outWeights)[element.out[i]], '');\r\n                    array.edges.push(newEdges);\r\n                    array.edgeIDs.add(element.id + \"->\" + element.out[i]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return array;\r\n}\r\n","import produce from 'immer'\r\nexport function parseRule(rule, id) {\r\n    const re = /(a+)(\\+*\\**)\\/(a+)->(a+);([0-9]+)/\r\n    // const forgetRe = /(a+)(\\(*a*\\)*)(\\+*\\**)\\/(a+)->(0);(0)/\r\n    const forgetRe = /([1-9]*)a\\(*([1-9]*)(a*)\\)*(\\+?|\\*?)\\/([1-9]*)a->(0);(0)/\r\n\r\n    // const testRe = /(a+)\\(*(a*)\\)*(\\+*\\**)\\/(a+)->(a+);([0-9]+)/\r\n    // const testRe = /([1-9]*)a\\(*([1-9]*)a*\\)*(\\+?|\\*?)\\/([1-9]*)a->([1-9]*)a;([0-9]+)/\r\n    const testRe = /([1-9]*)a\\(*([1-9]*)(a*)\\)*(\\+?|\\*?)\\/([1-9]*)a->([1-9]*)a;([0-9]+)/;\r\n    const res = re.exec(rule);\r\n    const testRes = testRe.exec(rule);\r\n    const forgetRes = forgetRe.exec(rule);\r\n\r\n    /* if (res) {\r\n      const [, requires, symbol, consumes, produces, delayStr] = res\r\n      const delay = parseInt(delayStr, 10)\r\n      return[requires.length, symbol, consumes.length, produces.length, delay];\r\n    } */\r\n    if (testRes) {\r\n        console.log(\"Test Res\");\r\n        var [, requires, grouped, char, symbol, consumes, produces, delayStr] = testRes\r\n        const delay = parseInt(delayStr, 10)\r\n\r\n        if (requires == \"\"){\r\n            requires = 1;\r\n        }\r\n        if (char != \"\" && grouped == \"\"){\r\n            grouped = 1;\r\n        }\r\n\r\n        if (consumes == \"\"){\r\n            consumes = 1;\r\n        }\r\n\r\n        if (produces == \"\"){\r\n            produces = 1;\r\n        }\r\n\r\n        console.log({'id': id, 'requires': requires, 'char': char, 'grouped': grouped, 'symbol':symbol, 'consumes': consumes, 'produces': produces, 'delay': parseInt(delayStr)} );\r\n\r\n        return [parseInt(requires), parseInt(grouped), symbol, parseInt(consumes), parseInt(produces), delay];\r\n    } else if (forgetRes) {\r\n        var [, requires, grouped, char, symbol, consumes, produces, delayStr] = forgetRes;\r\n        if (requires == \"\"){\r\n            requires = 1;\r\n        }\r\n\r\n        if (char != \"\" && grouped == \"\"){\r\n            grouped = 1;\r\n        }\r\n\r\n        if (consumes == \"\"){\r\n            consumes = 1;\r\n        }\r\n        if (produces == \"\"){\r\n            produces = 1;\r\n        }\r\n        \r\n        console.log({'id': id, 'requires': requires, 'grouped': grouped, 'symbol':symbol, 'consumes': consumes, 'produces': produces, 'delay': parseInt(delayStr)} );\r\n        return [parseInt(requires), parseInt(grouped), symbol, parseInt(consumes), 0, 0];\r\n    }\r\n\r\n\r\n    return false\r\n}\r\nexport function canUseRule(requires, grouped, symbol, spikes, consumes) {\r\n    if (consumes > spikes){\r\n        return false;\r\n    }\r\n\r\n    if (symbol == '+') {\r\n        if (grouped > 0) {\r\n            if ((spikes - requires) % grouped == 0 && (spikes - requires) >= grouped) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        if (spikes >= requires) {\r\n            return true\r\n        }\r\n    }\r\n    else if (symbol == '*') {\r\n        if (grouped > 0) {\r\n            if ((spikes - requires) % grouped == 0) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        if (spikes >= requires - 1) {\r\n            return true\r\n        }\r\n    }\r\n    else if (spikes == requires) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nexport function step(neurons, time, isRandom, handleStartGuidedMode, handleSimulationEnd) {\r\n    const newStates = produce(neurons, draft => {\r\n        const spikeAdds = {}\r\n        const outputTracker = [];\r\n        const inputTracker = [];\r\n        var neuronValidRules = {};\r\n        var shouldEnd = true;        \r\n\r\n\r\n        for (var k in draft) {\r\n            var neuron = draft[k];\r\n            //choose rule to follow if not working on a rule currently\r\n            if (!neuron.currentRule && !neuron.isOutput && !neuron.isInput) {\r\n                delete draft[neuron.id].chosenRule;\r\n                delete draft[neuron.id].currentRule;\r\n                //pick a rule\r\n                var rules = neuron.rules.split(' ');\r\n                var validRules = [];\r\n                for (var i = 0; i < rules.length; i++) {\r\n                    var [requires, grouped, symbol, consumes, produces, delay] = parseRule(rules[i], k);\r\n                    if (canUseRule(requires, grouped, symbol, neuron.spikes, consumes)) {\r\n                        console.log(\"should end1\", shouldEnd);\r\n                        validRules.push(rules[i]);\r\n                        shouldEnd = false;\r\n                    }\r\n                }\r\n                console.log(\"should end2\", shouldEnd);\r\n                if (validRules.length == 1) {\r\n                    draft[neuron.id].currentRule = validRules[0];\r\n                    draft[neuron.id].chosenRule = validRules[0];\r\n                    var [requires, grouped, symbol, consumes, produces, delay] = parseRule(validRules[0], k);\r\n                    draft[neuron.id].delay = delay\r\n                } else if (isRandom == true && validRules.length > 1) {\r\n                    var randomIndex = Math.floor(Math.random() * (validRules.length))\r\n                    var [requires, grouped, symbol, consumes, produces, delay] = parseRule(validRules[randomIndex], k);\r\n                    draft[neuron.id].currentRule = validRules[randomIndex];\r\n                    draft[neuron.id].chosenRule = validRules[randomIndex];\r\n                    draft[neuron.id].delay = delay\r\n                } else if (isRandom == false && validRules.length > 1) {\r\n                    neuronValidRules[neuron.id] = validRules;\r\n                }\r\n\r\n            }\r\n        }\r\n        if (Object.keys(neuronValidRules).length > 0) {\r\n            console.log(\"Neuron valid rules\", neuronValidRules);\r\n            window.localStorage.setItem('shouldTimeStep', \"0\");\r\n            handleStartGuidedMode(neuronValidRules);\r\n            return;\r\n        }\r\n        for (var k in draft) {\r\n            var neuron = draft[k];\r\n            var neuronOutWeights = {...neuron.outWeights};\r\n            //work on the rule\r\n            if (neuron.currentRule) {\r\n                shouldEnd = false;\r\n                if (neuron.delay >= 0) {\r\n                    let newDelay = neuron.delay.valueOf();\r\n                    newDelay--;\r\n                    draft[neuron.id].delay = newDelay;\r\n                }\r\n                \r\n                if (neuron.delay < 0) {\r\n                    //consume spikes\r\n                    var [requires, grouped, symbol, consumes, produces, delay] = parseRule(neuron.currentRule, k);\r\n                   \r\n                    let newSpikes = neuron.spikes.valueOf();\r\n                    newSpikes -= consumes;\r\n\r\n                    draft[neuron.id].spikes = newSpikes;\r\n                    \r\n                    //send spikes\r\n                    if (neuron.out) {\r\n                        const neuronOutKeys = neuron.out;\r\n                        for (let k of neuronOutKeys) {\r\n                            \r\n                            spikeAdds[k] =\r\n                                k in spikeAdds ? spikeAdds[k] + produces : produces\r\n                            \r\n                            spikeAdds[k] = spikeAdds[k]*neuronOutWeights[k];    // Multiply # of spikes by the SYNAPSE WEIGHT\r\n                            console.log(\"Sent spikes from \" + k + \": \" + spikeAdds[k]);\r\n                        }\r\n                    }\r\n\r\n                    //resolve rule\r\n                    delete draft[neuron.id].currentRule;\r\n                }\r\n            } else if (neuron.isInput) {                \r\n                inputTracker.push(neuron.id);\r\n                console.log(\"BS\", neuron.bitstring);\r\n                var spike_arr = (neuron.bitstring).split(\",\");\r\n                var len = spike_arr.length;\r\n                console.log(\"SPIKE ARR\", spike_arr);\r\n\r\n                if ((neuron.bitstring).length < 1){\r\n                    len = 0;\r\n                }\r\n\r\n                if (neuron.out) {\r\n                    const neuronOut_in = neuron.out;\r\n                    for (let k of neuronOut_in) {    \r\n                        var bit = parseInt(spike_arr[time]);                        \r\n                        console.log(\"TIME\", time);\r\n                        console.log(\"LEN\", len);\r\n                        var spk;\r\n                        console.log(\"Bit\", bit);\r\n                        if (time < len){        // Check if bitstring length is less than time\r\n                            console.log(\"TIME OK\");\r\n                            shouldEnd = false;\r\n                            let newDelay = neuron.delay.valueOf();\r\n                            newDelay--;\r\n                            draft[neuron.id].delay = newDelay;                           \r\n                           \r\n                            spk = bit*neuronOutWeights[k];    // Multiply # of spikes by the SYNAPSE WEIGHT\r\n                           \r\n                        }\r\n                        else{\r\n                            console.log(\"TIME EXCEED\");\r\n                            spk = 0;\r\n                            draft[neuron.id].delay = 0;  \r\n                        }                     \r\n                        spikeAdds[k] = \r\n                            k in spikeAdds ? spikeAdds[k] + parseInt(spk): parseInt(spk);\r\n                        console.log(\"Sent spikes from IN\", neuron.id, k, spk);\r\n                    }\r\n                }\r\n            } else if (neuron.isOutput) {\r\n                outputTracker.push(neuron.id);\r\n                if (!(k in spikeAdds)) {\r\n                    spikeAdds[k] = 0\r\n                }\r\n            } else if (neuron.delay == -1 && !neuron.isInput) {\r\n                draft[neuron.id].delay = 0;\r\n            }\r\n        }\r\n        for (const k in spikeAdds) {\r\n            //states[k].spikes -= spikeAdds[k]\r\n            let newSpikes = parseInt(draft[k].spikes.valueOf());\r\n            newSpikes += spikeAdds[k];\r\n            \r\n            draft[k].spikes = newSpikes;\r\n\r\n            console.log(\"bitstring\", draft[k].bitstring);\r\n            \r\n            if (draft[k].isOutput) {\r\n                var newString;\r\n                if (time == 0){\r\n                    newString = `${spikeAdds[k] || 0}`\r\n                }\r\n                else{\r\n                    newString = `${draft[k].bitstring},${spikeAdds[k] || 0}`\r\n                }                \r\n                draft[k].bitstring = newString;\r\n                \r\n            }\r\n        }\r\n        console.log(\"should end\", shouldEnd);\r\n        if (shouldEnd) {\r\n            handleSimulationEnd();\r\n        }\r\n        window.localStorage.setItem('shouldTimeStep', \"1\");\r\n\r\n    })\r\n    localStorage.setItem(time + 'sec', JSON.stringify(newStates));\r\n    return newStates;\r\n\r\n}\r\n\r\nexport function null_step(neurons){\r\n    const same_state = produce(neurons, draft => {\r\n        console.log(\"new_state\")\r\n    })\r\n    return same_state;\r\n}\r\n\r\nexport function backStep(time) {\r\n    console.log(\"back step automata\");\r\n    var oldState = JSON.parse(localStorage.getItem(time + 'sec'));\r\n    return oldState;\r\n\r\n}\r\nexport function initialize(neurons) {\r\n    const states = {}\r\n    for (const k in neurons) {\r\n        const neuron = neurons[k]\r\n        states[k] = initializeState(neuron)\r\n    }\r\n    return states\r\n}\r\nexport function initializeState(neuron) {\r\n    return {\r\n        spikes: neuron.spikes,\r\n        delay: 0\r\n    }\r\n}","\r\nimport CytoscapeComponent from 'react-cytoscapejs';\r\nimport stylesheet from '../stylesheet'\r\nimport { Button, Container } from 'react-bootstrap';\r\nimport useAnimateEdges from './useAnimateEdges';\r\nimport { useEffect, useMemo } from 'react';\r\nimport { convertElements } from '../../utils/helpers';\r\nimport { canUseRule, parseRule } from '../../utils/automata';\r\nimport { AlignCenter, Trash, Eye, PencilSquare, XCircle} from 'react-bootstrap-icons';\r\nimport \"./popper.css\";\r\nimport Slider from '@mui/material/Slider';\r\n\r\n\r\nconst Snapse = ({ neurons, onEdgeCreate, handleShowDeleteAll, handleChangePosition, setIsClickedSynapse, headless, setNeurons, splitRules, \r\n  checkIsHover, handleShowEditSynapseModal, handleShowDeleteSynapseModal, time}) => {  \r\n\r\n  var isClickedSynapse = false;\r\n\r\n  const [cyRef, setCy] = useAnimateEdges()\r\n  const handleShow = () => {\r\n    handleShowDeleteAll();\r\n  };\r\n\r\n  function handleCenterGraph() {\r\n    const cy = cyRef.current;\r\n    \r\n    if (cy) {\r\n      \r\n      cy.center();\r\n      cy.fit();\r\n      cy.zoom({\r\n        level: 0.8,\r\n        position: { x: 100, y: 100 }\r\n      });\r\n    }\r\n  }\r\n  const elements = convertElements(neurons);\r\n  \r\n  useEffect(() => {\r\n    if (!headless) {\r\n      const cy = cyRef.current\r\n      if (cy) {     \r\n      \r\n        cy.on('mouseup', '.snapse-node, .snapse-output, .snapse-input', (evt) => {\r\n          console.log(\"change position\", evt.target.id());\r\n          handleChangePosition(evt.position, evt.target.id());\r\n        })\r\n\r\n        cy.on('tap', function(event){\r\n          // target holds a reference to the originator\r\n          // of the event (core or element)\r\n          var evtTarget = event.target;\r\n          var srcID = '.';\r\n          var dstID = '.';\r\n\r\n          if (evtTarget == cy){\r\n            console.log('tap on background');\r\n            isClickedSynapse = false;\r\n            console.log('EVT', cy);            \r\n            setIsClickedSynapse(isClickedSynapse, srcID, dstID);\r\n  \r\n          }\r\n\r\n          else if (evtTarget.isNode()){\r\n            isClickedSynapse = false;\r\n            setIsClickedSynapse(isClickedSynapse, srcID, dstID);\r\n            console.log(\"Tap on NODE\");\r\n          }\r\n\r\n          else if (evtTarget.isEdge()){\r\n            console.log(\"Tap on EDGE\");\r\n\r\n            // record edge ID\r\n            const edgeID = evtTarget.id();\r\n            console.log(\"Edge ID:\", edgeID);\r\n            var temp_edgeArr = edgeID.split(\"->\");         \r\n\r\n            srcID = temp_edgeArr[0];\r\n            dstID = temp_edgeArr[1];            \r\n\r\n            isClickedSynapse = true;\r\n\r\n            setIsClickedSynapse(isClickedSynapse, srcID, dstID);\r\n            console.log(\"ISCLICK\", isClickedSynapse, srcID, dstID);\r\n            }\r\n          \r\n        });\r\n      \r\n\r\n        cy.elements().unbind(\"mouseover\");\r\n        cy.elements().bind(\"mouseover\", (event) => {\r\n\r\n          var checker = Boolean(checkIsHover());\r\n          console.log(\"checker\", checker);\r\n\r\n          if (event.target.isNode() && checker) {\r\n            console.log(\"Hovering here\", checker);\r\n            event.target.popperRefObj = event.target.popper({\r\n              content: () => {\r\n                let content = document.createElement(\"div\");\r\n          \r\n                content.classList.add(\"popper-div\");\r\n\r\n                setNeurons(draft => {      \r\n                  let node = draft[event.target.id()];\r\n\r\n                  let node_type;\t\t\t\t\t\t\t\t\t\r\n\r\n                  if (node.isInput || node.isOutput) {\r\n                    if (node.isInput) {\r\n\t\t\t\t\t\t\t\t\t\t\tnode_type = \"Input neuron\";\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tnode_type = \"Output neuron\";\r\n\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tvar bitstring = \"<i>None </i>\";\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ((node.bitstring).length > 1){\r\n\t\t\t\t\t\t\t\t\t\t\tbitstring = node.bitstring;\r\n\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\r\n\r\n                    content.innerHTML = \"<b>Node ID: </b>\" + node.id + \"<br />\" + \"<br />\" +\r\n                                        \"<b>Node Type: </b>\" + node_type + \"<br />\" + \"<br />\" +\r\n                                        \"<b>Spike train: </b>\" + bitstring + \"<br />\";\r\n                  }        \r\n                  else {\r\n                    node_type = \"Regular neuron\";\r\n\t\t\t\t\t\t\t\t\t\tvar [spkRules, frgRules] = splitRules(node.rules);\r\n\r\n                    // var rules = node.rules.split(' ');\r\n                    // var validRules = [];\r\n                    // for (var i = 0; i < rules.length; i++) {\r\n                    //     var [requires, grouped, symbol, consumes, produces, delay] = parseRule(rules[i], node.id);\r\n                    //     if (canUseRule(requires, grouped, symbol, node.spikes, consumes)) {\r\n                    //         validRules.push(rules[i]);\r\n                    //     }\r\n                    // }\r\n\r\n                    // console.log(\"validRules\", validRules);\r\n\r\n                    // var determStr;\r\n\r\n                    // if (validRules.length > 1){\r\n                    //   determStr = \"True\";\r\n                    // }\r\n\r\n                    // else{\r\n                    //   determStr = \"False\";\r\n                    // }\r\n\r\n\t\t\t\t\t\t\t\t\t\tvar strSpkRules, strFrgRules;\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (spkRules.length == 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tstrSpkRules = \"<i> None </i>\";\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tstrSpkRules = spkRules.join(\"<br> \");\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (frgRules.length == 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tstrFrgRules = \"<i> None </i>\";\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tstrFrgRules = frgRules.join(\"<br> \");\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n                    content.innerHTML = \"<b>Node ID: </b>\" + node.id + \"<br />\" + \"<br />\" +\r\n                                        \"<b>Node Type: </b>\" + node_type + \"<br />\" + \"<br />\" +\r\n                                        \"<b>Current number of spikes: </b>\" + node.spikes + \"<br />\" + \"<br />\" +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"<b>Spiking rule/s: </b> <br>\" + strSpkRules + \"<br />\" + \"<br />\" +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"<b>Forgetting rule/s: </b> <br>\" + strFrgRules + \"<br />\" \r\n                                        // + \"<br />\" + \"<b>Non-deterministic: </b>\" + determStr + \"<br />\";\r\n                  }\r\n\r\n                })\r\n          \r\n               \r\n                document.body.appendChild(content);\r\n               \r\n                return content;\r\n              },\r\n            });\r\n          }\r\n          else if (event.target.isEdge() && checker) {\r\n            console.log(\"HOVERING EDGE\");\r\n            event.target.popperRefObj = event.target.popper({\r\n              content: () => {\r\n                let content = document.createElement(\"div\");\r\n          \r\n                content.classList.add(\"popper-div\");\r\n\r\n                const edgeID = event.target.id();\r\n                console.log(edgeID);\r\n                var edge_ID_arr = edgeID.split(\"->\");\r\n                var src = edge_ID_arr[0];\r\n                var dst = edge_ID_arr[1];\r\n\r\n                setNeurons(draft => {\r\n                  var weightsDict = {...draft[src].outWeights};\r\n                  var synapse_weight = parseInt(weightsDict[dst]);\r\n    \r\n                  content.innerHTML = \"<b>Synapse ID: </b>\" + edgeID + \"<br />\" + \"<br />\" +\r\n                                      \"<b>Source Node: </b>\" + src + \"<br />\" + \"<br />\" +\r\n                                      \"<b>Destination Node: </b>\" + dst + \"<br />\" + \"<br />\" +\r\n                                      \"<b>Synapse Weight: </b>\" + synapse_weight + \"<br />\";\r\n                })\r\n          \r\n                \r\n                document.body.appendChild(content);\r\n                \r\n                return content;\r\n              },\r\n            });\r\n\r\n          }\r\n        });\r\n        \r\n        cy.elements().unbind(\"mouseout\");\r\n        cy.elements().bind(\"mouseout\", (event) => {\r\n          var checker = Boolean(checkIsHover());\r\n          if ((event.target.isNode() || event.target.isEdge()) && checker) {\r\n            if (event.target.popper) {\r\n              event.target.popperRefObj.state.elements.popper.remove();\r\n              event.target.popperRefObj.destroy();\r\n            }\r\n          }\r\n        });\r\n\r\n        \r\n        cy.gridGuide({\r\n          guidelinesStyle: {\r\n            strokeStyle: \"black\",\r\n            horizontalDistColor: \"#ff0000\",\r\n            verticalDistColor: \"green\",\r\n            initPosAlignmentColor: \"#0000ff\",\r\n          }\r\n        });\r\n        cy.edgehandles({\r\n          handleNodes: '.snapse-node, .snapse-node__closed, .snapse-input',\r\n          preview: false,\r\n          loopAllowed: () => false,\r\n          edgeType: function (sourceNode, targetNode) {\r\n            return 'flat'\r\n            //return sourceNode.edgesTo(targetNode).empty() ? 'flat' : undefined\r\n          },\r\n          complete: onEdgeCreate\r\n        });\r\n        \r\n      }\r\n    }\r\n    \r\n  }, [cyRef, headless]);\r\n  return headless ? (<div id=\"cyHeadless\"></div>) : (\r\n    <div style={{\r\n      width: \"100%\",\r\n      height: \"100%\"\r\n    }}>\r\n      <Button className=\"center-graph-button\" variant=\"secondary\" onClick={handleCenterGraph}><AlignCenter />{' '}Center Graph</Button>{\" \"}     \r\n      <Button variant=\"success\" size=\"md\" id=\"edit-syn-btn\" className=\"node-actions\" onClick={handleShowEditSynapseModal} style={{ textAlign: \"center\", marginRight: \"0.3em\" }} disabled={time > 0 ? true : false}><PencilSquare />{' '}Edit Synapse</Button>\r\n      <Button variant=\"warning\" size=\"md\" id=\"del-syn-btn\" className=\"node-actions\" onClick={handleShowDeleteSynapseModal} style={{ textAlign: \"center\", marginRight: \"0.3em\" }} disabled={time > 0 ? true : false}><XCircle />{' '}Delete Synapse</Button>\r\n      <Button id=\"clear-all-btn\" style={{float: 'right'}} variant=\"danger\" onClick={handleShow}><Trash />{' '}Clear All</Button>\r\n      <CytoscapeComponent\r\n        cy={setCy}\r\n        wheelSensitivity={0.3}\r\n        elements={CytoscapeComponent.normalizeElements(elements)}\r\n        style={{\r\n          width: \"100%\",\r\n          height: \"100%\"\r\n        }}\r\n        stylesheet={stylesheet} />\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default Snapse;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useEffect, useReducer, useState } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\n\r\nconst ElementPopUp = ({ showElementPopup, handleCloseElementPopup, handleError, nodeID, nodeType, nodeSRules, nodeFRules, nodeSpikes, nodeBitstring}) => {\r\n    const [rules, setRules] = useState('');\r\n    const [startingSpikes, setStartingSpikes] = useState(0);\r\n    const handleClose = () => {\r\n        //console.log(neuronId, rules, startingSpikes);\r\n        handleCloseElementPopup();\r\n    }\r\n\r\n\r\n    if (nodeType == \"Input\"){\r\n        return (\r\n            <Modal show={showElementPopup} onHide={handleClose}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Input Node Details</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <b>Spike train:</b> {nodeBitstring}\r\n                </Modal.Body>\r\n                    \r\n            </Modal>\r\n        )\r\n    }\r\n\r\n    else if (nodeType == \"Output\"){\r\n        return (\r\n            <Modal show={showElementPopup} onHide={handleClose}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Output Node Details</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <b>Spike train:</b> {nodeBitstring}\r\n                </Modal.Body>\r\n            </Modal>\r\n        )\r\n    }\r\n\r\n    else{\r\n        return (\r\n            <Modal show={showElementPopup} onHide={handleClose}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Node Details</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <b>Node ID:</b> {nodeID}\r\n                </Modal.Body>\r\n                <Modal.Body>\r\n                    <b>Type:</b> {nodeType} Neuron\r\n                </Modal.Body>\r\n                <Modal.Body>\r\n                    <b>Current number of spikes:</b> {nodeSpikes}\r\n                </Modal.Body>\r\n                <Modal.Body>\r\n                    <b>Spiking Rules:</b> {nodeSRules}\r\n                      \r\n                </Modal.Body>\r\n                <Modal.Body>\r\n                    <b>Forgetting Rules:</b> {nodeFRules}\r\n                </Modal.Body>\r\n                \r\n            </Modal>\r\n        )\r\n    }\r\n\r\n  \r\n}\r\nexport default ElementPopUp;","import { useEffect, useState } from 'react';\r\nimport { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useImmer } from 'use-immer';\r\n\r\nconst ChooseRuleForm = ({showChooseRuleModal, handleCloseChooseRuleModal,rules, handleChosenRules}) => {\r\n    const [values, setValues] = useImmer({});\r\n    useEffect(()=>{\r\n        setValues(currentValues =>{\r\n            for (var k in rules){\r\n                currentValues[k] = rules[k][0];\r\n            }\r\n        })\r\n    },[rules])\r\n    function onSubmit(e){\r\n        e.preventDefault();\r\n        handleChosenRules(values);\r\n    }\r\n    function handleSelectChange(event,neuronId){\r\n        setValues(currentValues =>{\r\n            for (var k in currentValues){\r\n                if(k == neuronId){\r\n                    currentValues[k] = event.target.value;\r\n                }\r\n              \r\n            }\r\n        })\r\n    }\r\n    const GroupRules = (label,options) =>{\r\n        let neuronOptions = options.map((neuron)=>(\r\n            <option value={neuron} key={neuron}>{neuron}</option>)\r\n        )   \r\n        return(\r\n            <Form.Group>\r\n                <Form.Label>{label}</Form.Label>\r\n                <Form.Control as=\"select\" value={values[label]} onChange={(event)=>handleSelectChange(event, label)}>\r\n                    {neuronOptions}\r\n                </Form.Control>\r\n            </Form.Group>\r\n            \r\n        )\r\n    }\r\n    var ruleList = Object.keys(rules);\r\n    var form = [];\r\n    for (var i=0; i<ruleList.length; i++){\r\n        console.log(i);\r\n        form.push(GroupRules(ruleList[i], rules[ruleList[i]], handleSelectChange));\r\n    }\r\n    return (\r\n        <Modal show={showChooseRuleModal} onHide={handleCloseChooseRuleModal} backdrop=\"static\" keyboard={false}>\r\n            <Modal.Header>\r\n                <Modal.Title>Choose Rule Form</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n            <Form onSubmit={onSubmit}>\r\n                    {form}\r\n                <Button type=\"submit\">Submit</Button>\r\n            </Form>\r\n\r\n        </Modal.Body>\r\n        </Modal>\r\n    )\r\n}\r\n\r\nexport default ChooseRuleForm;","import { Button, Form, Modal, OverlayTrigger, Tooltip, Row, Col} from 'react-bootstrap';\r\nimport {QuestionCircle} from 'react-bootstrap-icons';\r\nimport { useReducer, useState } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\nimport shortid from \"shortid\";\r\n\r\nconst renderTooltip = (props) => (\r\n  <Tooltip id=\"button-tooltip\" style={{'width': '300px'}}{...props}>\r\n    <p><b>Expression</b>: a<sup>i</sup>(a<sup>j</sup>)<sup>*</sup>, where i and j cannot both be 0.<br/>\r\n      <b>Invalid Input</b>:<br/>a/a-&gt;1;1, a^2/a-&gt;a;1,<br/> (a)a/a-&gt;a;1 <br/>\r\n      <b>Valid Input</b>:<br/>a/a-&gt;a;1, 2a/a-&gt;a;1,<br/> (2a)*/a-&gt;a;1\r\n    </p>\r\n  </Tooltip>\r\n);\r\n\r\nconst formReducer = (state, event) => {\r\n  if (event.reset) {\r\n    return {\r\n      id:'',\r\n      startingSpikes: 0,\r\n      rules: '',\r\n    }\r\n  }\r\n  return {\r\n    ...state,\r\n    [event.name]: event.value\r\n  }\r\n}\r\n\r\nconst initialFormState = {id:\"\", rules:\"\", startingSpikes:0}; \r\n\r\nconst NewNodeForm = ({ showNewNodeModal, handleCloseModal, handleNewNode, handleError }) => {\r\n  const handleClose = () => {\r\n    handleCloseModal();\r\n  };\r\n  const [formData, setFormData] = useReducer(formReducer, initialFormState);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const handleChange = event => {\r\n    setFormData({\r\n      name: event.target.name,\r\n      value: event.target.value,\r\n    });\r\n  };\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    let newId = `${formData.id}-${shortid.generate()}`;\r\n\r\n    // Add function that changes i and j to rules\r\n\r\n    if (allRulesValid(formData.rules)) {\r\n      console.log(\"All rules valid\");\r\n      handleClose();\r\n      setSubmitting(true);\r\n\r\n      setTimeout(() => {\r\n        setSubmitting(false);\r\n        setFormData({\r\n          reset: true\r\n        })\r\n      }, 3000);\r\n      const newNeuron = {\r\n        id: newId,\r\n        position: { x: 100, y: 100 },\r\n        rules: formData.rules,\r\n        startingSpikes: parseInt(formData.startingSpikes),\r\n        delay: 0,\r\n        spikes: parseInt(formData.startingSpikes),\r\n        isOutput: false,\r\n        isInput: false,                                   // check if Input node\r\n        out: [],\r\n        outWeights: {}                                    // dict of weights for each synapse\r\n      }\r\n      handleNewNode(newNeuron);\r\n    } else {\r\n      console.log(\"One or more of the rules is invalid\");\r\n      handleError(\"One or more of the rules is invalid\");\r\n      handleClose();\r\n    };\r\n  }\r\n\r\n  return (\r\n    <Modal show={showNewNodeModal} onHide={handleClose}>\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>Create New Node</Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        <Form onSubmit={handleSubmit} data-testid=\"new-node-form\">\r\n        <Form.Group>\r\n            <Form.Label htmlFor=\"node-name\">Node Name</Form.Label>\r\n            <Form.Control required id=\"node-name\" name=\"id\" type=\"text\" placeholder=\"n0\" value={formData.id} onChange={handleChange} />\r\n          </Form.Group>\r\n          <Form.Group>\r\n                <Form.Label htmlFor=\"node-rules\">Node Rules</Form.Label>\r\n                    <OverlayTrigger\r\n                    placement=\"right\"\r\n                    delay={{ show: 250, hide: 400 }}\r\n                    overlay={renderTooltip}\r\n                    >\r\n                    <QuestionCircle style={{'padding-left':'5px'}}/>\r\n                    </OverlayTrigger>\r\n            <Form.Control id=\"node-rules\" required name=\"rules\" type=\"text\" placeholder=\"a/a->a;0 aa/a->a;1\" value={formData.rules} onChange={handleChange} />\r\n                <Form.Text className=\"text-muted\">\r\n                  Enter valid rules only. Separate each rule with a space.\r\n                </Form.Text>\r\n          </Form.Group>\r\n          <Form.Group>\r\n            <Form.Label htmlFor=\"starting-spikes\">Starting Spike Number</Form.Label>\r\n            <Form.Control id=\"starting-spikes\" required name=\"startingSpikes\" type=\"number\" min=\"0\" value={formData.startingSpikes} onChange={handleChange} />\r\n          </Form.Group>\r\n          <Button variant=\"secondary\" onClick={handleClose}>\r\n            Close\r\n            </Button> {' '}\r\n          <Button type=\"submit\" variant=\"primary\" data-testid=\"new-node-submit-button\">\r\n            Save Changes\r\n            </Button>\r\n        </Form>\r\n      </Modal.Body>\r\n    </Modal>\r\n  )\r\n}\r\nexport default NewNodeForm;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useReducer, useState } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\nimport shortid from \"shortid\";\r\n\r\nconst formReducer = (state, event) => {\r\n  if (event.reset) {\r\n    return {\r\n      id:'',\r\n    }\r\n  }\r\n  return {\r\n    ...state,\r\n    [event.name]: event.value\r\n  }\r\n}\r\n\r\nconst initialFormState = {id:\"\"}; \r\n\r\nconst AddSynapseWeightForm = ({showAddWeightModal, handleCloseAddWeightModal, handleAddWeight, handleError, srce, dest}) => {\r\n  const handleClose = () => {\r\n    handleAddWeight(srce, dest, 1)\r\n    handleCloseAddWeightModal();\r\n  };\r\n  const [neuronId, setNeuronId] = useState(''); //\r\n  const [formData, setFormData] = useReducer(formReducer, initialFormState);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const handleChange = event => {\r\n    console.log(event.target.value);\r\n    console.log(event.target.name);\r\n    setFormData({\r\n      name: event.target.name,\r\n      value: event.target.value,\r\n    });\r\n  };\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    const weight = parseInt(formData.weight);\r\n    console.log(\"SOURCE\", srce);\r\n    console.log(\"DEST\", dest);\r\n    console.log(\"weight\", weight);    \r\n    handleClose();\r\n    // let newId = `${formData.id}-${shortid.generate()}`;\r\n    //   handleClose();\r\n    setSubmitting(true);\r\n    setTimeout(() => {\r\n      setSubmitting(false);\r\n    }, 3000);\r\n    //   const newOutput = {\r\n    //     id: newId,\r\n    //     position: { x: 300, y: 300 },\r\n    //     isOutput: true,\r\n    //     spikes: 0,\r\n    //     bitstring: ' '\r\n    //   }\r\n    handleAddWeight(srce, dest, weight, 0);\r\n  }\r\n\r\n  return (\r\n    <Modal show={showAddWeightModal} onHide={handleClose}>\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>Add Synapse Weight</Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        <Form onSubmit={handleSubmit}>\r\n        <Form.Group>\r\n            <Form.Label>Weight of the Synapse between {srce} and {dest}:</Form.Label>\r\n            <Form.Control  required name=\"weight\" type=\"number\" placeholder={1} min={1} value={formData.weight} onChange={handleChange} />\r\n          </Form.Group>\r\n          <Button variant=\"secondary\" onClick={handleClose}>\r\n            Close\r\n            </Button> {' '}\r\n          <Button type=\"submit\" variant=\"primary\">\r\n            Save Changes\r\n            </Button>\r\n        </Form>\r\n      </Modal.Body>\r\n    </Modal>\r\n  )\r\n}\r\nexport default AddSynapseWeightForm;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useReducer, useState } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\nimport shortid from \"shortid\";\r\n\r\nconst formReducer = (state, event) => {\r\n  if (event.reset) {\r\n    return {\r\n      id:'',\r\n    }\r\n  }\r\n  return {\r\n    ...state,\r\n    [event.name]: event.value\r\n  }\r\n}\r\n\r\nconst initialFormState = {id:\"\"}; \r\n\r\nconst NewOutputNodeForm = ({ showNewOutputModal, handleCloseNewOutputModal, handleNewOutput, handleError }) => {\r\n  const handleClose = () => {\r\n    handleCloseNewOutputModal();\r\n  };\r\n  const [formData, setFormData] = useReducer(formReducer, initialFormState);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const handleChange = event => {\r\n    console.log(event.target.value);\r\n    console.log(event.target.name);\r\n    setFormData({\r\n      name: event.target.name,\r\n      value: event.target.value,\r\n    });\r\n  };\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    let newId = `${formData.id}-${shortid.generate()}`;\r\n      handleClose();\r\n      setSubmitting(true);\r\n\r\n      setTimeout(() => {\r\n        setSubmitting(false);\r\n        setFormData({\r\n          reset: true\r\n        })\r\n      }, 3000);\r\n      const newOutput = {\r\n        id: newId,\r\n        position: { x: 300, y: 300 },\r\n        isOutput: true,\r\n        spikes: 0,\r\n        bitstring: ' '\r\n      }\r\n      handleNewOutput(newOutput);\r\n  }\r\n\r\n  return (\r\n    <Modal show={showNewOutputModal} onHide={handleClose}>\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>Create New Node</Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        <Form onSubmit={handleSubmit}>\r\n        <Form.Group>\r\n            <Form.Label>Output Node Name</Form.Label>\r\n            <Form.Control  required name=\"id\" type=\"text\" placeholder=\"n0\" value={formData.id} onChange={handleChange} />\r\n          </Form.Group>\r\n          <Button variant=\"secondary\" onClick={handleClose}>\r\n            Close\r\n            </Button> {' '}\r\n          <Button type=\"submit\" variant=\"primary\">\r\n            Save Changes\r\n            </Button>\r\n        </Form>\r\n      </Modal.Body>\r\n    </Modal>\r\n  )\r\n}\r\nexport default NewOutputNodeForm;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useReducer, useState } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\nimport shortid from \"shortid\";\r\n\r\nconst formReducer = (state, event) => {\r\n  if (event.reset) {\r\n    return {\r\n      id:'',\r\n    }\r\n  }\r\n  return {\r\n    ...state,\r\n    [event.name]: event.value\r\n  }\r\n}\r\n\r\nconst initialFormState = {id:\"\"}; \r\n\r\nconst NewInputNodeForm = ({ showNewInputModal, handleCloseNewInputModal, handleNewInput, handleError }) => {\r\n  const handleClose = () => {\r\n    handleCloseNewInputModal();\r\n  };\r\n  const [formData, setFormData] = useReducer(formReducer, initialFormState);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const handleChange = event => {\r\n    console.log(event.target.value);\r\n    console.log(event.target.name);\r\n    setFormData({\r\n      name: event.target.name,\r\n      value: event.target.value,\r\n    });\r\n  };\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    let newId = `${formData.id}-${shortid.generate()}`;\r\n      handleClose();\r\n      setSubmitting(true);\r\n\r\n      setTimeout(() => {\r\n        setSubmitting(false);\r\n        setFormData({\r\n          reset: true\r\n        })\r\n      }, 3000);\r\n      const newInput = {\r\n        id: newId,\r\n        position: { x: 300, y: 300 },\r\n        isInput: true,\r\n        isOutput: false,\r\n        spikes: 0,\r\n        delay: 0,\r\n        out: [],\r\n        bitstring: formData.bitstring,\r\n        outWeights: {}\r\n      }\r\n      handleNewInput(newInput);\r\n  }\r\n\r\n  return (\r\n    <Modal show={showNewInputModal} onHide={handleClose}>\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>Create New Node</Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        <Form onSubmit={handleSubmit}>\r\n        <Form.Group>\r\n            <Form.Label>Input Node Name</Form.Label>\r\n            <Form.Control  required name=\"id\" type=\"text\" placeholder=\"n0\" value={formData.id} onChange={handleChange} />\r\n        </Form.Group>\r\n        <Form.Group>\r\n          <Form.Label> Bitstring/Spike Train</Form.Label>\r\n          <Form.Control  required name=\"bitstring\" type=\"text\" placeholder=\"1,0,1\" value={formData.bitstring} onChange={handleChange} />\r\n        </Form.Group>\r\n          <Button variant=\"secondary\" onClick={handleClose}>\r\n            Close\r\n            </Button> {' '}\r\n          <Button type=\"submit\" variant=\"primary\">\r\n            Save Changes\r\n            </Button>\r\n        </Form>\r\n      </Modal.Body>\r\n    </Modal>\r\n  )\r\n}\r\nexport default NewInputNodeForm;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useEffect, useReducer, useState } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\n\r\nconst EditNodeForm = ({ showEditModal, handleCloseEditModal, handleEditNode, handleError, neurons }) => {\r\n    \r\n    const [neuronId, setNeuronId] = useState('');\r\n    const [rules, setRules] = useState('');\r\n    const [startingSpikes, setStartingSpikes] = useState(0);\r\n    const handleClose = () => {\r\n        setNeuronId(null);\r\n        setRules(null);\r\n        setStartingSpikes(null);\r\n        //console.log(neuronId, rules, startingSpikes);\r\n        handleCloseEditModal();\r\n    };\r\n    useEffect(() => {\r\n        firstUpdate();\r\n    }, []);\r\n    function firstUpdate() {\r\n        var filteredObject = Object.keys(neurons).reduce(function (r, e) {\r\n            if (!neurons[e].isOutput && !neurons[e].isInput) r[e] = neurons[e];\r\n            return r;\r\n        }, {});\r\n        //var keys = Object.keys(filteredObject);\r\n        //setNeuronId(keys[0]);\r\n        //setRules(filteredObject[keys[0]].rules);\r\n        //setStartingSpikes(filteredObject[keys[0]].startingSpikes);\r\n    }\r\n    var filteredObject = Object.keys(neurons).reduce(function (r, e) {\r\n        if (!neurons[e].isOutput && !neurons[e].isInput) r[e] = neurons[e];\r\n        \r\n        return r;\r\n    }, {});\r\n    let neuronOptions = Object.keys(filteredObject).map((neuron) => (\r\n        <option value={neuron} key={neuron}>{neuron}</option>)\r\n    )\r\n    \r\n    \r\n    function handleSelectChange(event) {\r\n        let id = event.target.value;\r\n        \r\n        setNeuronId(id);\r\n        setRules(neurons[id].rules);\r\n        setStartingSpikes(neurons[id].startingSpikes);\r\n    }\r\n    function handleSubmit(event) {\r\n        console.log(neuronId, rules, startingSpikes);\r\n        event.preventDefault();\r\n        console.log(neuronId, rules, startingSpikes);\r\n        if (!neuronId || neuronId == '-1') {\r\n            handleError(\"Please select a node to edit\");\r\n            return;\r\n        }\r\n        else {\r\n            if (allRulesValid(rules)) {\r\n                console.log(\"All rules valid\");\r\n                handleClose();\r\n                handleEditNode(neuronId, rules, startingSpikes);\r\n            } else {\r\n                console.log(\"One or more of the rules is invalid\");\r\n                handleError(\"One or more of the rules is invalid\");\r\n            };\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Modal show={showEditModal} onHide={handleClose}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Edit Regular Node</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Form onSubmit={handleSubmit} data-testid=\"edit-node-form\">\r\n                    <Form.Group>\r\n                        <Form.Label>Node</Form.Label>\r\n                        <Form.Control required data-testid=\"select-option\" as=\"select\" defaultValue={-1} onChange={handleSelectChange}>\r\n                            <option disabled value={-1} key={-1}>Select a node</option>\r\n                            {neuronOptions}\r\n                        </Form.Control>\r\n                    </Form.Group>\r\n                    <Form.Group>\r\n                        <Form.Label htmlFor=\"node-rules\" >Node Rules</Form.Label>\r\n                        <Form.Control id=\"node-rules\" required name=\"rules\" type=\"text\" placeholder=\"a/a->a;0 aa/a->a;1\" value={rules} onChange={(event) => { setRules(event.target.value) }} />\r\n                        <Form.Text className=\"text-muted\">\r\n                            Enter valid rules only. Separate each rule with a space.\r\n                        </Form.Text>\r\n                    </Form.Group>\r\n                    <Form.Group>\r\n                        <Form.Label htmlFor=\"startingSpikes\">Starting Spike Number</Form.Label>\r\n                        <Form.Control id=\"startingSpikes\" required name=\"startingSpikes\" type=\"number\" min=\"0\" placeholder=\"0\" value={startingSpikes} onChange={(event) => setStartingSpikes(event.target.value)} />\r\n                    </Form.Group>\r\n                    <Button variant=\"secondary\" onClick={handleClose}>\r\n                        Close\r\n            </Button> {' '}\r\n                    <Button type=\"submit\" variant=\"primary\" data-testid=\"edit-node-submit-button\">\r\n                        Save Changes\r\n            </Button>\r\n                </Form>\r\n            </Modal.Body>\r\n        </Modal>\r\n    )\r\n}\r\nexport default EditNodeForm;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useEffect, useReducer, useState, Text } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\nimport { setUseProxies } from 'immer';\r\n\r\nconst EditInputNodeForm = ({ showEditInputModal, handleCloseEditInputModal, handleEditInputNode, handleError, neurons }) => {\r\n\r\n    const [neuronId, setNeuronId] = useState('');\r\n    const [spikeTrain, setSpikeTrain] = useState('');\r\n\r\n    const handleClose = () => {\r\n        setSpikeTrain(null);\r\n        setNeuronId(null);\r\n        //console.log(neuronId, rules, startingSpikes);\r\n        handleCloseEditInputModal();\r\n    };\r\n    useEffect(() => {\r\n        firstUpdate();\r\n    }, []);\r\n    function firstUpdate() {\r\n        var filteredObject = Object.keys(neurons).reduce(function (r, e) {\r\n            if (neurons[e].isInput) r[e] = neurons[e];\r\n            return r;\r\n        }, {});\r\n        \r\n    }\r\n    var filteredObject = Object.keys(neurons).reduce(function (r, e) {\r\n        if (neurons[e].isInput) r[e] = neurons[e];\r\n        \r\n        return r;\r\n    }, {});\r\n    let neuronOptions = Object.keys(filteredObject).map((neuron) => (\r\n        <option value={neuron} key={neuron}>{neuron}</option>)\r\n    )\r\n\r\n    \r\n    function handleSelectChange(event) {\r\n        let id = event.target.value;        \r\n        setNeuronId(id);\r\n        setSpikeTrain(neurons[id].bitstring);\r\n    }\r\n    function handleSubmit(event) {\r\n        \r\n        event.preventDefault();\r\n       \r\n        if (!neuronId || neuronId == '-1') {\r\n            handleError(\"Please select a node to edit!\");\r\n            return;\r\n        }\r\n        else {\r\n           \r\n                handleClose();\r\n                handleEditInputNode(neuronId, spikeTrain);\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n        <Modal show={showEditInputModal} onHide={handleClose}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Edit Input Node</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Form onSubmit={handleSubmit} data-testid=\"edit-node-form\">\r\n                    <Form.Group>\r\n                        <Form.Label>Node</Form.Label>\r\n                        <Form.Control required data-testid=\"select-option\" as=\"select\" defaultValue={-1} onChange={handleSelectChange}>\r\n                            <option disabled value={-1} key={-1}>Select an input node</option>\r\n                            {neuronOptions}\r\n                        </Form.Control>\r\n                    </Form.Group>\r\n                    \r\n                    <Form.Group>\r\n                        <Form.Label>Bitstring/Spike Train</Form.Label>\r\n                        <Form.Control id=\"spikeTrain\" required name=\"spikeTrain\" type=\"text\" placeholder=\"1,0,1\" value={spikeTrain} onChange={(event) => { setSpikeTrain(event.target.value) }} />\r\n                        <Form.Text className=\"text-muted\">\r\n                            Enter spike train. Separate spikes with <b>commas</b> with <b>NO space in between</b> (e. g. <b>1,0,1,1</b>).\r\n                        </Form.Text>\r\n                    </Form.Group>\r\n                    <Button variant=\"secondary\" onClick={handleClose}>\r\n                        Close\r\n            </Button> {' '}\r\n                    <Button type=\"submit\" variant=\"primary\" data-testid=\"edit-node-submit-button\">\r\n                        Save Changes\r\n            </Button>\r\n                </Form>\r\n            </Modal.Body>\r\n        </Modal>\r\n    )\r\n}\r\nexport default EditInputNodeForm;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useEffect, useReducer, useState, Text } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\nimport { setUseProxies } from 'immer';\r\n\r\nconst EditSynapseForm = ({ showEditSynapseModal, handleCloseEditSynapseModal, handleEditSynapse, handleError, neurons, isClickedSynapse, srcID, dstID, \r\n    setWeight, weight_main, setNeurons, handleDeleteSynapse}) => {\r\n    const handleClose = () => {\r\n        if (isClickedSynapse){\r\n            setWeight(weight_main);\r\n        }\r\n\r\n        else{\r\n            setWeight(1)\r\n        }\r\n        \r\n        handleCloseEditSynapseModal();\r\n    };\r\n\r\n   \r\n\r\n    function handleSubmit(event) {        \r\n        event.preventDefault();\r\n       \r\n        if (!isClickedSynapse) {\r\n            handleError(\"Please click a synapse to edit\");\r\n            return;\r\n        }\r\n\r\n        else{   \r\n            handleClose();\r\n            setTimeout(() => {\r\n            }, 3000);\r\n\r\n            if (weight_main == 0){\r\n                setNeurons(draft => {\r\n                    var weightsDict = {...draft[srcID].outWeights};\r\n                    weightsDict[dstID] = 1;\r\n                    draft[srcID].outWeights = weightsDict;\r\n                    handleDeleteSynapse(srcID, dstID);\r\n              \r\n                });\r\n            }\r\n\r\n            else{\r\n                handleEditSynapse(srcID, dstID, weight_main);\r\n            }            \r\n        }\r\n      \r\n    }\r\n\r\n    var currWeight;\r\n\r\n    if (isClickedSynapse){\r\n        var weightsDict = {...neurons[srcID].outWeights};\r\n        currWeight = parseInt(weightsDict[dstID]);\r\n\r\n    }\r\n\r\n    else{\r\n        setWeight(1);\r\n        currWeight = 1;\r\n    }\r\n    \r\n    if (isClickedSynapse){\r\n        return (\r\n            <Modal show={showEditSynapseModal} onHide={handleClose}>\r\n             <Modal.Header closeButton>\r\n                    <Modal.Title>Edit Clicked Synapse</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <Form onSubmit={handleSubmit} data-testid=\"edit-node-form\">\r\n                        <Form.Group>       \r\n                                         \r\n                            <Form.Label>Selected Synapse: {srcID}->{dstID}</Form.Label>\r\n                        </Form.Group>\r\n                        <Form.Group>   \r\n                            <Form.Label>Source Node: <b>{srcID}</b></Form.Label>\r\n                        </Form.Group>\r\n                        <Form.Group>   \r\n                            <Form.Label>Destination Node: <b>{dstID}</b></Form.Label>\r\n                        </Form.Group>\r\n                        <Form.Group>\r\n                            <Form.Label htmlFor=\"synapse-weight\" >Synapse Weight</Form.Label>                        \r\n                            <Form.Control id=\"synapse-weight\" required name=\"weight\" type=\"number\" min=\"0\" placeholder={currWeight} value={weight_main} onChange={(event) => { setWeight(event.target.value) }} />\r\n                            <Form.Text className=\"text-muted\">\r\n                                Enter any <b>nonnegative integer</b>.\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n        \r\n                        <Button variant=\"secondary\" onClick={handleClose}>\r\n                            Close\r\n                </Button> {' '}\r\n                        <Button type=\"submit\" variant=\"primary\" data-testid=\"edit-node-submit-button\">\r\n                            Save Changes\r\n                </Button>\r\n                    </Form>\r\n                </Modal.Body>\r\n            </Modal>\r\n        )\r\n\r\n    }\r\n\r\n    else{\r\n        return (\r\n            <Modal show={showEditSynapseModal} onHide={handleClose}>\r\n             <Modal.Header closeButton>\r\n                    <Modal.Title>Edit Clicked Synapse</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <Form onSubmit={handleSubmit} data-testid=\"edit-node-form\">\r\n                        <Form.Group>       \r\n                                         \r\n                            <Form.Label><b>NO SELECTED SYNAPSE! Please click a synapse to edit.</b></Form.Label>\r\n                        </Form.Group>\r\n                    </Form>            \r\n                </Modal.Body>\r\n            </Modal>\r\n        )\r\n    }\r\n}\r\nexport default EditSynapseForm;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useReducer, useState } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\n\r\nconst DeleteNodeForm = ({ showDeleteModal, handleCloseDeleteModal, handleDeleteNode, handleError, neurons }) => {\r\n    const [neuronId, setNeuronId] = useState('');\r\n    const handleClose = () => {\r\n        handleCloseDeleteModal();\r\n    };\r\n    let neuronOptions = Object.keys(neurons).map((neuron)=>(\r\n        <option value={neuron} key={neuron}>{neuron}</option>)\r\n    )\r\n\r\n    let defaultNeuron = Object.keys(neurons)[0];\r\n    function handleSelectChange(event){\r\n        setNeuronId(event.target.value);\r\n    }\r\n    function handleSubmit(event) {\r\n        event.preventDefault();\r\n        if(neuronId!==''){\r\n            \r\n            handleClose();\r\n                setTimeout(() => {\r\n                    setNeuronId('');\r\n                }, 3000);\r\n                handleDeleteNode(neuronId);\r\n        }else{\r\n            handleClose();\r\n                setTimeout(() => {\r\n                    setNeuronId('');\r\n                }, 3000);\r\n                handleDeleteNode(defaultNeuron);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Modal show={showDeleteModal} onHide={handleClose}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Delete Node</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Form onSubmit={handleSubmit}>\r\n                    <Form.Group>\r\n                        <Form.Label>Select node to delete</Form.Label>\r\n                        <Form.Control as=\"select\" defaultValue={-1} onChange={handleSelectChange}>\r\n                            <option disabled value={-1} key={-1}>Select a node</option>\r\n                            {neuronOptions}\r\n                        </Form.Control>\r\n                    </Form.Group>\r\n                    <Button variant=\"secondary\" onClick={handleClose}>\r\n                        Close\r\n            </Button> {' '}\r\n                    <Button type=\"submit\" variant=\"danger\">\r\n                        Delete neuron\r\n            </Button>\r\n                </Form>\r\n            </Modal.Body>\r\n        </Modal>\r\n    )\r\n}\r\nexport default DeleteNodeForm;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useReducer, useState } from 'react';\r\nimport { allRulesValid } from \"../../utils/helpers\";\r\n\r\nconst DeleteNodeForm = ({ showDeleteAllModal, handleCloseDeleteAllModal, handleDeleteAll, handleError,}) => {\r\n    const [neuronId, setNeuronId] = useState('');\r\n    const handleClose = () => {\r\n        handleCloseDeleteAllModal();\r\n    };\r\n\r\n    function handleSubmit(event) {\r\n        event.preventDefault();\r\n        handleClose();\r\n        setTimeout(() => {\r\n            setNeuronId('');\r\n        }, 3000);\r\n        \r\n        handleDeleteAll();\r\n    }\r\n    \r\n\r\n    return (\r\n        <Modal show={showDeleteAllModal} onHide={handleClose}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Clear All</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Form onSubmit={handleSubmit}>                   \r\n                    <Form.Group>\r\n                        <Form.Label>Are you sure you want to delete all elements?</Form.Label>\r\n                    </Form.Group>\r\n                    <Button type=\"submit\" variant=\"danger\">\r\n                            YES\r\n                    </Button>\r\n                    <Button variant=\"secondary\" onClick={handleClose}>\r\n                            NO\r\n                    </Button> {' '}\r\n            \r\n                </Form>\r\n            </Modal.Body>\r\n        </Modal>\r\n    )\r\n}\r\nexport default DeleteNodeForm;","import { Button, Form, Modal } from 'react-bootstrap';\r\nimport { useReducer, useState } from 'react';\r\nimport { SynapseRulesValid } from \"../../utils/helpers\";\r\n\r\nconst DeleteSynapseForm = ({ showDeleteSynapseModal, handleCloseDeleteSynapseModal, handleDeleteSynapse, handleError, setNeurons, isClickedSynapse,\r\n    srcID, dstID}) => {\r\n    const handleClose = () => {      \r\n        handleCloseDeleteSynapseModal();\r\n    };\r\n\r\n    function handleSubmit(event) {\r\n        event.preventDefault();\r\n        handleClose();\r\n        setTimeout(() => {\r\n        }, 3000);\r\n\r\n        setNeurons(draft => {\r\n            var weightsDict = {...draft[srcID].outWeights};\r\n            weightsDict[dstID] = 1;\r\n            draft[srcID].outWeights = weightsDict;\r\n            handleDeleteSynapse(srcID, dstID);\r\n            });     \r\n      \r\n    }\r\n    \r\n    if (isClickedSynapse){\r\n        return (\r\n            <Modal show={showDeleteSynapseModal} onHide={handleClose}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Delete Synapse</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <Form onSubmit={handleSubmit}>                   \r\n                        <Form.Group>\r\n                            <Form.Label>Are you sure you want to delete this synapse with source <b>{srcID}</b> and destination <b>{dstID}</b>?</Form.Label>\r\n                        </Form.Group>\r\n                        <Button type=\"submit\" variant=\"danger\">\r\n                                YES\r\n                        </Button>\r\n                        <Button variant=\"secondary\" onClick={handleClose}>\r\n                                NO\r\n                        </Button> {' '}\r\n                \r\n                    </Form>\r\n                </Modal.Body>\r\n            </Modal>\r\n        )\r\n    }\r\n\r\n    else{\r\n        return (\r\n            <Modal show={showDeleteSynapseModal} onHide={handleClose}>\r\n             <Modal.Header closeButton>\r\n                    <Modal.Title>Delete Clicked Synapse</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <Form onSubmit={handleSubmit} data-testid=\"edit-node-form\">\r\n                        <Form.Group>       \r\n                                         \r\n                            <Form.Label><b>NO SELECTED SYNAPSE! Please click a synapse to delete.</b></Form.Label>\r\n                        </Form.Group>\r\n                    </Form>            \r\n                </Modal.Body>\r\n            </Modal>\r\n        )\r\n    }\r\n    \r\n}\r\nexport default DeleteSynapseForm;","import { Table, Modal } from \"react-bootstrap\"\r\nimport './ChoiceHistory.css';\r\nconst ChoiceHistory = ({time,showChoiceHistoryModal,handleCloseHoiceHistoryModal}) =>{\r\n    var getLatestState = JSON.parse(localStorage.getItem(time-1+\"sec\"));\r\n    var neuronIds = <td>There are no neurons</td>;\r\n    if(getLatestState){\r\n        neuronIds = Object.keys(getLatestState).map((neuron)=>(\r\n            <th className=\"choice-history-header\" key={neuron}>{`${(neuron.includes('-'))? neuron.substr(0, neuron.indexOf('-')) : neuron}`}</th>)\r\n        )\r\n    }\r\n\r\n    var neuronRows = [];\r\n    \r\n    for(var i = 0; i<time; i++){\r\n        var neuronCells=[];\r\n        neuronCells.push(<td className=\"time\"> {i} </td>);\r\n        var state = JSON.parse(localStorage.getItem(i+\"sec\"));\r\n        for(var k in state){\r\n            if(state[k].chosenRule){\r\n                neuronCells.push(TableCell(state[k].chosenRule.replace(/->/g, \"\")));\r\n            }else if(state[k].isOutput){\r\n                neuronCells.push(TableCell(`${(typeof state[k].bitstring === 'string') ? state[k].bitstring.replace(/\\[object Object\\]/g,'') : ''}`));\r\n            }else{\r\n                neuronCells.push(TableCell(\"No applicable rule.\"));\r\n            }\r\n        }\r\n        neuronRows.push(TableRow(neuronCells, i));\r\n        neuronCells = []\r\n    }\r\n    return(\r\n        <Modal show={showChoiceHistoryModal} \r\n        onHide={handleCloseHoiceHistoryModal} \r\n        className=\"custom-choice-history-modal\"\r\n        size=\"lg\"\r\n        >\r\n                <Table className=\"choicehistory\" striped bordered hover data-testid=\"choice-history-table\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th className=\"headtime\">Time</th>\r\n                            {neuronIds}\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {neuronRows}\r\n                    </tbody>\r\n                </Table>\r\n        </Modal>\r\n    )\r\n};\r\n\r\nconst TableCell = (content) =>{\r\n    return(\r\n        <td>\r\n            {content}\r\n        </td>\r\n    )\r\n};\r\n\r\nconst TableRow = (content,i)=>{\r\n    return (\r\n        <tr key={\"time-\"+i}>\r\n            {content}\r\n        </tr>\r\n    )\r\n}\r\n\r\nexport default ChoiceHistory;","import { useEffect, useState } from \"react\"\r\nimport { Prompt } from \"react-router-dom\";\r\n\r\nconst useUnsavedChanges = () =>{\r\n    const [isDirty, setDirty] = useState(false);\r\n    const message = \"Are you sure you want to exit without saving your system?\"\r\n    useEffect(()=>{\r\n        // function handleUnsavedChanges (){\r\n        //     console.log(\"isDirty:\" + isDirty);\r\n        // }\r\n        window.onbeforeunload = isDirty && (() => message);\r\n\r\n        //window.addEventListener(\"beforeunload\", handleUnsavedChanges);\r\n        return () => {\r\n            //window.removeEventListener(\"beforeunload\", handleUnsavedChanges);\r\n            window.onbeforeunload = null;\r\n        }\r\n    },[isDirty]);\r\n    const routerPrompt = <Prompt when={isDirty} message={message} />\r\n    return [routerPrompt, ()=>setDirty(true), ()=>setDirty(false)];\r\n}\r\nexport default useUnsavedChanges;","\r\nimport React, { useReducer, useEffect } from \"react\";\r\nimport JoyRide, { ACTIONS, EVENTS, STATUS } from \"react-joyride\";\r\n\r\n\r\n// Tour steps\r\nconst TOUR_STEPS = [\r\n  {\r\n    target: \".websnapse-title\",\r\n    title:\"Welcome to WebSnapse!\",\r\n    content: \"This is a visual simulator to aid in the creation and simulation of SN P systems.\",\r\n    placement:'center',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  /*{\r\n      target: \"#dropdown-basic\",\r\n      title: \"Node Actions\",\r\n      content: \"Here we can find several actions you can do to create your SN P system.\",\r\n      placement: 'right',\r\n      offset: 30,\r\n      disableBeacon: true,\r\n      disableOverlayClose: true,\r\n      floaterProps: {\r\n        disableAnimation: true,\r\n      }\r\n  },*/\r\n  {\r\n    target:\"#new-node-btn\",\r\n    title: \"New Node\",\r\n    content: \"You can create a new neuron here. You will then be prompted to give it a label name, rules and the number of spikes the neuron should initially contain.\",\r\n    placement: 'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  ///(a+)(\\+*\\**)\\/(a+)->(a+);([0-9]+)/\r\n  {\r\n    target:\"#new-node-btn\",\r\n    title:\"Creating Rules\",\r\n    content:\"When writing rules, it should follow the format E/c->p;d, where E follows the regular expression (na)(\\+*\\**) with n equal to the number of spikes required, c is na with c equal to the number of spikes to be consumed, p is na with c equal to the number of spikes to be produced and d equal to the delay. If creating a forgetting rule, set p to 0. Example: 2a(a)+/2a->0;0\",\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#new-input-btn\",\r\n    title: \"New Input Node\",\r\n    content: \"You can also create input neurons to send spikes to connected neurons in your system. Input neurons have spike trains made up of numbers separated by commas, with each representing the number of spikes the input neuron sends at the given time.\",\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#new-output-btn\",\r\n    title: \"New Output Node\",\r\n    content: \"You can also create output neurons to receive the output of your system in the form of a spike train (string) composed of numbers separated by commas, with each representing the number of spikes the output neuron receives at the given time.\",\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  }, \r\n  {\r\n    target:\"#del-node-btn\",\r\n    title: \"Delete Node\",\r\n    content:\"You can delete a neuron by choosing the neuron ID of the neuron you would like to delete. The neurons are ordered from oldest to last added. Deleting a neuron will also delete the synapses connected to the neuron. You can choose to cancel or save the changes you made, which will be seen right after.\",\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#edit-node-btn\",\r\n    title: \"Edit Regular Node\",\r\n    content:\"You can edit a neuron by choosing the neuron ID of the neuron you would like to edit. The neurons are ordered from oldest to last added. You can edit the rules and spikes of the neuron. You can choose to cancel or save the changes you made, which will be seen right after.\",\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#edit-inp-node-btn\",\r\n    title: \"Edit Input Node\",\r\n    content:\"You can edit an input neuron by choosing the neuron ID of the neuron you would like to edit. The neurons are ordered from oldest to last added. You can edit the spike train/bitstring of the neuron. You can choose to cancel or save the changes you made, which will be seen right after.\",\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n \r\n  {\r\n    target:\"#edit-syn-btn\",\r\n    title: \"Edit Synapse\",\r\n    content:\"You can edit a synapse by first clicking the synapse you want to edit. You can edit the weight of the selected synapse. You can choose to cancel or save the changes you made, which will be seen right after.\",\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#del-syn-btn\",\r\n    title: \"Delete Synapse\",\r\n    content:\"You can delete a synapse by first clicking the synapse you want to delete. You can choose to cancel or apply the deletion, which will be seen right after.\",\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#clear-all-btn\",\r\n    title: \"Clear All\",\r\n    content:\"You can clear your workspace and delete all elements by clicking this button. You can choose to cancel or apply the deletion, which will be seen right after.\",\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  \r\n  {\r\n    target:\".__________cytoscape_container\",\r\n    title: \"The Workspace\",\r\n    content:\"After adding a neuron, you will be able to see a visual representation here.  Inside each neuron, you will find the number of spikes the neuron has at the top, and its rules at the center. Below the neuron, you will find the current delay timer before the neuron spikes. By default, this is set to 0 and a neuron is set to spike at -1. \",\r\n    placement:'bottom-start',\r\n    offset:-400,\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\".__________cytoscape_container\",\r\n    title:\"Creating Edges\",\r\n    content:\"To create s or edges,  hover over the source node or neuron then a grey circle will appear and you can drag that to see a directed arrow that you can connect to your desired next node or neuron. \",\r\n    placement:'bottom-start',\r\n    offset:-400,\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n\r\n  },\r\n  {\r\n    target:\".snapse-controls\",\r\n    title:\"Starting the Simulation\",\r\n    content:\"Now it's time for simulations! You can simulate the system one step at a time by using the forward button. You can use the backward button to revert the system to the previous timestep.\",\r\n    placement:'bottom',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\".snapse-controls\",\r\n    title:\"Starting the Simulation\",\r\n    content:\"You can also simulate the system continuously by clicking the play button. It will then proceed to go step-by-step at default 3 second intervals until the simulation is paused or the system halts.\",\r\n    placement:'bottom',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#speed-slider\",\r\n    title:\"Simulation Speed Slider\",\r\n    content:\"You can change the speed of the continuous simulation through this slider. Drag the slider thumb to the left to slow the simulation down. Drag it to the right to speed the simulation up. Click 'Reset to 1x' to reset to default speed (3 second intervals).\",\r\n    placement:'bottom',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#res-btn\",\r\n    title:\"Restart Simulation\",\r\n    content:\"Click this button to restart your simulation from the top (timestep = 0).\",\r\n    placement:'bottom',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#formGridCheckbox\",\r\n    title:\"Pseudorandom or Guided Mode\",\r\n    content:\"If your system contains points of non-determinism, or rather, if a neuron can execute more than one rule at a time, you can choose to set the simulation to pseudorandom or guided mode. When using pseudorandom mode, the system chooses what rule to execute. When using guided mode, you will be prompted to choose which rule the neuron should follow for that timestep. \",\r\n    placement:'bottom',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  }, \r\n  {\r\n    target:\"#react-burger-menu-btn\",\r\n    title:\"Menu Actions\",\r\n    content:\"In this menu, you will find other actions such as saving/loading files, viewing the choice history and some sample systems.\",\r\n    placement:'right',\r\n    offset: 390,\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#custom-file\",\r\n    title: \"Loading Files\",\r\n    content:\"You can open pre-made or saved SNP Systems files in XML format.\",\r\n    offset: 45,\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  }, \r\n  {\r\n    target:\"#save-btn\",\r\n    title: \"Saving Systems\",\r\n    content:\"You can also save the current system you are working on. It will create an XML file.\",\r\n    offset: 160,\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#choice-history-btn\",\r\n    title:\"Choice History\",\r\n    content:\"Here you can view a table containing the rules each neuron applied per timestep.\",\r\n    offset: 90,\r\n    placement: 'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target:\"#file-dropdown\",\r\n    title:\"Download Samples\",\r\n    content:\"Lastly, you can download some of the sample SN P systems prepared here to start you off!\",\r\n    offset: 65,\r\n    placement:'right',\r\n    disableBeacon: true,\r\n    disableOverlayClose: true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  },\r\n  {\r\n    target: \".websnapse-title\",\r\n    title:\"Get Started\",\r\n    content:\"And that's the end of the tutorial! Enjoy creating and simulating your own SN P systems!\",\r\n    placement:'center',\r\n    disableBeacon: true,\r\n    disableBeacon:true,\r\n    floaterProps: {\r\n      disableAnimation: true,\r\n    }\r\n  }\r\n];\r\n\r\n// Initial state for the tour component\r\nconst INITIAL_STATE = {\r\n  key: new Date(), // This field makes the tour to re-render when we restart the tour\r\n  run: false,\r\n  continuous: true, // Show next button\r\n  loading: false,\r\n  stepIndex: 0, // Make the component controlled\r\n  steps: TOUR_STEPS\r\n};\r\n\r\n\r\n// Reducer will manage updating the local state\r\nconst reducer = (state = INITIAL_STATE, action) => {\r\n  switch (action.type) {\r\n    // start the tour\r\n    case \"START\":\r\n      return { ...state, run: true };\r\n    // Reset to 0th step\r\n    case \"RESET\":\r\n      return { ...state, stepIndex: 0 };\r\n    // Stop the tour\r\n    case \"STOP\":\r\n      return { ...state, run: false };\r\n    // Update the steps for next / back button click\r\n    case \"NEXT_OR_PREV\":\r\n      return { ...state, ...action.payload };\r\n    // Restart the tour - reset go to 1st step, restart create new tour\r\n    case \"RESTART\":\r\n      return {\r\n        ...state,\r\n        stepIndex: 0,\r\n        run: true,\r\n        loading: false,\r\n        key: new Date()\r\n      };\r\n    default:\r\n      return state;\r\n  } \r\n};\r\n// styles\r\n\r\nconst styles ={\r\n  beaconInner: {\r\n    backgroundColor: '#786fa6'\r\n  },\r\n  tooltip:{\r\n    backgroundColor: '#fff',\r\n    textColor: '#333',\r\n    fontSize: 14\r\n  },\r\n  tooltipContainer: {\r\n    textAlign: \"center\"\r\n  },\r\n  tooltipTitle: {\r\n    fontSize: 17,\r\n    margin: '0 0 0 0'\r\n  },\r\n  buttonNext: {\r\n    backgroundColor: '#786fa6'\r\n  },\r\n  buttonBack: {\r\n    color: '#786fa6'\r\n  },\r\n  buttonSkip:{\r\n    color:'#786fa6'\r\n  },\r\n  overlay:{\r\n    backgroundColor: 'rgba(0,0,0, 0.7)',\r\n    mixBlendMode: 'multiply'\r\n  },\r\n  spotlightLegacy:{\r\n    boxShadow: `0 0 10 5 rgba(0,0,0, 0.5), 0 0 15px rgba(0, 0, 0, 0.3)`\r\n  },\r\n  floater: {\r\n    arrow: {\r\n      color: '#fff',\r\n    },\r\n    tooltip: {\r\n      zIndex: 100,\r\n    },\r\n  }\r\n}\r\n\r\n// Tour component\r\nconst Tour = ({handleShowDropdownBasic, handleCloseDropdownBasic, handleShowSideBarMenu, handleCloseSideBarMenu, restartTutorial, handleFalseRestartTutorial}) => {\r\n  // Tour state is the state which control the JoyRide component\r\n  const [tourState, dispatch] = useReducer(reducer, INITIAL_STATE);\r\n\r\n  useEffect(() => {\r\n    // Auto start the tour if the tour is not viewed before\r\n    if (!localStorage.getItem(\"tour\")) {\r\n      dispatch({ type: \"START\" });\r\n    }\r\n  }, []);\r\n\r\n  // Set once tour is viewed, skipped or closed\r\n  const setTourViewed = () => {\r\n    localStorage.setItem(\"tour\", \"1\");\r\n  };\r\n\r\n  const callback = data => {\r\n    const { action, index, type, status } = data;\r\n\r\n    if (\r\n      // If close button clicked, then close the tour\r\n      action === ACTIONS.CLOSE ||\r\n      // If skipped or end tour, then close the tour\r\n      (status === STATUS.SKIPPED && tourState.run) ||\r\n      status === STATUS.FINISHED\r\n    ) {\r\n      dispatch({ type: \"STOP\" });\r\n    } else if (type === EVENTS.STEP_AFTER || type === EVENTS.TARGET_NOT_FOUND) {\r\n      // Check whether next or back button click and update the step.\r\n      dispatch({\r\n        type: \"NEXT_OR_PREV\",\r\n        payload: { stepIndex: index + (action === ACTIONS.PREV ? -1 : 1) }\r\n      });\r\n    } else if (index === 0){\r\n      handleCloseSideBarMenu();\r\n    }else if (index === 1) {\r\n      handleShowDropdownBasic();\r\n      handleFalseRestartTutorial();\r\n    } else if (index === 1 && action === ACTIONS.PREV){\r\n      handleCloseDropdownBasic();\r\n    } else if (index === 7){\r\n      handleCloseDropdownBasic();\r\n    } else if (index === 12){\r\n      handleShowSideBarMenu();\r\n    } else if (index === 17){\r\n      handleCloseSideBarMenu();\r\n      setTourViewed();\r\n    }\r\n  };\r\n\r\n  const startTour = () => {\r\n    // Start the tour manually\r\n    dispatch({ type: \"RESTART\" });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if(restartTutorial == true){\r\n      startTour();\r\n    }\r\n  }, [restartTutorial]);\r\n\r\n  return (\r\n    <>\r\n      <JoyRide \r\n      {...tourState}\r\n      // Callback will pass all the actions\r\n      callback={callback}\r\n      scrollToFirstStep={true}\r\n      showSkipButton={true} \r\n      hideBackButton={false} \r\n      showProgress={true}\r\n      continuous={true}\r\n      styles={styles}\r\n      locale={{\r\n        last: \"End tour\",\r\n        skip: \"Skip tour\"\r\n      }} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Tour;","import './scss/custom.scss';\r\nimport './App.css';\r\nimport Slider from '@mui/material/Slider';\r\nimport { slide as Menu } from 'react-burger-menu';\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { useImmer } from \"use-immer\";\r\nimport { Button, Container, Alert, Row, Col, Form, OverlayTrigger, Tooltip, Dropdown, DropdownButton } from 'react-bootstrap';\r\nimport { ArrowCounterclockwise,PlayFill, PauseFill, SkipForwardFill, SkipBackwardFill, QuestionCircle, ClockFill, ClockHistory, PlusSquare, Save2, Sliders,WindowSidebar, XCircle, PencilSquare, BoxArrowRight, BoxArrowInRight, Eye} from 'react-bootstrap-icons';\r\nimport styled, { css, keyframes } from 'styled-components'\r\nimport Snapse from \"./components/Snapse/Snapse\";\r\nimport shortid from 'shortid';\r\nimport { step, backStep, parseRule, null_step } from \"./utils/automata\";\r\nimport ElementPopUp from './components/forms/ElementPopUp';\r\nimport ChooseRuleForm from './components/forms/ChooseRuleForm';\r\nimport NewNodeForm from './components/forms/NewNodeForm';\r\nimport AddSynapseWeightForm from './components/forms/AddSynapseWeightForm';\r\nimport NewOutputNodeForm from './components/forms/NewOutputNodeForm';\r\nimport NewInputNodeForm from './components/forms/NewInputNodeForm';\r\nimport EditNodeForm from './components/forms/EditNodeForm';\r\nimport EditInputNodeForm from './components/forms/EditInputNodeForm';\r\nimport EditSynapseForm from './components/forms/EditSynapseForm';\r\nimport DeleteNodeForm from './components/forms/DeleteNodeForm';\r\nimport DeleteAllForm from './components/forms/DeleteAllForm';\r\nimport DeleteSynapseForm from './components/forms/DeleteSynapseForm';\r\nimport ChoiceHistory from './components/ChoiceHistory/ChoiceHistory';\r\nimport {splitRules} from \"./utils/helpers\";\r\nimport convert from 'xml-js';\r\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\";\r\nimport { saveAs } from 'file-saver';\r\nimport useUnsavedChanges from './components/useUnsavedChanges/useUnsavedChanges';\r\nimport { original } from 'immer';\r\nimport Tour from './components/Tour/Tour';\r\nimport { tabScrollButtonClasses } from '@mui/material';\r\n\r\nvar options = { compact: true, ignoreComment: true, spaces: 4, sanitize: false };\r\nvar progBarRate = 3;\r\nvar isClickedSynapse = false;\r\nvar isHover = true;\r\nvar srcDel = '';\r\nvar dstDel = '';\r\n\r\nfunction useKey(key, cb) {\r\n  const isFocus = useRef(false);\r\n  const callbackRef = useRef(cb);\r\n\r\n  const inputs = document.getElementsByTagName('input');\r\n\r\n  // if user is typing in input elements, isFocus = true, and keybinds should not work\r\n  useEffect(() => {\r\n    for (let input of inputs) {\r\n      input.addEventListener('focusin', () => { isFocus.current = true; console.log(\"fOCUS ON ME\"); });\r\n      input.addEventListener('input', () => { isFocus.current = true; console.log(\"fOCUS ON ME 2\"); });\r\n      input.addEventListener('focus', () => { isFocus.current = true; console.log(\"fOCUS ON ME 3\"); }, true);\r\n      input.addEventListener('focusout', () => { isFocus.current = false });\r\n    }\r\n  })\r\n\r\n  useEffect(() => {\r\n    callbackRef.current = cb;\r\n  });\r\n  useEffect(() => {\r\n    function debounced(delay, fn) {\r\n      let timerId;\r\n      return function (...args) {\r\n        if (timerId) {\r\n          clearTimeout(timerId);\r\n        }\r\n        timerId = setTimeout(() => {\r\n          fn(...args);\r\n          timerId = null;\r\n        }, delay);\r\n      }\r\n    }\r\n\r\n    function handleKeyDown(event) {\r\n      console.log(`isFocus ${isFocus.current}`);\r\n      if (event.code === key && isFocus.current == false) {\r\n        console.log(`handleKeyDown isFocus: ${isFocus.current}`)\r\n        //event.preventDefault();\r\n        console.log(\"Key pressed: \" + event.code);\r\n        callbackRef.current(event);\r\n      }\r\n    }\r\n\r\n    document.addEventListener(\"keydown\", (event) => { if (event.code === \"Space\" && isFocus == false) { event.preventDefault(); } });\r\n    document.addEventListener(\"keydown\", (debounced(300, handleKeyDown)));\r\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\r\n  }, [key]);\r\n}\r\n\r\nfunction App() {\r\n  const [neurons, setNeurons] = useImmer((window.localStorage.getItem('originalNeurons') != null) ? JSON.parse(window.localStorage.getItem('originalNeurons')) : {\r\n    n1: {\r\n      id: \"n1\",\r\n      position: { x: 50, y: 50 },\r\n      rules: 'a+/a->a;2',\r\n      startingSpikes: 1,\r\n      delay: 0,\r\n      spikes: 1,\r\n      isOutput: false,\r\n      isInput: false,\r\n      out: ['n2'],\r\n      outWeights: {'n2': 1}\r\n    },\r\n    n2: {\r\n      id: \"n2\",\r\n      position: { x: 200, y: 50 },\r\n      rules: 'a/a->a;1',\r\n      startingSpikes: 0,\r\n      delay: 0,\r\n      spikes: 0,\r\n      isOutput: false,\r\n      isInput: false,\r\n      out: ['n3'],\r\n      outWeights: {'n3': 1}\r\n    },\r\n    n3: {\r\n      id: \"n3\",\r\n      position: { x: 400, y: 50 },\r\n      rules: 'a/a->a;0',\r\n      startingSpikes: 1,\r\n      delay: 0,\r\n      spikes: 1,\r\n      isOutput: false,\r\n      isInput: false,\r\n      out: [\"n4\"],\r\n      outWeights: {'n4': 1}\r\n    },\r\n    n4: {\r\n      id: \"n4\",\r\n      position: { x: 400, y: 200 },\r\n      isOutput: true,\r\n      isInput: false,\r\n      spikes: 0,\r\n      bitstring: ' '\r\n    }\r\n  });\r\n\r\n  let btn;\r\n\r\n  const [srce, setSrce] = useState('');\r\n  const [dest, setDest] = useState('');\r\n  const [time, setTime] = useState(0);\r\n  const [nodeID, setNeuronID] = useState('');\r\n  const [nodeType, setNeuronType] = useState('');\r\n  const [nodeSRules, setNeuronSRules] = useState('');\r\n  const [nodeFRules, setNeuronFRules] = useState('');\r\n  const [nodeSpikes, setNeuronSpikes] = useState('');\r\n  const [nodeBitstring, setNeuronBitstring] = useState('');\r\n  const [weight_main, setWeight] = useState(1);\r\n  const [isPressedDel, setIsPressedDel] = useState(false);\r\n  const [isRandom, setIsRandom] = useState(true);\r\n  const [fileName, setFileName] = useState('');\r\n  const [Prompt, setDirty, setPristine] = useUnsavedChanges();\r\n  // Modal Booleans\r\n  const [showElementPopup, setShowElementPopup] = useState(false);\r\n  const [showAddWeightModal, setShowAddWeightModal] = useState(false);\r\n  const [showNewNodeModal, setShowNewNodeModal] = useState(false);\r\n  const [showNewOutputModal, setShowNewOutputModal] = useState(false);\r\n  const [showNewInputModal, setShowNewInputModal] = useState(false);\r\n  const [showChooseRuleModal, setShowChooseRuleModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [showEditInputModal, setShowEditInputModal] = useState(false);\r\n  const [showEditSynapseModal, setShowEditSynapseModal] = useState(false);\r\n  const [showChoiceHistoryModal, setShowChoiceHistoryModal] = useState(false);\r\n  const [showDeleteAllModal, setShowDeleteAllModal] = useState(false);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [showDeleteSynapseModal, setShowDeleteSynapseModal] = useState(false);\r\n  // Menu Booleans \r\n  const [showDropdownBasic, setShowDropdownBasic] = useState(false);\r\n  const [showSideBarMenu, setShowSideBarMenu] = useState(false);\r\n  // Simulation Booleans\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [hasEnded, setHasEnded] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [pBar, setPBar] = useState(0);\r\n  const headless = process.env.NODE_ENV === 'test'\r\n  const [sld_value, setSldValue] = useState(1);\r\n  const handleSldChange = (event, newValue) => {\r\n    if (isPlaying){\r\n      setIsPlaying(false);\r\n    }\r\n    setSldValue(newValue);\r\n    var sim_spd = 3000/newValue;\r\n    progBarRate = sim_spd/1000;\r\n  }\r\n  const handleSldOver = () => console.log(\"slide over\");\r\n  const handleClose = () => setShowNewNodeModal(false)\r\n  const handleShow = () => setShowNewNodeModal(true)\r\n  const handleCloseElementPopup = () => setShowElementPopup(false);\r\n  const handleShowElementPopup = () => setShowElementPopup(true);  \r\n  const handleCloseAddWeightModal = () => setShowAddWeightModal(false);\r\n  const handleShowAddWeightModal = () => setShowAddWeightModal(true);  \r\n  const handleCloseNewOutputModal = () => setShowNewOutputModal(false);\r\n  const handleShowNewOutputModal = () => setShowNewOutputModal(true);\r\n  const handleCloseNewInputModal = () => setShowNewInputModal(false);\r\n  const handleShowNewInputModal = () => setShowNewInputModal(true);\r\n  const handleCloseEditModal = () => setShowEditModal(false);\r\n  const handleShowEditInputModal = () => setShowEditInputModal(true);\r\n  const handleCloseEditInputModal = () => setShowEditInputModal(false);\r\n  const handleCloseEditSynapseModal = () => setShowEditSynapseModal(false);\r\n  const handleShowEditSynapseModal = () => setShowEditSynapseModal(true);  \r\n  const handleShowEditModal = () => setShowEditModal(true);\r\n  const handleCloseDeleteAllModal = () => setShowDeleteAllModal(false);\r\n  const handleShowDeleteAllModal = () => setShowDeleteAllModal(true);\r\n  const handleCloseDeleteModal = () => setShowDeleteModal(false);\r\n  const handleShowDeleteModal = () => setShowDeleteModal(true);\r\n  const handleCloseDeleteSynapseModal = () => setShowDeleteSynapseModal(false);\r\n  const handleShowDeleteSynapseModal = () =>{ console.log(\"SHOW DELSYN\"); \r\n                setShowDeleteSynapseModal(true) }\r\n  const handleCloseChooseRuleModal = () => setShowChooseRuleModal(false);\r\n\r\n  const [mode,setMode]= useState('PSEUDORANDOM');\r\n  const handleSelect=(e)=>{\r\n    console.log(e);\r\n    setMode(e)\r\n  }\r\n  // Menu Handles\r\n  const handleShowDropdownBasic = () => setShowDropdownBasic(true);\r\n  const handleCloseDropdownBasic = () => setShowDropdownBasic(false);\r\n  const handleDropDownBasic = () => {setShowDropdownBasic(showDropdownBasic ? false:true)};\r\n  const handleShowSideBarMenu = () => setShowSideBarMenu(true);\r\n  const handleCloseSideBarMenu = () => setShowSideBarMenu(false);\r\n  const handleSideBarMenu = () => {setShowSideBarMenu(showSideBarMenu ? false:true)};\r\n\r\n  const [restartTutorial, setRestartTutorial] = useState(false);\r\n  const handleTrueRestartTutorial = () => setRestartTutorial(true);\r\n  const handleFalseRestartTutorial = () => setRestartTutorial(false);\r\n\r\n  const handleShowChoiceHistoryModal = () => {setShowChoiceHistoryModal(true); setShowSideBarMenu(false);}\r\n  const handleCloseHoiceHistoryModal = () => setShowChoiceHistoryModal(false);\r\n\r\n  const handleSimulationEnd = () => {\r\n    setHasEnded(true);\r\n    setIsPlaying(false);\r\n    console.log(\"alert from simulationEnd\");\r\n    alert(\"Simulation has ended.\");\r\n  }\r\n\r\n  const showError = (text) => {\r\n    setError(text);\r\n    setTimeout(() => {\r\n      setError(\"\");\r\n    }, 3000);\r\n  }\r\n  const handleSave = () => {\r\n    //Convert JSON Array to string.\r\n    var wrapper = { content: neurons };\r\n    //console.log(neurons);\r\n    var result = convert.json2xml(wrapper, options);\r\n    //console.log(wrapper);\r\n    var blob = new Blob([result], { type: \"text/xml;charset=utf-8\", });\r\n    saveAs(blob, Date().toString() + \"-Neurons.xmp\");\r\n    setPristine();\r\n  }\r\n  const handleLoad = (input) => {\r\n    let file = input.files[0];\r\n    setHasEnded(false);\r\n\r\n    if (file.type && file.type.indexOf('text/xml') === -1) {\r\n\r\n      showError(\"File is not a xml file\");\r\n      return;\r\n    }\r\n    const reader = new FileReader();\r\n    function nativeType(value) {\r\n      var nValue = Number(value);\r\n      if (!isNaN(nValue)) {\r\n        return nValue;\r\n      }\r\n      var bValue = value.toLowerCase();\r\n      if (bValue === 'true') {\r\n        return true;\r\n      } else if (bValue === 'false') {\r\n        return false;\r\n      }\r\n      return value;\r\n    }\r\n    var removeJsonTextAttribute = async function (value, parentElement) {\r\n      try {\r\n        const pOpKeys = Object.keys(parentElement._parent);\r\n        const keyNo = pOpKeys.length;\r\n        const keyName = pOpKeys[keyNo - 1];\r\n        const arrOfKey = parentElement._parent[keyName];\r\n        const arrOfKeyLen = arrOfKey.length;\r\n\r\n        if (arrOfKeyLen > 0) {\r\n          const arr = arrOfKey;\r\n          const arrIndex = arrOfKey.length - 1;\r\n          arr[arrIndex] = value;\r\n        } else if (keyName == \"out\") {\r\n          parentElement._parent[keyName] = [value];\r\n        } \r\n        else if (keyName == \"bitstring\") {\r\n          parentElement._parent[keyName] = value;\r\n        }\r\n        else {\r\n          parentElement._parent[keyName] = nativeType(value);\r\n        }\r\n\r\n      } catch (e) { }\r\n    }\r\n    reader.addEventListener('load', async (event) => {\r\n      var options = {\r\n        compact: true,\r\n        trim: true,\r\n        ignoreDeclaration: true,\r\n        ignoreInstruction: true,\r\n        ignoreAttributes: true,\r\n        ignoreComment: true,\r\n        ignoreCdata: true,\r\n        ignoreDoctype: true,\r\n        textFn: removeJsonTextAttribute\r\n      };\r\n      var result = await convert.xml2js(event.target.result, options);\r\n      await setNeurons(draft => draft = result.content);\r\n      await setNeurons(draft => {\r\n        for (var k in draft) {\r\n          if (draft[k].bitstring) {\r\n            // console.log(\"loaded string\", draft[k].bitstring);\r\n            // draft[k].bitstring = \" \";\r\n          }\r\n          if(!draft[k].isOutput && !draft[k].out){\r\n            draft[k].out = [];\r\n          }\r\n          \r\n        }\r\n      })\r\n      window.localStorage.setItem('originalNeurons', JSON.stringify(result.content));\r\n      setFileName(file.name);\r\n    });\r\n    reader.readAsText(file);\r\n    setTime(0);\r\n  } \r\n \r\n  /// add weight argument\r\n  /// make array of objects (neuron ID, weight)\r\n  const onEdgeCreate = (src, dst) => {\r\n    setSrce(src); // srce = src\r\n    setDest(dst); // dest = dst\r\n    console.log(\"newEdge\", src, dst);\r\n    \r\n    setNeurons(draft => {\r\n      var outCopy = [...draft[src].out];\r\n      var weightsDict = {...draft[src].outWeights};\r\n      var currWeight = parseInt(weightsDict[dst]);\r\n\r\n      if (outCopy.includes(dst)){\r\n        handleAddWeight(src, dst, currWeight + 1, 1);\r\n      }\r\n      \r\n      else{\r\n        handleShowAddWeightModal();\r\n        \r\n        // outCopy.push(dst)\r\n        // console.log(outCopy);\r\n        // draft[src].out = outCopy;\r\n      }    \r\n    \r\n     \r\n    });\r\n\r\n    setDirty(true);\r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n\r\n    \r\n  }\r\n\r\n  async function handleEditSynapse(src_id, dst_id, new_weight) {   \r\n    await setNeurons(draft => {\r\n      console.log(\"NEW WEIGHT\", new_weight);\r\n      \r\n      var weightsDict = {...draft[src_id].outWeights};\r\n      weightsDict[dst_id] = new_weight;\r\n      draft[src_id].outWeights = weightsDict;      \r\n\r\n    });\r\n    setDirty(true);   \r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n    handleNullForward();\r\n   \r\n  }\r\n\r\n  async function handleDeleteSynapse(srcID, dstID) {\r\n    await setNeurons(draft => {\r\n      var origoutArr = [...draft[srcID].out];\r\n      // console.log(\"OLD OUT DETAILS \", origoutArr);\r\n\r\n      var weightsDict = {...draft[srcID].outWeights};\r\n      // console.log(\"WEIGHTS DETAILS\", weightsDict);           \r\n      \r\n      if (weightsDict[dstID] > 1){\r\n        draft[srcID].outWeights[dstID] = weightsDict[dstID] - 1;\r\n      }\r\n\r\n      else{\r\n        // remove dstID in out\r\n        let arr = draft[srcID].out.filter(function (item) {\r\n          return item !== dstID\r\n        });\r\n        draft[srcID].out = arr;      \r\n        \r\n        // remove dstID in outWeights\r\n        delete draft[srcID].outWeights[dstID];\r\n      }\r\n    \r\n      var newoutArr = [...draft[srcID].out];\r\n      console.log(\"NEW OUT DETAILS \", newoutArr);\r\n  \r\n      var newweightsDict = {...draft[srcID].outWeights};\r\n      console.log(\"WEIGHTS DETAILS\", newweightsDict);\r\n\r\n      console.log(\"DELETED SYNAPSE\");\r\n    });\r\n    setDirty(true);\r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n\r\n    handleNullForward();\r\n   \r\n  }\r\n\r\n  async function handleAddWeight(src, dst, weight, flag) {\r\n    await setNeurons(draft => {\r\n      var weightsDict = {...draft[src].outWeights};\r\n      weightsDict[dst] = weight;\r\n      draft[src].outWeights = weightsDict;\r\n      console.log(\"WEIGHTS\", weightsDict);\r\n\r\n      if (flag == 0){\r\n        console.log(\"FLAG IS ZERO\");\r\n        var outCopy = [...draft[src].out];\r\n        outCopy.push(dst)\r\n        draft[src].out = outCopy;\r\n      }\r\n\r\n    });\r\n    setSrce('');\r\n    setDest('');\r\n    setDirty(true);\r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n\r\n    handleNullForward();\r\n\r\n   \r\n   \r\n  }\r\n\r\n  const handleNewPosition = async (position, id) => {\r\n    setNeurons(draft => {\r\n      draft[id].position = position;\r\n    });\r\n    setDirty(true);\r\n    handleNullForward();\r\n\r\n  }\r\n  async function handleNewNode(newNeuron) {\r\n    await setNeurons(draft => {\r\n      draft[newNeuron.id] = newNeuron;\r\n    })\r\n    setDirty(true);\r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n    handleNullForward();\r\n   \r\n\r\n  }\r\n  async function handleNewOutput(newOutput) {\r\n    await setNeurons(draft => {\r\n      draft[newOutput.id] = newOutput;\r\n    });\r\n    setDirty(true);\r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n    handleNullForward();\r\n   \r\n  }\r\n\r\n  async function handleNewInput(newInput) {\r\n    await setNeurons(draft => {\r\n      draft[newInput.id] = newInput;\r\n    });\r\n    setDirty(true);\r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n    handleNullForward();\r\n   \r\n  }\r\n\r\n  async function handleShowDeleteAll() {\r\n    handleShowDeleteAllModal()\r\n  }\r\n\r\n  async function handleEditNode(id, rules, spikes) {\r\n    //console.log(\"handleEditNode\")\r\n    await setNeurons(draft => {\r\n      draft[id].startingSpikes = spikes;\r\n      draft[id].spikes = spikes;\r\n      draft[id].rules = rules;\r\n    });\r\n    setDirty(true);\r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n    handleNullForward();\r\n   \r\n  }\r\n\r\n  async function handleEditInputNode(id,bitstring) {\r\n    //console.log(\"handleEditNode\")\r\n    await setNeurons(draft => {      \r\n      draft[id].bitstring = bitstring;\r\n    });\r\n    setDirty(true);\r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n    handleNullForward();\r\n   \r\n  }\r\n\r\n\r\n\r\n  /// list all neurons connected to a neuron (delete ID to delete connected synapse)\r\n  async function handleDeleteNode(neuronId) {\r\n    console.log(\"handleDeleteNode\", neuronId);\r\n    await setNeurons(draft => {\r\n      \r\n      for (var k in draft) {\r\n        //first delete edges connected to neuron\r\n        var neuron = draft[k];\r\n        if (!neuron.isOutput && neuron.out) {\r\n          //const neuronOutKeys = neuron.out;\r\n          let arr = neuron.out.filter(function (item) {\r\n            return item !== neuronId\r\n          });\r\n          draft[k].out = arr;\r\n        }\r\n      }\r\n      //delete neuron\r\n      delete draft[neuronId];\r\n      \r\n    })     \r\n\r\n    setDirty(true);    \r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n    handleNullForward();\r\n\r\n\r\n   \r\n  }\r\n\r\n  async function handleDeleteAll() {\r\n   \r\n    setNeurons(draft => {\r\n      for (var k in draft) {\r\n        delete draft[k];\r\n      }\r\n    });\r\n    setDirty(true);\r\n    console.log(\"ALL DELETED\", neurons);\r\n    window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n    handleNullForward();\r\n   \r\n  }\r\n\r\n  function setIsClickedSynapse(click_flag, srcID, dstID){\r\n    isClickedSynapse = click_flag;\r\n    srcDel = srcID;\r\n    dstDel = dstID;\r\n    let curr_weight;\r\n\r\n    if (isClickedSynapse){\r\n      setNeurons(draft => {\r\n        let weightsDict = {...draft[srcID].outWeights};\r\n        curr_weight = parseInt(weightsDict[dstID]);\r\n      });\r\n  \r\n      setWeight(curr_weight);\r\n    }\r\n\r\n    \r\n  }\r\n\r\n  function resetSlider(){\r\n    if (isPlaying){\r\n      setIsPlaying(false);\r\n    }\r\n    setSldValue(1)\r\n  }\r\n\r\n\r\n  function handlePlay() {\r\n    if (!hasEnded) {\r\n      console.log(`isPlaying before ${isPlaying}`);\r\n      setIsPlaying(p => !p);\r\n      console.log(`isPlaying after ${isPlaying}`);\r\n    } else {\r\n      alert(\"Simulation has ended.\");\r\n    }\r\n  }\r\n  const renderTooltip = (props) => (\r\n    <Tooltip id=\"button-tooltip\" {...props}>\r\n      Pseudorandom mode will allow the system to decide which rule will be executed. Guided mode will let you be the one to decide.\r\n    </Tooltip>\r\n  );\r\n  \r\n\r\n  const handleReset = () => {\r\n    if(time != 0){    \r\n      var currNeurons = JSON.parse(window.localStorage.getItem('originalNeurons'));\r\n\r\n      for (var k in currNeurons) {\r\n        var neuron = currNeurons[k];\r\n        if (!neuron.isOutput && !neuron.isInput) {\r\n            delete currNeurons[neuron.id].chosenRule;\r\n            delete currNeurons[neuron.id].currentRule;\r\n        }\r\n      }\r\n      window.localStorage.setItem('originalNeurons', JSON.stringify(currNeurons));\r\n  \r\n      setNeurons(draft => draft = JSON.parse(window.localStorage.getItem('originalNeurons')));\r\n      setTime(0);\r\n      setIsPlaying(false);\r\n      setHasEnded(false);\r\n      var tempNeurons = window.localStorage.getItem('originalNeurons');\r\n      \r\n      window.localStorage.clear();\r\n      window.localStorage.setItem('originalNeurons', tempNeurons);\r\n    }\r\n  }\r\n\r\n  const [guidedRules, setGuidedRules] = useState({});\r\n  const handleStartGuidedMode = async (rules) => {\r\n    await setGuidedRules(rules);\r\n    setShowChooseRuleModal(true);\r\n    if (setShowChooseRuleModal) {\r\n      setIsPlaying(false); //pauses the graph playing while choosing rule\r\n    }\r\n  }\r\n  const handleChosenRules = (data) => {\r\n    handleCloseChooseRuleModal();\r\n    setNeurons((draft) => {\r\n      for (var j in draft) {\r\n        for (var k in data) {\r\n          if (j == k) {\r\n            var [requires, grouped, symbol, consumes, produces, delay] = parseRule(data[k]);\r\n            draft[j].delay = delay\r\n            //console.log(data[k]);\r\n            draft[j].currentRule = data[k];\r\n            draft[j].chosenRule = data[k];\r\n          }\r\n        }\r\n      }\r\n    });\r\n    //setIsPlaying(true); // continue playing after choosing rule\r\n  }\r\n\r\n  const onNullForward = async () => {\r\n    if (time == 0) {\r\n      //copy\r\n      console.log(\"NULL_FORWARD\");\r\n      \r\n      window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n      \r\n    }\r\n  }\r\n\r\n  const onForward = async () => {\r\n    if (time == 0) {\r\n      //copy\r\n      console.log(\"FORWARD\");\r\n      console.log(\"Time is: \" + time);\r\n      window.localStorage.setItem('originalNeurons', JSON.stringify(JSON.parse(JSON.stringify(neurons))));\r\n      window.localStorage.setItem('shouldTimeStep', \"1\");\r\n      console.log(\"Original neurons on time = 1 \", window.localStorage.getItem('originalNeurons'));\r\n    }\r\n    if (!hasEnded) {\r\n      console.log(\"Time is: \" + time);\r\n      await setNeurons(neurons => step(neurons, time, isRandom, handleStartGuidedMode, handleSimulationEnd));\r\n      if(window.localStorage.getItem('shouldTimeStep') == \"1\"){\r\n        setTime(time => time + 1);\r\n      }\r\n      console.log(`Local storage space used: ${JSON.stringify(localStorage).length * 2}`);\r\n    } else {\r\n      alert(\"Simulation has ended.\");\r\n    }\r\n  }\r\n\r\n\r\n  const onBackward = async () => {\r\n    if (time > 1) {\r\n      var tempTime = time.valueOf();\r\n      setHasEnded(false);\r\n      await setNeurons(neurons => backStep(tempTime - 2));\r\n      await setTime(time => time - 1);\r\n\r\n    }\r\n    else if (time == 1) {\r\n      handleReset();\r\n    }\r\n\r\n  }\r\n  const neuronsRef = useRef(neurons)\r\n  neuronsRef.current = neurons\r\n  const onIntervalStepRef = useRef(onForward)\r\n  onIntervalStepRef.current = () => {\r\n    onForward();\r\n    setPBar(p => p + 1);\r\n  }\r\n  useEffect(() => {\r\n    var simu_speed = 3000/sld_value;\r\n    progBarRate = simu_speed/1000;\r\n    console.log(\"Simu speed\", simu_speed);\r\n    if (isPlaying) {\r\n      var interval = setInterval(() => {\r\n        onIntervalStepRef.current()\r\n      }, simu_speed) /// simulation speed\r\n    }\r\n    return () => clearInterval(interval);\r\n  }, [isPlaying, onIntervalStepRef])\r\n\r\n  useEffect(() => {\r\n    if (showChooseRuleModal) {\r\n      console.log(\"showChooseRuleModal is true\");\r\n    }\r\n  }, [])\r\n\r\n  // Key Bindings \r\n  function handleSpace() {\r\n    console.log(\"Space Pressed\");\r\n    setIsPlaying(p => !p);\r\n  }\r\n\r\n  function handleRightKey() {\r\n    console.log(\"Right Key Pressed\");\r\n    if (!hasEnded) {\r\n      onIntervalStepRef.current();\r\n    }\r\n  }\r\n\r\n  function handleLeftKey() {\r\n    console.log(\"Left Key Pressed\");\r\n    onBackward();\r\n  }\r\n\r\n  function handleDelBackspaceKey() {   \r\n    if (isClickedSynapse){\r\n      handleDeleteSynapse(srcDel, dstDel);\r\n    }\r\n\r\n    else{\r\n      console.log(\"No edge clicked.\");\r\n    }\r\n    console.log(\"Delete/Bspace Pressed\");\r\n  }\r\n\r\n  useKey(\"Space\", handleSpace);\r\n  useKey(\"ArrowLeft\", handleLeftKey);\r\n  useKey(\"ArrowRight\", handleRightKey);\r\n  useKey(\"Delete\", handleDelBackspaceKey);\r\n  useKey(\"Backspace\", handleDelBackspaceKey);\r\n  \r\n  /// handle backspace key for deleting neurons/synapses\r\n  function splitRules(rules){\r\n    const testRe = /([1-9]*)a\\(*([1-9]*)(a*)\\)*(\\+?|\\*?)\\/([1-9]*)a->([1-9]*)a;([0-9]+)/;\r\n    const forgetRe = /([1-9]*)a\\(*([1-9]*)(a*)\\)*(\\+?|\\*?)\\/([1-9]*)a->(0);(0)/;\r\n\r\n    var spikeRules = [];\r\n    var forgRules = [];\r\n\r\n    var splitRules = rules.split(\" \");\r\n    for (var i=0;i<splitRules.length;i++){\r\n        var testRes = testRe.exec(splitRules[i]);\r\n        var forgetRes = forgetRe.exec(splitRules[i]);\r\n\r\n        if (testRes){\r\n            spikeRules.push(splitRules[i]);\r\n        }\r\n\r\n        else if (forgetRes){\r\n            forgRules.push(splitRules[i]);\r\n        }\r\n          \r\n    }\r\n\r\n    return [spikeRules, forgRules];  \r\n    \r\n  }\r\n\r\n  function checkIsHover() {\r\n    //await setIsHover(isHover);\r\n    console.log(\"isHover is\", isHover);\r\n    return isHover;\r\n  }\r\n\r\n  function sliderThumbLabelFormat(value){\r\n      return `${value}x`;\r\n  }\r\n\r\n  function handleNullForward() {\r\n      document.getElementById(\"forwardBtn\").click();\r\n      document.getElementById(\"forwardBtn\").click();\r\n  }\r\n\r\n  return (\r\n    <Router>\r\n      <Tour handleShowDropdownBasic={handleShowDropdownBasic} handleCloseDropdownBasic={handleCloseDropdownBasic} handleShowSideBarMenu={handleShowSideBarMenu} handleCloseSideBarMenu={handleCloseSideBarMenu} restartTutorial={restartTutorial} handleFalseRestartTutorial={handleFalseRestartTutorial}/> \r\n      <Switch>\r\n        <Route path=\"/\">\r\n          <Container>\r\n            {error && <Alert variant=\"danger\">\r\n              {error}\r\n            </Alert>}\r\n            <Menu id=\"side-bar-menu\" isOpen={showSideBarMenu} onClick={handleSideBarMenu} disableCloseOnEsc disableOverlayClick noOverlay>\r\n\r\n              <Form>\r\n                <Form.File\r\n                  id=\"custom-file\"\r\n                  label={fileName ? fileName : \"Load file...\"}\r\n                  custom\r\n                  onChange={(e) => { handleLoad(e.target) }}\r\n                />\r\n              </Form>\r\n              <div>\r\n                <Button id=\"save-btn\" variant=\"primary\" disabled={time > 0 ? true : false} onClick={handleSave}><Save2 />{' '}Save</Button>\r\n              </div>\r\n              <div>\r\n                <Button id=\"choice-history-btn\" variant=\"primary\" onClick={handleShowChoiceHistoryModal}><ClockHistory />{' '}Choice History</Button>\r\n              </div>\r\n              <div>\r\n                <DropdownButton id=\"file-dropdown\" title=\"Download samples\">\r\n                  <Dropdown.Item href=\"./samples/ex1 - 3k+3 spiker.xmp\" download>Ex1 - 3k+3 Spiker</Dropdown.Item>\r\n                  <Dropdown.Item href=\"./samples/ex2 - bitadder.xmp\" download>Ex2 - Bitadder</Dropdown.Item>\r\n                  <Dropdown.Item href=\"./samples/ex3 - increasing comparator.xmp\" download>Ex3 - Increasing Comparator</Dropdown.Item>\r\n                  <Dropdown.Item href=\"./samples/ex4 - naturally even.xmp\" download>Ex4 - Naturally Even</Dropdown.Item>\r\n                  <Dropdown.Item href=\"./samples/ex5 - naturally greater one.xmp\" download>Ex5 - Naturally Greater Than One</Dropdown.Item>\r\n                </DropdownButton>\r\n              </div>\r\n              <div>\r\n                <Button id=\"restart-tour\" variant=\"primary\" onClick={handleTrueRestartTutorial}>Restart Tutorial</Button>\r\n              </div>\r\n              <div>\r\n                <Form>\r\n                  <Form.Check type=\"checkbox\"\r\n                      label=\"Display details when hovering\"\r\n                      defaultChecked={isHover}\r\n                      onChange={() => {\r\n                        isHover = !isHover\r\n                      }} />\r\n                </Form>\r\n              </div>\r\n            </Menu>\r\n            <div>\r\n              <div style={{ textAlign: \"center\" }}>\r\n                <h1 style={{ fontWeight: \"700\" }} className=\"websnapse-title\">WebSnapse</h1>\r\n              </div>\r\n              <Row>\r\n                <Col>\r\n                  <div>\r\n\r\n                    <Form>\r\n                      <Form.Group id=\"formGridCheckbox\">\r\n                        <Row>\r\n                          <Col sm={8}>\r\n                          <div>\r\n                            <DropdownButton id=\"simu-mode\" title={\"Simulation Mode: \" + mode} onSelect={handleSelect}>\r\n                              <Dropdown.Item eventKey=\"GUIDED\" onClick={() => setIsRandom(false)} >GUIDED</Dropdown.Item>\r\n                              <Dropdown.Item eventKey=\"PSEUDORANDOM\" onClick={() => setIsRandom(true)}>PSEUDORANDOM</Dropdown.Item>\r\n                            </DropdownButton>\r\n                          </div>\r\n                          \r\n\r\n                          \r\n                            {/* <Form.Check type=\"checkbox\"\r\n                              label=\"Pseudorandom Mode\"\r\n                              defaultChecked={isRandom}\r\n                              onChange={() => {\r\n                                setIsRandom(!isRandom)\r\n                              }} /> */}\r\n                          </Col>\r\n\r\n                          <Col sm={8} style={{ textAlign: \"left\" }}>\r\n                            <OverlayTrigger\r\n                              placement=\"right\"\r\n                              delay={{ show: 250, hide: 400 }}\r\n                              overlay={renderTooltip}\r\n                            >\r\n                              <QuestionCircle />\r\n                            </OverlayTrigger>\r\n                          </Col>\r\n                        </Row>\r\n                      </Form.Group>\r\n                    </Form>\r\n                    {time == 0 ? <div></div> :\r\n                      <div style={{ backgroundColor: \"#778beb\", color: \"white\", borderRadius: \"10px\", padding: \"0.5em\" }}>\r\n                        <ClockFill color=\"white\" size={30} /> <strong>Time:</strong> {time == 0 ? \"Start playing!\" : time}\r\n                      </div>\r\n                    }\r\n\r\n                  </div>\r\n                </Col>\r\n                <Col>\r\n                  <div className=\"snapse-controls\" style={{ textAlign: \"center\", marginBottom: \"0.8em\" }}>\r\n                    <Button variant=\"link\" onClick={() => onBackward()}><SkipBackwardFill /></Button>{' '}\r\n                    <div style={{ display: 'inline-block' }}>\r\n                      <ProgressBar key={pBar} isPlaying={isPlaying} />\r\n                      <Button size=\"lg\" className=\"snapse-controls-play\" onClick={handlePlay}>{isPlaying ? <PauseFill /> : <PlayFill />}</Button>\r\n                    </div> {' '}\r\n                   \r\n                    <Button variant=\"link\"  onClick={() => onForward()}><SkipForwardFill /></Button>{' '} \r\n                    <Button hidden={true} id=\"forwardBtn\" variant=\"link\"  onClick={() => onNullForward()}><SkipForwardFill /></Button>{' '} \r\n                    \r\n\r\n                  </div>\r\n                  \r\n                  {/*<div style={{ textAlign: \"center\" }}>\r\n                     <Dropdown show={showDropdownBasic} onClick={handleDropDownBasic}>\r\n                      <Dropdown.Toggle id=\"dropdown-basic\">\r\n                        <PlusSquare />{' '}Node Actions \r\n                    </Dropdown.Toggle> {/* Handle row of buttons (convert text to icons) ///*}\r\n                      <Dropdown.Menu>\r\n                        <Dropdown.Item id=\"new-node-btn\"><Button variant=\"link\" size=\"sm\" className=\"node-actions text-primary\" onClick={handleShow} disabled={time > 0 ? true : false}>New Node</Button></Dropdown.Item>\r\n                        <Dropdown.Item id=\"new-input-btn\"><Button variant=\"link\" size=\"sm\" className=\"node-actions text-primary\" onClick={handleShowNewInputModal} disabled={time > 0 ? true : false}>New Input Node</Button></Dropdown.Item>\r\n                        <Dropdown.Item id=\"new-output-btn\"><Button variant=\"link\" size=\"sm\" className=\"node-actions text-primary\" onClick={handleShowNewOutputModal} disabled={time > 0 ? true : false}>New Output Node</Button></Dropdown.Item>\r\n                        <Dropdown.Item id=\"edit-node-btn\"><Button variant=\"link\" size=\"sm\" className=\"node-actions text-info\" onClick={handleShowEditModal} disabled={time > 0 ? true : false}>Edit</Button></Dropdown.Item>\r\n                        <Dropdown.Item id=\"del-node-btn\"><Button variant=\"link\" size=\"sm\" className=\"node-actions text-danger\" onClick={handleShowDeleteModal} disabled={time > 0 ? true : false}>Delete</Button></Dropdown.Item>\r\n                      </Dropdown.Menu>\r\n                    </Dropdown>\r\n                  </div> */}\r\n      \r\n                </Col>\r\n                <Col style={{ textAlign: \"right\" }}>\r\n                  \r\n                  <div id=\"speed-slider\" style={{backgroundColor: \"#786fa6\", borderRadius: \"10px\", padding: \"0.5em\"}}>                    \r\n                      <h6 className=\"slider-title\" style={{textAlign: \"center\"}} ><Sliders />{' '}Simulation Speed \r\n                        <Button size=\"sm\" variant=\"light\" style={{float: 'right'}} onClick={resetSlider}>Reset to 1x</Button>{' '}\r\n                      </h6>\r\n                      \r\n                      <Slider \r\n                        aria-label=\"simuSpeed\"\r\n                        color=\"secondary\" \r\n                        min={0.1} \r\n                        max={3.0} \r\n                        step={0.1}\r\n                        defaultValue={1}\r\n                        value={sld_value} \r\n                        onChange={handleSldChange} \r\n                        valueLabelDisplay=\"auto\"\r\n                        valueLabelFormat={sliderThumbLabelFormat}\r\n                      /> \r\n                      \r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n              <Row>\r\n                <Col sm={8}>\r\n                    <Button variant=\"outline-dark\" size=\"md\" id=\"new-node-btn\" className=\"node-actions text-primary\" onClick={handleShow} style={{ textAlign: \"center\", marginRight: \"0.3em\" }} disabled={time > 0 ? true : false}><PlusSquare />{' '}New Node</Button>\r\n                    <Button variant=\"outline-dark\" size=\"md\" id=\"new-input-btn\" className=\"node-actions text-primary\" onClick={handleShowNewInputModal} style={{ textAlign: \"center\", marginRight: \"0.3em\" }} disabled={time > 0 ? true : false}><BoxArrowInRight />{' '}New Input Node</Button>\r\n                    <Button variant=\"outline-dark\" size=\"md\" id=\"new-output-btn\" className=\"node-actions text-primary\" onClick={handleShowNewOutputModal} style={{ textAlign: \"center\", marginRight: \"0.3em\" }} disabled={time > 0 ? true : false}><BoxArrowRight />{' '}New Output Node</Button>\r\n                    <Button variant=\"outline-primary\" size=\"md\" id=\"del-node-btn\" className=\"node-actions text-danger\" onClick={handleShowDeleteModal} style={{ textAlign: \"center\", marginRight: \"0.3em\" }} disabled={time > 0 ? true : false}><XCircle />{' '}Delete Node</Button>  \r\n                    <Button variant=\"outline-primary\" size=\"md\" id=\"edit-node-btn\" className=\"node-actions text-success\" onClick={handleShowEditModal} style={{ textAlign: \"center\", marginRight: \"0.3em\" }} disabled={time > 0 ? true : false}><PencilSquare />{' '}Edit Regular Node</Button>\r\n                    <Button variant=\"outline-primary\" size=\"md\" id=\"edit-inp-node-btn\" className=\"node-actions text-success\" onClick={handleShowEditInputModal} style={{ textAlign: \"center\", marginRight: \"0.3em\" }} disabled={time > 0 ? true : false}><PencilSquare />{' '}Edit Input Node</Button>\r\n                    \r\n                                      \r\n                </Col>\r\n                <Col sm={4} style={{ textAlign: \"right\" }}>\r\n                    <Button id=\"res-btn\" variant=\"danger\" onClick={handleReset} style={{ textAlign: \"center\", marginTop: \"0.4em\" }}><ArrowCounterclockwise />{' '}Restart Simulation</Button>{' '}\r\n                </Col>\r\n              </Row>\r\n            </div>\r\n            <hr />\r\n            <Snapse\r\n              neurons={neurons}\r\n              onEdgeCreate={(src, dst, addedEles) => {\r\n                onEdgeCreate(src.id(), dst.id())\r\n                addedEles.remove();\r\n              }}\r\n              handleChangePosition={handleNewPosition}\r\n              handleDeleteSynapse={handleDeleteSynapse}\r\n              setIsClickedSynapse={setIsClickedSynapse}\r\n              handleShowDeleteAll = {handleShowDeleteAll}\r\n              headless={headless}\r\n              setNeurons={setNeurons}\r\n              splitRules={splitRules}\r\n              checkIsHover={checkIsHover}\r\n              handleShowEditSynapseModal={handleShowEditSynapseModal}\r\n              handleShowDeleteSynapseModal={handleShowDeleteSynapseModal}\r\n              time={time} />\r\n            <ChoiceHistory time={time}\r\n              showChoiceHistoryModal={showChoiceHistoryModal}\r\n              handleCloseHoiceHistoryModal={handleCloseHoiceHistoryModal}/>\r\n            <ElementPopUp showElementPopup={showElementPopup}\r\n              handleCloseElementPopup={handleCloseElementPopup}\r\n              handleError={showError} \r\n              nodeID = {nodeID}\r\n              nodeType = {nodeType} \r\n              nodeSRules={nodeSRules} \r\n              nodeFRules={nodeFRules} \r\n              nodeSpikes={nodeSpikes}\r\n              nodeBitstring={nodeBitstring} />\r\n            <AddSynapseWeightForm showAddWeightModal={showAddWeightModal}\r\n              handleCloseAddWeightModal={handleCloseAddWeightModal}\r\n              handleAddWeight={handleAddWeight}\r\n              handleError={showError} \r\n              srce = {srce}\r\n              dest = {dest} />              \r\n            <NewNodeForm showNewNodeModal={showNewNodeModal}\r\n              handleCloseModal={handleClose}\r\n              handleNewNode={handleNewNode}\r\n              handleError={showError} />\r\n            <NewOutputNodeForm showNewOutputModal={showNewOutputModal}\r\n              handleCloseNewOutputModal={handleCloseNewOutputModal}\r\n              handleNewOutput={handleNewOutput}\r\n              handleError={showError} />\r\n            <NewInputNodeForm showNewInputModal={showNewInputModal}\r\n              handleCloseNewInputModal={handleCloseNewInputModal}\r\n              handleNewInput={handleNewInput}\r\n              handleError={showError} />\r\n            <EditNodeForm showEditModal={showEditModal}\r\n              handleCloseEditModal={handleCloseEditModal}\r\n              handleEditNode={handleEditNode}\r\n              handleError={showError}\r\n              neurons={neurons} />\r\n            <EditInputNodeForm showEditInputModal={showEditInputModal}\r\n              handleCloseEditInputModal={handleCloseEditInputModal}\r\n              handleEditInputNode={handleEditInputNode}\r\n              handleError={showError}\r\n              neurons={neurons} />\r\n             <EditSynapseForm showEditSynapseModal={showEditSynapseModal}\r\n              handleCloseEditSynapseModal={handleCloseEditSynapseModal}\r\n              handleEditSynapse={handleEditSynapse}\r\n              handleError={showError}\r\n              neurons={neurons}\r\n              isClickedSynapse={isClickedSynapse}\r\n              srcID={srcDel}\r\n              dstID={dstDel}\r\n              setWeight={setWeight} \r\n              weight_main={weight_main}\r\n              setNeurons={setNeurons}\r\n              handleDeleteSynapse={handleDeleteSynapse} />\r\n            <DeleteAllForm showDeleteAllModal={showDeleteAllModal}\r\n              handleCloseDeleteAllModal={handleCloseDeleteAllModal}\r\n              handleDeleteAll={handleDeleteAll}\r\n              handleError={showError}\r\n            />\r\n            <DeleteNodeForm showDeleteModal={showDeleteModal}\r\n              handleCloseDeleteModal={handleCloseDeleteModal}\r\n              handleDeleteNode={handleDeleteNode}\r\n              handleError={showError}\r\n              neurons={neurons}\r\n            />\r\n            <DeleteSynapseForm showDeleteSynapseModal={showDeleteSynapseModal}\r\n              handleCloseDeleteSynapseModal={handleCloseDeleteSynapseModal}\r\n              handleDeleteSynapse={handleDeleteSynapse}\r\n              handleError={showError}\r\n              setNeurons={setNeurons}\r\n              isClickedSynapse={isClickedSynapse}\r\n              srcID={srcDel}\r\n              dstID={dstDel}\r\n            />\r\n            <ChooseRuleForm showChooseRuleModal={showChooseRuleModal}\r\n              handleCloseChooseRuleModal={handleCloseChooseRuleModal}\r\n              rules={guidedRules}\r\n              handleChosenRules={handleChosenRules}\r\n            />\r\n            {Prompt}\r\n          </Container>\r\n        </Route>\r\n      </Switch>\r\n    </Router>\r\n  );\r\n}\r\n\r\nconst shortening = keyframes`\r\nfrom {\r\n  transform: scaleX(100%);\r\n}\r\n\r\nto {\r\n  transform: scaleX(0%);\r\n}\r\n`\r\n\r\n\r\nconst ProgressBar = styled.div`\r\n${props =>\r\n  props.isPlaying &&\r\n  css`\r\n    animation: ${shortening} ${progBarRate}s linear; \r\n  `}\r\nbackground-color: #c44569;\r\nheight: 4px;\r\ntransform-origin: left center;\r\nmargin-bottom: 2px;\r\n`\r\n\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport cytoscape from 'cytoscape';\r\nimport popper from 'cytoscape-popper';\r\nimport edgehandles from 'cytoscape-edgehandles';\r\nimport gridGuide from 'cytoscape-grid-guide';\r\n\r\ncytoscape.use(edgehandles)\r\ncytoscape.use(gridGuide)\r\ncytoscape.use(popper)\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}